!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.effechecka=t()}}(function(){var t;return function e(t,n,i){function o(s,a){if(!n[s]){if(!t[s]){var h="function"==typeof require&&require;if(!a&&h)return h(s,!0);if(r)return r(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[s]={exports:{}};t[s][0].call(c.exports,function(e){var n=t[s][1][e];return o(n?n:e)},c,c.exports,e,t,n,i)}return n[s].exports}for(var r="function"==typeof require&&require,s=0;s<i.length;s++)o(i[s]);return o}({1:[function(t,e,n){(function(n){function i(t,e){t.setAttribute("data-results",e.results);var n=document.createElement("tr"),i=document.createElement("th");i.setAttribute("id","checklistHeader"),i.textContent="checklist items",n.appendChild(i),i=document.createElement("th"),i.textContent="occurrence count",n.appendChild(i),t.appendChild(n),e.items.forEach(function(e){var n=document.createElement("tr"),i=document.createElement("td"),o=e.taxon.split("|").reduce(function(t,e){if(0==e.length)return t.concat([s.sepElem()]);var n=document.createElement("span");return n.setAttribute("class",s.classNameFor(e)),n.textContent=e,t.concat([n,s.sepElem()])},[]);o.forEach(function(t){i.appendChild(t)}),n.appendChild(i);var r=document.createElement("td");r.textContent=e.recordcount,n.appendChild(r),t.appendChild(n)})}function o(){return s.xhr()}function r(){s.removeChildren("#checklist"),s.removeChildren("#download"),_("none requested")}var s=t("./util.js"),a=t("taxon"),h=(t("extend"),{});e.exports=h;var l=function(t){return s.createRequestURL(t,"checklist")},c=function(t,e,n){var i=document.querySelector("#download");i.appendChild(document.createElement("span")).textContent=" or as ";var o=i.appendChild(document.createElement("a"));o.setAttribute("href",encodeURI("data:text/tab-separated-values;charset=utf-8,"+n)),o.setAttribute("download",t),o.textContent=e},u=function(t){_("ready"),d(t),s.addHyperlinksForNames(t)},d=function(t){var e=t.map(function(t){return t.id}),n=10;c("eolpageids.tsv","eol page ids",e.join("\n"));var i=document.querySelector("#download");i.setAttribute("data-name-and-page-ids",JSON.stringify(t)),i.appendChild(document.createElement("span")).textContent=" or ";var o=i.appendChild(document.createElement("button"));o.textContent="save as EOL Collection",i.appendChild(document.createElement("span")).textContent=" with title ";var r=i.appendChild(document.createElement("input"));r.setAttribute("id","collectionTitle"),r.setAttribute("placeholder","enter title"),i.appendChild(document.createElement("span")).textContent=" and description ";var s=i.appendChild(document.createElement("input"));s.setAttribute("id","collectionDescription"),s.setAttribute("placeholder","enter description"),i.appendChild(document.createElement("span")).innerHTML=' using <a href="https://github.com/jhpoelen/effechecka/wiki/Save-Checklist-To-EOL-Collection" target="_blank">api key</a> ';var h=i.appendChild(document.createElement("input"));h.setAttribute("id","apiKey"),h.setAttribute("placeholder","EOL api key"),i.appendChild(document.createElement("span")).textContent=" limit to ";var l=i.appendChild(document.createElement("input"));l.setAttribute("id","collectionLimit"),l.setAttribute("type","number"),l.setAttribute("min","1"),l.value=e,e.length>n&&(l.value=n),i.appendChild(document.createElement("span")).textContent=" collection items. ";var u=i.appendChild(document.createElement("a"));u.setAttribute("href","https://github.com/jhpoelen/effechecka/wiki/About#saving-as-eol-collection"),u.setAttribute("target","_blank"),u.textContent="?",o.addEventListener("click",function(t){o.setAttribute("disabled","disabled");var e=document.querySelector("#saveStatus");e||(e=i.appendChild(document.createElement("span")),e.setAttribute("id","saveStatus")),e.innerHTML=" Collection saving...";var r=JSON.parse(document.querySelector("#download").dataset.nameAndPageIds).map(function(t){return parseInt(t.id)}),s=document.querySelector("#apiKey").value,h=document.querySelector("#collectionTitle").value,l=document.querySelector("#collectionDescription").value;l=l.trim().replace(/\.+$/,""),l=l.concat('. Re-create this <a href="'+window.location.href+'">regional search</a> with currently available data.');var c=parseInt(document.querySelector("#collectionLimit").value);c||(c=30);var u=r.slice(0,c);a.saveAsCollection(function(t){var e="http://eol.org/collections/"+t,i=' Collection saved at <a href="'+e+'">'+e+"</a>.";t||(i=' Failed to save collection. Bummer! This is probably a <a href="https://github.com/EOL/tramea/issues/35">known issue</a> that prevents saving > '+n+' items to a EOL checklist. However, if your list contains only a few items and you are seeing this message, please check <a href="https://github.com/jhpoelen/effechecka/issues/">our open issues</a> first, before reporting a new one.'),document.querySelector("#saveStatus").innerHTML=i,o.removeAttribute("disabled")},s,u,h,l)},!1)},p=function(t){s.removeChildren("#download");var e=t.getDataFilter();delete e.limit;var n=document.querySelector("#download");n.appendChild(document.createElement("span")).textContent="Save all as ";var i=s.createRequestURL(e,"checklist.tsv"),r=n.appendChild(document.createElement("a"));r.setAttribute("href",i),r.textContent="tsv",document.appendChild(document.createElement("span")).textContent=", view associated ";var h=n.appendChild(document.createElement("a"));h.setAttribute("href","http://gimmefreshdata.github.io/?"+s.createQuery(e)),h.setAttribute("target","_blank"),h.setAttribute("title","view or request associated occurrences. Note that occurrence queries do not support trait filters."),h.textContent="occurrences",e.limit=20,n.appendChild(document.createElement("span")).textContent=", or save up to ["+e.limit+"] checklist items as ";var i=l(e),r=n.appendChild(document.createElement("a"));r.setAttribute("href",i),r.textContent="json";var c=o();void 0!==c&&(_("downloading..."),c.open("GET",i,!0),c.onreadystatechange=function(){if(4===c.readyState&&200===c.status){var t=JSON.parse(c.responseText);if(t.items){var e=document.querySelector("#checklistHeader");if(e){var n="checklist items";t.items.length>20&&(n=n.concat(" (first 20 shown)")),e.textContent=n}var i=t.items.reduce(function(t,e){return e.taxon&&(t=t.concat(s.lastNameFromPath(e.taxon))),t},[]);_("linking to eol pages..."),a.eolPageIdsFor(i,u)}}},c.send(null))},f=function(t,e){if(t.items){var n=document.querySelector("#checklist");if(t.items.length>0)i(n,t),p(e);else{var o={requested:"working on your checklist..."},s=o[t.status]||t.status;if(_(s),"ready"===t.status){var a=document.querySelector("#download"),h=a.appendChild(document.createElement("span")),l="The checklist you've requested contains no items. Bummer! You might want to try changing your search parameters",c=document.createElement("button");c.textContent="removing your trait selectors",c.title="remove your trait selectors",c.addEventListener("click",function(t){e.removeTraitSelectors(),r(),m(e)},!1),e.hasTraitSelectors()?(h.textContent=l+" by ",a.appendChild(c),a.appendChild(document.createElement("span")).textContent="."):h.textContent=l+"."}}}},m=function(t){s.requestSelected(l(t.getDataFilter()),t,f,_)},_=function(t){document.querySelector("#checklistStatus").textContent=t};h.select=function(t){var e=function(e){var n=document.querySelector(e);n.addEventListener("click",function(e){r(),m(t)},!1)};r(),["#requestChecklist","#refreshChecklist"].forEach(function(t){e(t)});var n=function(){r()};t.on("update",function(){n()}),t.on("ready",function(){n(),m(t)})},h.addTo=function(t){t&&(t.innerHTML=n("PGRpdiBpZD0iY2hlY2tsaXN0LWNvbnRyb2xzIj4KICAgIDxidXR0b24gaWQ9InJlcXVlc3RDaGVja2xpc3QiPnJlcXVlc3QgY2hlY2tsaXN0PC9idXR0b24+CiAgICBjaGVja2xpc3Qgc3RhdHVzOiBbPGI+PHNwYW4gaWQ9ImNoZWNrbGlzdFN0YXR1cyI+PC9zcGFuPjwvYj5dCiAgICA8YnV0dG9uIGlkPSJyZWZyZXNoQ2hlY2tsaXN0Ij5yZWZyZXNoPC9idXR0b24+CiAgICA8YSBocmVmPSJodHRwczovL2dpdGh1Yi5jb20vamhwb2VsZW4vZWZmZWNoZWNrYS93aWtpL0Fib3V0I2NoZWNrbGlzdCIgdGFyZ2V0PSJfYmxhbmsiPj88L2E+Cgo8L2Rpdj4KPGRpdiBpZD0iY2hlY2tsaXN0LXJlc3VsdHMiPgogICAgPGJyLz4KICAgIDxkaXYgaWQ9ImRvd25sb2FkIj48L2Rpdj4KICAgIDxici8+CiAgICA8dGFibGUgaWQ9ImNoZWNrbGlzdCI+PC90YWJsZT4KPC9kaXY+Cg==","base64"))}}).call(this,t("buffer").Buffer)},{"./util.js":63,buffer:8,extend:14,taxon:51}],2:[function(t,e,n){var i=t("./checklist.js"),o=t("./occurrences.js"),r=t("./selector.js"),s=t("./util.js"),a={};e.exports=a,a.init=function(t){function e(t){var e="effechecka-"+t,i=document.getElementById(e);if(i){var o=n.getDataFilter(),r=o[t];void 0!==r&&(i.value=r),i.addEventListener("keyup",function(e){var i=n.getDataFilter(),o=e.target.value;void 0!==o&&(i[t]=o,n.setDataFilter(i),n.emit("update"))})}}r.addTo(document.querySelector("#effechecka-selector")),i.addTo(document.querySelector("#effechecka-checklist")),o.addTo(document.querySelector("#effechecka-occurrences"));var n=r.createSelectors(t);document.querySelector("#effechecka-checklist")&&i.select(n),document.querySelector("#effechecka-occurrences")&&o.select(n),e("addedBefore"),e("addedAfter"),n.init()},window.addEventListener("popstate",function(t){["#effechecka-selector","#effechecka-checklist","#effechecka-occurrences"].forEach(function(t){s.removeChildren(t)}),init()})},{"./checklist.js":1,"./occurrences.js":61,"./selector.js":62,"./util.js":63}],3:[function(t,e,n){!function(){function t(t){this.message=t}var e="undefined"!=typeof n?n:this,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";t.prototype=new Error,t.prototype.name="InvalidCharacterError",e.btoa||(e.btoa=function(e){for(var n,o,r=0,s=i,a="";e.charAt(0|r)||(s="=",r%1);a+=s.charAt(63&n>>8-r%1*8)){if(o=e.charCodeAt(r+=.75),o>255)throw new t("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");n=n<<8|o}return a}),e.atob||(e.atob=function(e){if(e=e.replace(/=+$/,""),e.length%4==1)throw new t("'atob' failed: The string to be decoded is not correctly encoded.");for(var n,o,r=0,s=0,a="";o=e.charAt(s++);~o&&(n=r%4?64*n+o:o,r++%4)?a+=String.fromCharCode(255&n>>(-2*r&6)):0)o=i.indexOf(o);return a})}()},{}],4:[function(t,e,n){var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(t){"use strict";function e(t){var e=t.charCodeAt(0);return e===s||e===u?62:e===a||e===d?63:h>e?-1:h+10>e?e-h+26+26:c+26>e?e-c:l+26>e?e-l+26:void 0}function n(t){function n(t){l[u++]=t}var i,o,s,a,h,l;if(t.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var c=t.length;h="="===t.charAt(c-2)?2:"="===t.charAt(c-1)?1:0,l=new r(3*t.length/4-h),s=h>0?t.length-4:t.length;var u=0;for(i=0,o=0;s>i;i+=4,o+=3)a=e(t.charAt(i))<<18|e(t.charAt(i+1))<<12|e(t.charAt(i+2))<<6|e(t.charAt(i+3)),n((16711680&a)>>16),n((65280&a)>>8),n(255&a);return 2===h?(a=e(t.charAt(i))<<2|e(t.charAt(i+1))>>4,n(255&a)):1===h&&(a=e(t.charAt(i))<<10|e(t.charAt(i+1))<<4|e(t.charAt(i+2))>>2,n(a>>8&255),n(255&a)),l}function o(t){function e(t){return i.charAt(t)}function n(t){return e(t>>18&63)+e(t>>12&63)+e(t>>6&63)+e(63&t)}var o,r,s,a=t.length%3,h="";for(o=0,s=t.length-a;s>o;o+=3)r=(t[o]<<16)+(t[o+1]<<8)+t[o+2],h+=n(r);switch(a){case 1:r=t[t.length-1],h+=e(r>>2),h+=e(r<<4&63),h+="==";break;case 2:r=(t[t.length-2]<<8)+t[t.length-1],h+=e(r>>10),h+=e(r>>4&63),h+=e(r<<2&63),h+="="}return h}var r="undefined"!=typeof Uint8Array?Uint8Array:Array,s="+".charCodeAt(0),a="/".charCodeAt(0),h="0".charCodeAt(0),l="a".charCodeAt(0),c="A".charCodeAt(0),u="-".charCodeAt(0),d="_".charCodeAt(0);t.toByteArray=n,t.fromByteArray=o}("undefined"==typeof n?this.base64js={}:n)},{}],5:[function(t,e,n){},{}],6:[function(t,e,n){arguments[4][5][0].apply(n,arguments)},{dup:5}],7:[function(t,e,n){function i(){if(!a){a=!0;for(var t,e=s.length;e;){t=s,s=[];for(var n=-1;++n<e;)t[n]();e=s.length}a=!1}}function o(){}var r=e.exports={},s=[],a=!1;r.nextTick=function(t){s.push(t),a||setTimeout(i,0)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=o,r.addListener=o,r.once=o,r.off=o,r.removeListener=o,r.removeAllListeners=o,r.emit=o,r.binding=function(t){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},{}],8:[function(t,e,n){(function(e){"use strict";function i(){function t(){}try{var e=new Uint8Array(1);return e.foo=function(){return 42},e.constructor=t,42===e.foo()&&e.constructor===t&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(n){return!1}}function o(){return r.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function r(t){return this instanceof r?(r.TYPED_ARRAY_SUPPORT||(this.length=0,this.parent=void 0),"number"==typeof t?s(this,t):"string"==typeof t?a(this,t,arguments.length>1?arguments[1]:"utf8"):h(this,t)):arguments.length>1?new r(t,arguments[1]):new r(t)}function s(t,e){if(t=m(t,0>e?0:0|_(e)),!r.TYPED_ARRAY_SUPPORT)for(var n=0;e>n;n++)t[n]=0;return t}function a(t,e,n){("string"!=typeof n||""===n)&&(n="utf8");var i=0|v(e,n);return t=m(t,i),t.write(e,n),t}function h(t,e){if(r.isBuffer(e))return l(t,e);if(X(e))return c(t,e);if(null==e)throw new TypeError("must start with number, buffer, array or string");if("undefined"!=typeof ArrayBuffer){if(e.buffer instanceof ArrayBuffer)return u(t,e);if(e instanceof ArrayBuffer)return d(t,e)}return e.length?p(t,e):f(t,e)}function l(t,e){var n=0|_(e.length);return t=m(t,n),e.copy(t,0,0,n),t}function c(t,e){var n=0|_(e.length);t=m(t,n);for(var i=0;n>i;i+=1)t[i]=255&e[i];return t}function u(t,e){var n=0|_(e.length);t=m(t,n);for(var i=0;n>i;i+=1)t[i]=255&e[i];return t}function d(t,e){return r.TYPED_ARRAY_SUPPORT?(e.byteLength,t=r._augment(new Uint8Array(e))):t=u(t,new Uint8Array(e)),t}function p(t,e){var n=0|_(e.length);t=m(t,n);for(var i=0;n>i;i+=1)t[i]=255&e[i];return t}function f(t,e){var n,i=0;"Buffer"===e.type&&X(e.data)&&(n=e.data,i=0|_(n.length)),t=m(t,i);for(var o=0;i>o;o+=1)t[o]=255&n[o];return t}function m(t,e){r.TYPED_ARRAY_SUPPORT?(t=r._augment(new Uint8Array(e)),t.__proto__=r.prototype):(t.length=e,t._isBuffer=!0);var n=0!==e&&e<=r.poolSize>>>1;return n&&(t.parent=$),t}function _(t){if(t>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|t}function g(t,e){if(!(this instanceof g))return new g(t,e);var n=new r(t,e);return delete n.parent,n}function v(t,e){"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var i=!1;;)switch(e){case"ascii":case"binary":case"raw":case"raws":return n;case"utf8":case"utf-8":return G(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return q(t).length;default:if(i)return G(t).length;e=(""+e).toLowerCase(),i=!0}}function y(t,e,n){var i=!1;if(e=0|e,n=void 0===n||n===1/0?this.length:0|n,t||(t="utf8"),0>e&&(e=0),n>this.length&&(n=this.length),e>=n)return"";for(;;)switch(t){case"hex":return D(this,e,n);case"utf8":case"utf-8":return C(this,e,n);case"ascii":return k(this,e,n);case"binary":return S(this,e,n);case"base64":return T(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,e,n);default:if(i)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),i=!0}}function L(t,e,n,i){n=Number(n)||0;var o=t.length-n;i?(i=Number(i),i>o&&(i=o)):i=o;var r=e.length;if(r%2!==0)throw new Error("Invalid hex string");i>r/2&&(i=r/2);for(var s=0;i>s;s++){var a=parseInt(e.substr(2*s,2),16);if(isNaN(a))throw new Error("Invalid hex string");t[n+s]=a}return s}function b(t,e,n,i){return Y(G(e,t.length-n),t,n,i)}function w(t,e,n,i){return Y(F(e),t,n,i)}function E(t,e,n,i){return w(t,e,n,i)}function x(t,e,n,i){return Y(q(e),t,n,i)}function P(t,e,n,i){return Y(W(e,t.length-n),t,n,i)}function T(t,e,n){return 0===e&&n===t.length?V.fromByteArray(t):V.fromByteArray(t.slice(e,n))}function C(t,e,n){n=Math.min(t.length,n);for(var i=[],o=e;n>o;){var r=t[o],s=null,a=r>239?4:r>223?3:r>191?2:1;if(n>=o+a){var h,l,c,u;switch(a){case 1:128>r&&(s=r);break;case 2:h=t[o+1],128===(192&h)&&(u=(31&r)<<6|63&h,u>127&&(s=u));break;case 3:h=t[o+1],l=t[o+2],128===(192&h)&&128===(192&l)&&(u=(15&r)<<12|(63&h)<<6|63&l,u>2047&&(55296>u||u>57343)&&(s=u));break;case 4:h=t[o+1],l=t[o+2],c=t[o+3],128===(192&h)&&128===(192&l)&&128===(192&c)&&(u=(15&r)<<18|(63&h)<<12|(63&l)<<6|63&c,u>65535&&1114112>u&&(s=u))}}null===s?(s=65533,a=1):s>65535&&(s-=65536,i.push(s>>>10&1023|55296),s=56320|1023&s),i.push(s),o+=a}return M(i)}function M(t){var e=t.length;if(Q>=e)return String.fromCharCode.apply(String,t);for(var n="",i=0;e>i;)n+=String.fromCharCode.apply(String,t.slice(i,i+=Q));return n}function k(t,e,n){var i="";n=Math.min(t.length,n);for(var o=e;n>o;o++)i+=String.fromCharCode(127&t[o]);return i}function S(t,e,n){var i="";n=Math.min(t.length,n);for(var o=e;n>o;o++)i+=String.fromCharCode(t[o]);return i}function D(t,e,n){var i=t.length;(!e||0>e)&&(e=0),(!n||0>n||n>i)&&(n=i);for(var o="",r=e;n>r;r++)o+=H(t[r]);return o}function I(t,e,n){for(var i=t.slice(e,n),o="",r=0;r<i.length;r+=2)o+=String.fromCharCode(i[r]+256*i[r+1]);return o}function A(t,e,n){if(t%1!==0||0>t)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function O(t,e,n,i,o,s){if(!r.isBuffer(t))throw new TypeError("buffer must be a Buffer instance");if(e>o||s>e)throw new RangeError("value is out of bounds");if(n+i>t.length)throw new RangeError("index out of range")}function R(t,e,n,i){0>e&&(e=65535+e+1);for(var o=0,r=Math.min(t.length-n,2);r>o;o++)t[n+o]=(e&255<<8*(i?o:1-o))>>>8*(i?o:1-o)}function U(t,e,n,i){0>e&&(e=4294967295+e+1);for(var o=0,r=Math.min(t.length-n,4);r>o;o++)t[n+o]=e>>>8*(i?o:3-o)&255}function N(t,e,n,i,o,r){if(e>o||r>e)throw new RangeError("value is out of bounds");if(n+i>t.length)throw new RangeError("index out of range");if(0>n)throw new RangeError("index out of range")}function B(t,e,n,i,o){return o||N(t,e,n,4,3.4028234663852886e38,-3.4028234663852886e38),J.write(t,e,n,i,23,4),n+4}function z(t,e,n,i,o){return o||N(t,e,n,8,1.7976931348623157e308,-1.7976931348623157e308),J.write(t,e,n,i,52,8),n+8}function j(t){if(t=Z(t).replace(tt,""),t.length<2)return"";for(;t.length%4!==0;)t+="=";return t}function Z(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function H(t){return 16>t?"0"+t.toString(16):t.toString(16)}function G(t,e){e=e||1/0;for(var n,i=t.length,o=null,r=[],s=0;i>s;s++){if(n=t.charCodeAt(s),n>55295&&57344>n){if(!o){if(n>56319){(e-=3)>-1&&r.push(239,191,189);continue}if(s+1===i){(e-=3)>-1&&r.push(239,191,189);continue}o=n;continue}if(56320>n){(e-=3)>-1&&r.push(239,191,189),o=n;continue}n=(o-55296<<10|n-56320)+65536}else o&&(e-=3)>-1&&r.push(239,191,189);if(o=null,128>n){if((e-=1)<0)break;r.push(n)}else if(2048>n){if((e-=2)<0)break;r.push(n>>6|192,63&n|128)}else if(65536>n){if((e-=3)<0)break;r.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(1114112>n))throw new Error("Invalid code point");if((e-=4)<0)break;r.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return r}function F(t){for(var e=[],n=0;n<t.length;n++)e.push(255&t.charCodeAt(n));return e}function W(t,e){for(var n,i,o,r=[],s=0;s<t.length&&!((e-=2)<0);s++)n=t.charCodeAt(s),i=n>>8,o=n%256,r.push(o),r.push(i);return r}function q(t){return V.toByteArray(j(t))}function Y(t,e,n,i){for(var o=0;i>o&&!(o+n>=e.length||o>=t.length);o++)e[o+n]=t[o];return o}var V=t("base64-js"),J=t("ieee754"),X=t("isarray");n.Buffer=r,n.SlowBuffer=g,n.INSPECT_MAX_BYTES=50,r.poolSize=8192;var $={};r.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:i(),r.TYPED_ARRAY_SUPPORT?(r.prototype.__proto__=Uint8Array.prototype,r.__proto__=Uint8Array):(r.prototype.length=void 0,r.prototype.parent=void 0),r.isBuffer=function(t){return!(null==t||!t._isBuffer)},r.compare=function(t,e){if(!r.isBuffer(t)||!r.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,i=e.length,o=0,s=Math.min(n,i);s>o&&t[o]===e[o];)++o;return o!==s&&(n=t[o],i=e[o]),i>n?-1:n>i?1:0},r.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},r.concat=function(t,e){if(!X(t))throw new TypeError("list argument must be an Array of Buffers.");if(0===t.length)return new r(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;n++)e+=t[n].length;var i=new r(e),o=0;for(n=0;n<t.length;n++){var s=t[n];s.copy(i,o),o+=s.length}return i},r.byteLength=v,r.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?C(this,0,t):y.apply(this,arguments)},r.prototype.equals=function(t){if(!r.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t?!0:0===r.compare(this,t)},r.prototype.inspect=function(){var t="",e=n.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,e).match(/.{2}/g).join(" "),this.length>e&&(t+=" ... ")),"<Buffer "+t+">"},r.prototype.compare=function(t){if(!r.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t?0:r.compare(this,t)},r.prototype.indexOf=function(t,e){function n(t,e,n){for(var i=-1,o=0;n+o<t.length;o++)if(t[n+o]===e[-1===i?0:o-i]){if(-1===i&&(i=o),o-i+1===e.length)return n+i}else i=-1;return-1}if(e>2147483647?e=2147483647:-2147483648>e&&(e=-2147483648),e>>=0,0===this.length)return-1;if(e>=this.length)return-1;if(0>e&&(e=Math.max(this.length+e,0)),"string"==typeof t)return 0===t.length?-1:String.prototype.indexOf.call(this,t,e);if(r.isBuffer(t))return n(this,t,e);if("number"==typeof t)return r.TYPED_ARRAY_SUPPORT&&"function"===Uint8Array.prototype.indexOf?Uint8Array.prototype.indexOf.call(this,t,e):n(this,[t],e);throw new TypeError("val must be string, number or Buffer")},r.prototype.get=function(t){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(t)},r.prototype.set=function(t,e){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(t,e)},r.prototype.write=function(t,e,n,i){if(void 0===e)i="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)i=e,n=this.length,e=0;else if(isFinite(e))e=0|e,isFinite(n)?(n=0|n,void 0===i&&(i="utf8")):(i=n,n=void 0);else{var o=i;i=e,e=0|n,n=o}var r=this.length-e;if((void 0===n||n>r)&&(n=r),t.length>0&&(0>n||0>e)||e>this.length)throw new RangeError("attempt to write outside buffer bounds");i||(i="utf8");for(var s=!1;;)switch(i){case"hex":return L(this,t,e,n);case"utf8":case"utf-8":return b(this,t,e,n);case"ascii":return w(this,t,e,n);case"binary":return E(this,t,e,n);case"base64":return x(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,t,e,n);default:if(s)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),s=!0}},r.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Q=4096;r.prototype.slice=function(t,e){var n=this.length;t=~~t,e=void 0===e?n:~~e,0>t?(t+=n,0>t&&(t=0)):t>n&&(t=n),0>e?(e+=n,0>e&&(e=0)):e>n&&(e=n),t>e&&(e=t);var i;if(r.TYPED_ARRAY_SUPPORT)i=r._augment(this.subarray(t,e));else{var o=e-t;i=new r(o,void 0);for(var s=0;o>s;s++)i[s]=this[s+t]}return i.length&&(i.parent=this.parent||this),i},r.prototype.readUIntLE=function(t,e,n){t=0|t,e=0|e,n||A(t,e,this.length);for(var i=this[t],o=1,r=0;++r<e&&(o*=256);)i+=this[t+r]*o;return i},r.prototype.readUIntBE=function(t,e,n){t=0|t,e=0|e,n||A(t,e,this.length);for(var i=this[t+--e],o=1;e>0&&(o*=256);)i+=this[t+--e]*o;return i},r.prototype.readUInt8=function(t,e){return e||A(t,1,this.length),this[t]},r.prototype.readUInt16LE=function(t,e){return e||A(t,2,this.length),this[t]|this[t+1]<<8},r.prototype.readUInt16BE=function(t,e){return e||A(t,2,this.length),this[t]<<8|this[t+1]},r.prototype.readUInt32LE=function(t,e){return e||A(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},r.prototype.readUInt32BE=function(t,e){return e||A(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},r.prototype.readIntLE=function(t,e,n){t=0|t,e=0|e,n||A(t,e,this.length);for(var i=this[t],o=1,r=0;++r<e&&(o*=256);)i+=this[t+r]*o;return o*=128,i>=o&&(i-=Math.pow(2,8*e)),i},r.prototype.readIntBE=function(t,e,n){t=0|t,e=0|e,n||A(t,e,this.length);for(var i=e,o=1,r=this[t+--i];i>0&&(o*=256);)r+=this[t+--i]*o;return o*=128,r>=o&&(r-=Math.pow(2,8*e)),r},r.prototype.readInt8=function(t,e){return e||A(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},r.prototype.readInt16LE=function(t,e){e||A(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},r.prototype.readInt16BE=function(t,e){e||A(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},r.prototype.readInt32LE=function(t,e){return e||A(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},r.prototype.readInt32BE=function(t,e){return e||A(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},r.prototype.readFloatLE=function(t,e){return e||A(t,4,this.length),J.read(this,t,!0,23,4)},r.prototype.readFloatBE=function(t,e){return e||A(t,4,this.length),J.read(this,t,!1,23,4)},r.prototype.readDoubleLE=function(t,e){return e||A(t,8,this.length),J.read(this,t,!0,52,8)},r.prototype.readDoubleBE=function(t,e){return e||A(t,8,this.length),J.read(this,t,!1,52,8)},r.prototype.writeUIntLE=function(t,e,n,i){t=+t,e=0|e,n=0|n,i||O(this,t,e,n,Math.pow(2,8*n),0);var o=1,r=0;for(this[e]=255&t;++r<n&&(o*=256);)this[e+r]=t/o&255;return e+n},r.prototype.writeUIntBE=function(t,e,n,i){t=+t,e=0|e,n=0|n,i||O(this,t,e,n,Math.pow(2,8*n),0);var o=n-1,r=1;for(this[e+o]=255&t;--o>=0&&(r*=256);)this[e+o]=t/r&255;return e+n},r.prototype.writeUInt8=function(t,e,n){return t=+t,e=0|e,n||O(this,t,e,1,255,0),r.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},r.prototype.writeUInt16LE=function(t,e,n){return t=+t,e=0|e,n||O(this,t,e,2,65535,0),r.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):R(this,t,e,!0),e+2},r.prototype.writeUInt16BE=function(t,e,n){return t=+t,e=0|e,n||O(this,t,e,2,65535,0),r.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):R(this,t,e,!1),e+2},r.prototype.writeUInt32LE=function(t,e,n){return t=+t,e=0|e,n||O(this,t,e,4,4294967295,0),r.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):U(this,t,e,!0),e+4},r.prototype.writeUInt32BE=function(t,e,n){return t=+t,e=0|e,n||O(this,t,e,4,4294967295,0),r.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):U(this,t,e,!1),e+4},r.prototype.writeIntLE=function(t,e,n,i){if(t=+t,e=0|e,!i){var o=Math.pow(2,8*n-1);O(this,t,e,n,o-1,-o)}var r=0,s=1,a=0>t?1:0;for(this[e]=255&t;++r<n&&(s*=256);)this[e+r]=(t/s>>0)-a&255;return e+n},r.prototype.writeIntBE=function(t,e,n,i){if(t=+t,e=0|e,!i){var o=Math.pow(2,8*n-1);O(this,t,e,n,o-1,-o)}var r=n-1,s=1,a=0>t?1:0;for(this[e+r]=255&t;--r>=0&&(s*=256);)this[e+r]=(t/s>>0)-a&255;return e+n},r.prototype.writeInt8=function(t,e,n){return t=+t,e=0|e,n||O(this,t,e,1,127,-128),r.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),0>t&&(t=255+t+1),this[e]=255&t,e+1},r.prototype.writeInt16LE=function(t,e,n){return t=+t,e=0|e,n||O(this,t,e,2,32767,-32768),r.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):R(this,t,e,!0),e+2},r.prototype.writeInt16BE=function(t,e,n){return t=+t,e=0|e,n||O(this,t,e,2,32767,-32768),r.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):R(this,t,e,!1),e+2},r.prototype.writeInt32LE=function(t,e,n){return t=+t,e=0|e,n||O(this,t,e,4,2147483647,-2147483648),r.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):U(this,t,e,!0),e+4},r.prototype.writeInt32BE=function(t,e,n){return t=+t,e=0|e,n||O(this,t,e,4,2147483647,-2147483648),0>t&&(t=4294967295+t+1),r.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):U(this,t,e,!1),e+4},r.prototype.writeFloatLE=function(t,e,n){return B(this,t,e,!0,n)},r.prototype.writeFloatBE=function(t,e,n){return B(this,t,e,!1,n)},r.prototype.writeDoubleLE=function(t,e,n){return z(this,t,e,!0,n)},r.prototype.writeDoubleBE=function(t,e,n){return z(this,t,e,!1,n)},r.prototype.copy=function(t,e,n,i){if(n||(n=0),i||0===i||(i=this.length),e>=t.length&&(e=t.length),e||(e=0),i>0&&n>i&&(i=n),i===n)return 0;if(0===t.length||0===this.length)return 0;if(0>e)throw new RangeError("targetStart out of bounds");if(0>n||n>=this.length)throw new RangeError("sourceStart out of bounds");if(0>i)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),t.length-e<i-n&&(i=t.length-e+n);var o,s=i-n;if(this===t&&e>n&&i>e)for(o=s-1;o>=0;o--)t[o+e]=this[o+n];else if(1e3>s||!r.TYPED_ARRAY_SUPPORT)for(o=0;s>o;o++)t[o+e]=this[o+n];else t._set(this.subarray(n,n+s),e);return s},r.prototype.fill=function(t,e,n){if(t||(t=0),e||(e=0),n||(n=this.length),e>n)throw new RangeError("end < start");if(n!==e&&0!==this.length){if(0>e||e>=this.length)throw new RangeError("start out of bounds");if(0>n||n>this.length)throw new RangeError("end out of bounds");var i;if("number"==typeof t)for(i=e;n>i;i++)this[i]=t;else{var o=G(t.toString()),r=o.length;for(i=e;n>i;i++)this[i]=o[i%r]}return this}},r.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(r.TYPED_ARRAY_SUPPORT)return new r(this).buffer;for(var t=new Uint8Array(this.length),e=0,n=t.length;n>e;e+=1)t[e]=this[e];return t.buffer}throw new TypeError("Buffer.toArrayBuffer not supported in this browser")};var K=r.prototype;r._augment=function(t){return t.constructor=r,t._isBuffer=!0,t._set=t.set,t.get=K.get,t.set=K.set,t.write=K.write,t.toString=K.toString,t.toLocaleString=K.toString,t.toJSON=K.toJSON,t.equals=K.equals,t.compare=K.compare,t.indexOf=K.indexOf,t.copy=K.copy,t.slice=K.slice,t.readUIntLE=K.readUIntLE,t.readUIntBE=K.readUIntBE,t.readUInt8=K.readUInt8,t.readUInt16LE=K.readUInt16LE,t.readUInt16BE=K.readUInt16BE,t.readUInt32LE=K.readUInt32LE,t.readUInt32BE=K.readUInt32BE,t.readIntLE=K.readIntLE,t.readIntBE=K.readIntBE,t.readInt8=K.readInt8,t.readInt16LE=K.readInt16LE,t.readInt16BE=K.readInt16BE,t.readInt32LE=K.readInt32LE,t.readInt32BE=K.readInt32BE,t.readFloatLE=K.readFloatLE,t.readFloatBE=K.readFloatBE,t.readDoubleLE=K.readDoubleLE,t.readDoubleBE=K.readDoubleBE,t.writeUInt8=K.writeUInt8,t.writeUIntLE=K.writeUIntLE,t.writeUIntBE=K.writeUIntBE,t.writeUInt16LE=K.writeUInt16LE,t.writeUInt16BE=K.writeUInt16BE,t.writeUInt32LE=K.writeUInt32LE,t.writeUInt32BE=K.writeUInt32BE,t.writeIntLE=K.writeIntLE,t.writeIntBE=K.writeIntBE,t.writeInt8=K.writeInt8,t.writeInt16LE=K.writeInt16LE,t.writeInt16BE=K.writeInt16BE,t.writeInt32LE=K.writeInt32LE,t.writeInt32BE=K.writeInt32BE,t.writeFloatLE=K.writeFloatLE,t.writeFloatBE=K.writeFloatBE,t.writeDoubleLE=K.writeDoubleLE,t.writeDoubleBE=K.writeDoubleBE,t.fill=K.fill,t.inspect=K.inspect,t.toArrayBuffer=K.toArrayBuffer,t};var tt=/[^+\/0-9A-Za-z-_]/g}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"base64-js":4,ieee754:22,isarray:26}],9:[function(t,e,n){(function(t){function e(t){return Array.isArray?Array.isArray(t):"[object Array]"===_(t)}function i(t){return"boolean"==typeof t}function o(t){return null===t}function r(t){return null==t}function s(t){return"number"==typeof t}function a(t){return"string"==typeof t}function h(t){return"symbol"==typeof t}function l(t){return void 0===t}function c(t){return"[object RegExp]"===_(t)}function u(t){return"object"==typeof t&&null!==t}function d(t){return"[object Date]"===_(t)}function p(t){return"[object Error]"===_(t)||t instanceof Error}function f(t){return"function"==typeof t}function m(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||"undefined"==typeof t}function _(t){return Object.prototype.toString.call(t)}n.isArray=e,n.isBoolean=i,
n.isNull=o,n.isNullOrUndefined=r,n.isNumber=s,n.isString=a,n.isSymbol=h,n.isUndefined=l,n.isRegExp=c,n.isObject=u,n.isDate=d,n.isError=p,n.isFunction=f,n.isPrimitive=m,n.isBuffer=t.isBuffer}).call(this,{isBuffer:t("../../is-buffer/index.js")})},{"../../is-buffer/index.js":24}],10:[function(t,e,n){function i(t){return null===t||void 0===t}function o(t){return t&&"object"==typeof t&&"number"==typeof t.length?"function"!=typeof t.copy||"function"!=typeof t.slice?!1:t.length>0&&"number"!=typeof t[0]?!1:!0:!1}function r(t,e,n){var r,c;if(i(t)||i(e))return!1;if(t.prototype!==e.prototype)return!1;if(h(t))return h(e)?(t=s.call(t),e=s.call(e),l(t,e,n)):!1;if(o(t)){if(!o(e))return!1;if(t.length!==e.length)return!1;for(r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}try{var u=a(t),d=a(e)}catch(p){return!1}if(u.length!=d.length)return!1;for(u.sort(),d.sort(),r=u.length-1;r>=0;r--)if(u[r]!=d[r])return!1;for(r=u.length-1;r>=0;r--)if(c=u[r],!l(t[c],e[c],n))return!1;return typeof t==typeof e}var s=Array.prototype.slice,a=t("./lib/keys.js"),h=t("./lib/is_arguments.js"),l=e.exports=function(t,e,n){return n||(n={}),t===e?!0:t instanceof Date&&e instanceof Date?t.getTime()===e.getTime():!t||!e||"object"!=typeof t&&"object"!=typeof e?n.strict?t===e:t==e:r(t,e,n)}},{"./lib/is_arguments.js":11,"./lib/keys.js":12}],11:[function(t,e,n){function i(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function o(t){return t&&"object"==typeof t&&"number"==typeof t.length&&Object.prototype.hasOwnProperty.call(t,"callee")&&!Object.prototype.propertyIsEnumerable.call(t,"callee")||!1}var r="[object Arguments]"==function(){return Object.prototype.toString.call(arguments)}();n=e.exports=r?i:o,n.supported=i,n.unsupported=o},{}],12:[function(t,e,n){function i(t){var e=[];for(var n in t)e.push(n);return e}n=e.exports="function"==typeof Object.keys?Object.keys:i,n.shim=i},{}],13:[function(t,e,n){function i(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function o(t){return"function"==typeof t}function r(t){return"number"==typeof t}function s(t){return"object"==typeof t&&null!==t}function a(t){return void 0===t}e.exports=i,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._maxListeners=void 0,i.defaultMaxListeners=10,i.prototype.setMaxListeners=function(t){if(!r(t)||0>t||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},i.prototype.emit=function(t){var e,n,i,r,h,l;if(this._events||(this._events={}),"error"===t&&(!this._events.error||s(this._events.error)&&!this._events.error.length)){if(e=arguments[1],e instanceof Error)throw e;throw TypeError('Uncaught, unspecified "error" event.')}if(n=this._events[t],a(n))return!1;if(o(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:for(i=arguments.length,r=new Array(i-1),h=1;i>h;h++)r[h-1]=arguments[h];n.apply(this,r)}else if(s(n)){for(i=arguments.length,r=new Array(i-1),h=1;i>h;h++)r[h-1]=arguments[h];for(l=n.slice(),i=l.length,h=0;i>h;h++)l[h].apply(this,r)}return!0},i.prototype.addListener=function(t,e){var n;if(!o(e))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,o(e.listener)?e.listener:e),this._events[t]?s(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,s(this._events[t])&&!this._events[t].warned){var n;n=a(this._maxListeners)?i.defaultMaxListeners:this._maxListeners,n&&n>0&&this._events[t].length>n&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace())}return this},i.prototype.on=i.prototype.addListener,i.prototype.once=function(t,e){function n(){this.removeListener(t,n),i||(i=!0,e.apply(this,arguments))}if(!o(e))throw TypeError("listener must be a function");var i=!1;return n.listener=e,this.on(t,n),this},i.prototype.removeListener=function(t,e){var n,i,r,a;if(!o(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(n=this._events[t],r=n.length,i=-1,n===e||o(n.listener)&&n.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(s(n)){for(a=r;a-->0;)if(n[a]===e||n[a].listener&&n[a].listener===e){i=a;break}if(0>i)return this;1===n.length?(n.length=0,delete this._events[t]):n.splice(i,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},i.prototype.removeAllListeners=function(t){var e,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[t],o(n))this.removeListener(t,n);else for(;n.length;)this.removeListener(t,n[n.length-1]);return delete this._events[t],this},i.prototype.listeners=function(t){var e;return e=this._events&&this._events[t]?o(this._events[t])?[this._events[t]]:this._events[t].slice():[]},i.listenerCount=function(t,e){var n;return n=t._events&&t._events[e]?o(t._events[e])?1:t._events[e].length:0}},{}],14:[function(t,e,n){"use strict";var i=Object.prototype.hasOwnProperty,o=Object.prototype.toString,r=function(t){return"function"==typeof Array.isArray?Array.isArray(t):"[object Array]"===o.call(t)},s=function(t){if(!t||"[object Object]"!==o.call(t))return!1;var e=i.call(t,"constructor"),n=t.constructor&&t.constructor.prototype&&i.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!e&&!n)return!1;var r;for(r in t);return"undefined"==typeof r||i.call(t,r)};e.exports=function a(){var t,e,n,i,o,h,l=arguments[0],c=1,u=arguments.length,d=!1;for("boolean"==typeof l&&(d=l,l=arguments[1]||{},c=2),(null==l||"object"!=typeof l&&"function"!=typeof l)&&(l={});u>c;++c)if(t=arguments[c],null!=t)for(e in t)n=l[e],i=t[e],l!==i&&(d&&i&&(s(i)||(o=r(i)))?(o?(o=!1,h=n&&r(n)?n:[]):h=n&&s(n)?n:{},l[e]=a(d,h,i)):"undefined"!=typeof i&&(l[e]=i));return l}},{}],15:[function(t,e,n){function i(t,e,n){if(!a(e))throw new TypeError("iterator must be a function");arguments.length<3&&(n=this),"[object Array]"===h.call(t)?o(t,e,n):"string"==typeof t?r(t,e,n):s(t,e,n)}function o(t,e,n){for(var i=0,o=t.length;o>i;i++)l.call(t,i)&&e.call(n,t[i],i,t)}function r(t,e,n){for(var i=0,o=t.length;o>i;i++)e.call(n,t.charAt(i),i,t)}function s(t,e,n){for(var i in t)l.call(t,i)&&e.call(n,t[i],i,t)}var a=t("is-function");e.exports=i;var h=Object.prototype.toString,l=Object.prototype.hasOwnProperty},{"is-function":25}],16:[function(t,e,n){(function(t){var n;n="undefined"!=typeof window?window:"undefined"!=typeof t?t:"undefined"!=typeof self?self:{},e.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],17:[function(t,e,n){var i=t("xmlhttprequest"),o={},r="http://api.globalbioticinteractions.org";o.addQueryParams=function(t,e){function n(e,n){if(e){var i="";for(var o in e)e.hasOwnProperty(o)&&(i+="&"+n+"="+encodeURIComponent(e[o]));t+=i}}var i=function(t){var e="";for(var n in t)t.hasOwnProperty(n)&&(e+="&"+n+"="+t[n]);return e};return e.bbox&&(t=t+"&bbox="+e.bbox),e.location&&(t+=i(e.location)),e.includeObservations&&(t+="&includeObservations=true"),e.exactNameMatchOnly&&(t+="&exactNameMatchOnly=true"),e.excludeChildTaxa&&(t+="&excludeChildTaxa=true"),e.accordingTo&&(t=t+"&accordingTo="+encodeURIComponent(e.accordingTo)),e.interactionType&&(t=t+"&interactionType="+encodeURIComponent(e.interactionType)),n(e.sourceTaxa,"sourceTaxon"),n(e.targetTaxa,"targetTaxon"),n(e.fields,"field"),e.source&&(t=t+"source="+encodeURIComponent(e.source)),t},o.urlForFindCloseTaxonMatches=function(t){return r+"/findCloseMatchesForTaxon/"+encodeURIComponent(t)},o.urlForTaxonInteractionQuery=function(t){var e=r;t.sourceTaxonScientificName?(e=e+"/taxon/"+encodeURIComponent(t.sourceTaxonScientificName),t.interactionType&&(e=e+"/"+encodeURIComponent(t.interactionType),delete t.interactionType),t.targetTaxonScientificName&&(e=e+"/"+encodeURIComponent(t.targetTaxonScientificName))):e+="/interaction";var n={csv:".csv",dot:".dot"};return e+=void 0===n[t.resultType]?"":n[t.resultType],e=e+"?type="+(t.resultType?t.resultType:"json.v2"),this.addQueryParams(e,t)},o.urlForTaxonImageQuery=function(t){return r+"/imagesForName?name="+encodeURIComponent(t)},o.urlForTaxonImageByIdQuery=function(t){return r+"/images/"+encodeURIComponent(t)},o.urlForTaxonImagesQuery=function(t){var e="?";if(t)for(var n in t)t.hasOwnProperty(n)&&(e+="name="+encodeURIComponent(t[n])+"&");return r+"/imagesForNames"+e},o.urlForStudyStats=function(t){var e=r+"/reports/studies";return t.source&&(e=e+"?source="+encodeURIComponent(t.source)),e};var s=function(){var t;if("undefined"==typeof window)t=new i.XMLHttpRequest;else if(window.XMLHttpRequest)t=new XMLHttpRequest;else if("undefined"!=typeof window&&window.ActiveXObject)try{t=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{t=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}return t};o.findSources=function(t){var e=s();e.open("GET",r+"/reports/sources",!0),e.onreadystatechange=function(){if(4===e.readyState&&200===e.status){var n=JSON.parse(e.responseText),i=[],o=n.data;o.forEach(function(t,e){i[e]=t[4]}),t(i)}},e.send(null)},o.findStudyStats=function(t,e){var n=s(),i=o.urlForStudyStats(t);n.open("GET",i,!0),n.onreadystatechange=function(){if(4===n.readyState&&200===n.status){for(var t=JSON.parse(n.responseText),i=[],o=0;o<t.data.length;o++){var r=t.data[o],s={citation:r[0],source:r[3],totalInteractions:r[4],totalTaxa:r[5]},a=r[2];a&&a.length>0&&(s.doi=a);var h=r[1];h&&h.length>0&&null!==h.match("^((http)|(https))://")&&(s.url=h),i[o]=s}e(i)}},n.send(null)},o.findStats=function(t,e){var n=s(),i=r+"/reports/collections";t.source&&(i=i+"?source="+encodeURIComponent(t.source)),n.open("GET",i,!0),n.onreadystatechange=function(){if(4===n.readyState&&200===n.status){var t=JSON.parse(n.responseText),i={numberOfStudies:t.data[0][6],totalInteractions:t.data[0][4],totalTaxa:t.data[0][5],numberOfDistinctSources:t.data[0][7]};e(i)}},n.send(null)},o.sendRequest=function(t,e){t.onreadystatechange=function(){4===t.readyState&&200===t.status&&(e.callback&&e.context?e.callback.call(e.context,JSON.parse(t.responseText)):e(JSON.parse(t.responseText)))},t.send(null)},o.findInteractionTypes=function(t,e){1===arguments.length&&(e=t,t=[]),t=t.map(function(t){return"taxon="+encodeURIComponent(t)});var n=t.length>0?"?"+t.join("&")+"&type=json":"",i=s();i.open("GET",r+"/interactionTypes"+n,!0),o.sendRequest(i,e)},o.findSpeciesInteractions=function(t,e){var n=o.urlForTaxonInteractionQuery(t),i=s();i.open("GET",n,!0),o.sendRequest(i,e)},o.findTaxonInfo=function(t,e){var n=o.urlForTaxonImageQuery(t);o.get(n,e)},o.findTaxaInfo=function(t,e){var n=o.urlForTaxonImagesQuery(t);console.log(n),o.get(n,e)},o.get=function(t,e){var n=s();n.open("GET",t,!0),o.sendRequest(n,e)},o.findCloseTaxonMatches=function(t,e){var n=o.urlForFindCloseTaxonMatches(t),i=s();i.open("GET",n,!0),i.onreadystatechange=function(){if(4===i.readyState&&200===i.status){var t=JSON.parse(i.responseText),n=t.data,r=[];n.forEach(function(t,e){var n=[],i=o.mapCommonNameList(t[1]),s=t[2];s=null===s?"":s;var a=s.split("|");a.forEach(function(t,e){n[e]=t.trim()});var h=t[0].trim();r[e]={scientificName:h,commonNames:i,path:n}}),e(r)}},i.send(null)},o.mapCommonNameList=function(t,e){e="undefined"!=typeof e?!!e:!0,t="string"!=typeof t?"":t;var n={count:0},i=t.split("|").map(function(t){return t.trim()});return i.forEach(function(t){if("undefined"!=typeof t){var i=t.split("@").map(function(t){return t.trim()});"undefined"!=typeof i[1]&&(e||"undefined"==typeof n[i[1]])&&("undefined"==typeof n[i[1]]&&n.count++,n[i[1]]=i[0])}}),n},o.findThumbnailById=function(t,e){t=t||{};var n=o.urlForTaxonImageByIdQuery(t),i=s();i.open("GET",n,!0),o.sendRequest(i,function(t){var n=t.thumbnailURL;e(n)})},e.exports=o},{xmlhttprequest:60}],18:[function(t,e,n){var i=e.exports,o=(t("events").EventEmitter,t("./lib/request")),r=t("url");i.request=function(t,e){"string"==typeof t&&(t=r.parse(t)),t||(t={}),t.host||t.port||(t.port=parseInt(window.location.port,10)),!t.host&&t.hostname&&(t.host=t.hostname),t.protocol||(t.scheme?t.protocol=t.scheme+":":t.protocol=window.location.protocol),t.host||(t.host=window.location.hostname||window.location.host),/:/.test(t.host)&&(t.port||(t.port=t.host.split(":")[1]),t.host=t.host.split(":")[0]),t.port||(t.port="https:"==t.protocol?443:80);var n=new o(new s,t);return e&&n.on("response",e),n},i.get=function(t,e){t.method="GET";var n=i.request(t,e);return n.end(),n},i.Agent=function(){},i.Agent.defaultMaxSockets=4;var s=function(){if("undefined"==typeof window)throw new Error("no window object present");if(window.XMLHttpRequest)return window.XMLHttpRequest;if(window.ActiveXObject){for(var t=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Microsoft.XMLHTTP"],e=0;e<t.length;e++)try{var n=new window.ActiveXObject(t[e]);return function(){if(n){var i=n;return n=null,i}return new window.ActiveXObject(t[e])}}catch(i){}throw new Error("ajax not supported in this browser")}throw new Error("ajax not supported in this browser")}();i.STATUS_CODES={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",300:"Multiple Choices",301:"Moved Permanently",302:"Moved Temporarily",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Time-out",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Large",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Time-out",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"}},{"./lib/request":19,events:13,url:56}],19:[function(t,e,n){var i=t("stream"),o=t("./response"),r=t("Base64"),s=t("inherits"),a=e.exports=function(t,e){var n=this;n.writable=!0,n.xhr=t,n.body=[],n.uri=(e.protocol||"http:")+"//"+e.host+(e.port?":"+e.port:"")+(e.path||"/"),"undefined"==typeof e.withCredentials&&(e.withCredentials=!0);try{t.withCredentials=e.withCredentials}catch(i){}if(e.responseType)try{t.responseType=e.responseType}catch(i){}if(t.open(e.method||"GET",n.uri,!0),t.onerror=function(t){n.emit("error",new Error("Network error"))},n._headers={},e.headers)for(var s=h(e.headers),a=0;a<s.length;a++){var l=s[a];if(n.isSafeRequestHeader(l)){var c=e.headers[l];n.setHeader(l,c)}}e.auth&&this.setHeader("Authorization","Basic "+r.btoa(e.auth));var u=new o;u.on("close",function(){n.emit("close")}),u.on("ready",function(){n.emit("response",u)}),u.on("error",function(t){n.emit("error",t)}),t.onreadystatechange=function(){t.__aborted||u.handle(t)}};s(a,i),a.prototype.setHeader=function(t,e){this._headers[t.toLowerCase()]=e},a.prototype.getHeader=function(t){return this._headers[t.toLowerCase()]},a.prototype.removeHeader=function(t){delete this._headers[t.toLowerCase()]},a.prototype.write=function(t){this.body.push(t)},a.prototype.destroy=function(t){this.xhr.__aborted=!0,this.xhr.abort(),this.emit("close")},a.prototype.end=function(t){void 0!==t&&this.body.push(t);for(var e=h(this._headers),n=0;n<e.length;n++){var i=e[n],o=this._headers[i];if(l(o))for(var r=0;r<o.length;r++)this.xhr.setRequestHeader(i,o[r]);else this.xhr.setRequestHeader(i,o)}if(0===this.body.length)this.xhr.send("");else if("string"==typeof this.body[0])this.xhr.send(this.body.join(""));else if(l(this.body[0])){for(var s=[],n=0;n<this.body.length;n++)s.push.apply(s,this.body[n]);this.xhr.send(s)}else if(/Array/.test(Object.prototype.toString.call(this.body[0]))){for(var a=0,n=0;n<this.body.length;n++)a+=this.body[n].length;for(var s=new this.body[0].constructor(a),c=0,n=0;n<this.body.length;n++)for(var d=this.body[n],r=0;r<d.length;r++)s[c++]=d[r];this.xhr.send(s)}else if(u(this.body[0]))this.xhr.send(this.body[0]);else{for(var s="",n=0;n<this.body.length;n++)s+=this.body[n].toString();this.xhr.send(s)}},a.unsafeHeaders=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","content-transfer-encoding","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"],a.prototype.isSafeRequestHeader=function(t){return t?-1===c(a.unsafeHeaders,t.toLowerCase()):!1};var h=Object.keys||function(t){var e=[];for(var n in t)e.push(n);return e},l=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},c=function(t,e){if(t.indexOf)return t.indexOf(e);for(var n=0;n<t.length;n++)if(t[n]===e)return n;return-1},u=function(t){return"undefined"!=typeof Blob&&t instanceof Blob?!0:"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?!0:"undefined"!=typeof FormData&&t instanceof FormData?!0:void 0}},{"./response":20,Base64:3,inherits:23,stream:37}],20:[function(t,e,n){function i(t){for(var e=t.getAllResponseHeaders().split(/\r?\n/),n={},i=0;i<e.length;i++){var o=e[i];if(""!==o){var r=o.match(/^([^:]+):\s*(.*)/);if(r){var s=r[1].toLowerCase(),a=r[2];void 0!==n[s]?h(n[s])?n[s].push(a):n[s]=[n[s],a]:n[s]=a}else n[o]=!0}}return n}var o=t("stream"),r=t("util"),s=e.exports=function(t){this.offset=0,this.readable=!0};r.inherits(s,o);var a={streaming:!0,status2:!0};s.prototype.getResponse=function(t){var e=String(t.responseType).toLowerCase();return"blob"===e?t.responseBlob||t.response:"arraybuffer"===e?t.response:t.responseText},s.prototype.getHeader=function(t){return this.headers[t.toLowerCase()]},s.prototype.handle=function(t){if(2===t.readyState&&a.status2){try{this.statusCode=t.status,this.headers=i(t)}catch(e){a.status2=!1}a.status2&&this.emit("ready")}else if(a.streaming&&3===t.readyState){try{this.statusCode||(this.statusCode=t.status,this.headers=i(t),this.emit("ready"))}catch(e){}try{this._emitData(t)}catch(e){a.streaming=!1}}else 4===t.readyState&&(this.statusCode||(this.statusCode=t.status,this.emit("ready")),this._emitData(t),t.error?this.emit("error",this.getResponse(t)):this.emit("end"),this.emit("close"))},s.prototype._emitData=function(t){var e=this.getResponse(t);return e.toString().match(/ArrayBuffer/)?(this.emit("data",new Uint8Array(e,this.offset)),void(this.offset=e.byteLength)):void(e.length>this.offset&&(this.emit("data",e.slice(this.offset)),this.offset=e.length))};var h=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},{stream:37,util:59}],21:[function(t,e,n){var i=t("http"),o=e.exports;for(var r in i)i.hasOwnProperty(r)&&(o[r]=i[r]);o.request=function(t,e){return t||(t={}),t.scheme="https",t.protocol="https:",i.request.call(this,t,e)}},{http:18}],22:[function(t,e,n){n.read=function(t,e,n,i,o){var r,s,a=8*o-i-1,h=(1<<a)-1,l=h>>1,c=-7,u=n?o-1:0,d=n?-1:1,p=t[e+u];for(u+=d,r=p&(1<<-c)-1,p>>=-c,c+=a;c>0;r=256*r+t[e+u],u+=d,c-=8);for(s=r&(1<<-c)-1,r>>=-c,c+=i;c>0;s=256*s+t[e+u],u+=d,c-=8);if(0===r)r=1-l;else{if(r===h)return s?NaN:(p?-1:1)*(1/0);s+=Math.pow(2,i),r-=l}return(p?-1:1)*s*Math.pow(2,r-i)},n.write=function(t,e,n,i,o,r){var s,a,h,l=8*r-o-1,c=(1<<l)-1,u=c>>1,d=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,p=i?0:r-1,f=i?1:-1,m=0>e||0===e&&0>1/e?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=c):(s=Math.floor(Math.log(e)/Math.LN2),e*(h=Math.pow(2,-s))<1&&(s--,h*=2),e+=s+u>=1?d/h:d*Math.pow(2,1-u),e*h>=2&&(s++,h/=2),s+u>=c?(a=0,s=c):s+u>=1?(a=(e*h-1)*Math.pow(2,o),s+=u):(a=e*Math.pow(2,u-1)*Math.pow(2,o),s=0));o>=8;t[n+p]=255&a,p+=f,a/=256,o-=8);for(s=s<<o|a,l+=o;l>0;t[n+p]=255&s,p+=f,s/=256,l-=8);t[n+p-f]|=128*m}},{}],23:[function(t,e,n){"function"==typeof Object.create?e.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},{}],24:[function(t,e,n){function i(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}function o(t){return"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&i(t.slice(0,0))}e.exports=function(t){return null!=t&&(i(t)||o(t)||!!t._isBuffer)}},{}],25:[function(t,e,n){function i(t){var e=o.call(t);return"[object Function]"===e||"function"==typeof t&&"[object RegExp]"!==e||"undefined"!=typeof window&&(t===window.setTimeout||t===window.alert||t===window.confirm||t===window.prompt)}e.exports=i;var o=Object.prototype.toString},{}],26:[function(t,e,n){var i={}.toString;e.exports=Array.isArray||function(t){return"[object Array]"==i.call(t)}},{}],27:[function(t,e,n){!function(t,e,n){L.drawVersion="0.3.0-dev",L.drawLocal={draw:{toolbar:{actions:{title:"Cancel drawing",text:"Cancel"},finish:{title:"Finish drawing",text:"Finish"},undo:{title:"Delete last point drawn",text:"Delete last point"},buttons:{polyline:"Draw a polyline",polygon:"Draw a polygon",rectangle:"Draw a rectangle",circle:"Draw a circle",marker:"Draw a marker"}},handlers:{circle:{tooltip:{start:"Click and drag to draw circle."},radius:"Radius"},marker:{tooltip:{start:"Click map to place marker."}},polygon:{tooltip:{start:"Click to start drawing shape.",cont:"Click to continue drawing shape.",end:"Click first point to close this shape."}},polyline:{error:"<strong>Error:</strong> shape edges cannot cross!",tooltip:{start:"Click to start drawing line.",cont:"Click to continue drawing line.",end:"Click last point to finish line."}},rectangle:{tooltip:{start:"Click and drag to draw rectangle."}},simpleshape:{tooltip:{end:"Release mouse to finish drawing."}}}},edit:{toolbar:{actions:{save:{title:"Save changes.",text:"Save"},cancel:{title:"Cancel editing, discards all changes.",text:"Cancel"}},buttons:{edit:"Edit layers.",editDisabled:"No layers to edit.",remove:"Delete layers.",removeDisabled:"No layers to delete."}},handlers:{edit:{tooltip:{text:"Drag handles, or marker to edit feature.",subtext:"Click cancel to undo changes."}},remove:{tooltip:{text:"Click on a feature to remove"}}}}},L.Draw={},L.Draw.Feature=L.Handler.extend({includes:L.Mixin.Events,initialize:function(t,e){this._map=t,this._container=t._container,this._overlayPane=t._panes.overlayPane,this._popupPane=t._panes.popupPane,e&&e.shapeOptions&&(e.shapeOptions=L.Util.extend({},this.options.shapeOptions,e.shapeOptions)),L.setOptions(this,e)},enable:function(){this._enabled||(L.Handler.prototype.enable.call(this),this.fire("enabled",{handler:this.type}),this._map.fire("draw:drawstart",{layerType:this.type}))},disable:function(){this._enabled&&(L.Handler.prototype.disable.call(this),this._map.fire("draw:drawstop",{layerType:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var t=this._map;t&&(L.DomUtil.disableTextSelection(),t.getContainer().focus(),this._tooltip=new L.Tooltip(this._map),L.DomEvent.on(this._container,"keyup",this._cancelDrawing,this))},removeHooks:function(){this._map&&(L.DomUtil.enableTextSelection(),this._tooltip.dispose(),this._tooltip=null,L.DomEvent.off(this._container,"keyup",this._cancelDrawing,this))},setOptions:function(t){L.setOptions(this,t)},_fireCreatedEvent:function(t){this._map.fire("draw:created",{layer:t,layerType:this.type})},_cancelDrawing:function(t){this._map.fire("draw:canceled",{layerType:this.type}),27===t.keyCode&&this.disable()}}),L.Draw.Polyline=L.Draw.Feature.extend({statics:{TYPE:"polyline"},Poly:L.Polyline,options:{allowIntersection:!0,repeatMode:!1,drawError:{color:"#b00b00",timeout:2500},icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),guidelineDistance:20,maxGuideLineLength:4e3,shapeOptions:{stroke:!0,color:"#f06eaa",weight:4,opacity:.5,fill:!1,clickable:!0},metric:!0,feet:!0,showLength:!0,zIndexOffset:2e3},initialize:function(t,e){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this.options.drawError.message=L.drawLocal.draw.handlers.polyline.error,e&&e.drawError&&(e.drawError=L.Util.extend({},this.options.drawError,e.drawError)),this.type=L.Draw.Polyline.TYPE,L.Draw.Feature.prototype.initialize.call(this,t,e)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._markers=[],this._markerGroup=new L.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=new L.Polyline([],this.options.shapeOptions),this._tooltip.updateContent(this._getTooltipText()),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),L.Browser.touch||this._map.on("mouseup",this._onMouseUp,this),this._mouseMarker.on("mousedown",this._onMouseDown,this).on("mouseout",this._onMouseOut,this).on("mouseup",this._onMouseUp,this).on("mousemove",this._onMouseMove,this).addTo(this._map),this._map.on("mouseup",this._onMouseUp,this).on("mousemove",this._onMouseMove,this).on("zoomlevelschange",this._onZoomEnd,this).on("click",this._onTouch,this).on("zoomend",this._onZoomEnd,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._clearHideErrorTimeout(),this._cleanUpShape(),this._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers,this._map.removeLayer(this._poly),delete this._poly,this._mouseMarker.off("mousedown",this._onMouseDown,this).off("mouseout",this._onMouseOut,this).off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._clearGuides(),this._map.off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this).off("zoomlevelschange",this._onZoomEnd,this).off("zoomend",this._onZoomEnd,this).off("click",this._onTouch,this)},deleteLastVertex:function(){if(!(this._markers.length<=1)){var t=this._markers.pop(),e=this._poly,n=this._poly.spliceLatLngs(e.getLatLngs().length-1,1)[0];this._markerGroup.removeLayer(t),e.getLatLngs().length<2&&this._map.removeLayer(e),this._vertexChanged(n,!1)}},addVertex:function(t){var e=this._markers.length;return e>0&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(t)?void this._showErrorTooltip():(this._errorShown&&this._hideErrorTooltip(),this._markers.push(this._createMarker(t)),this._poly.addLatLng(t),2===this._poly.getLatLngs().length&&this._map.addLayer(this._poly),void this._vertexChanged(t,!0))},completeShape:function(){this._markers.length<=1||(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_finishShape:function(){var t=this._poly.newLatLngIntersects(this._poly.getLatLngs()[this._poly.getLatLngs().length-1]);return!this.options.allowIntersection&&t||!this._shapeIsValid()?void this._showErrorTooltip():(this._fireCreatedEvent(),this.disable(),void(this.options.repeatMode&&this.enable()))},_shapeIsValid:function(){return!0},_onZoomEnd:function(){null!==this._markers&&this._updateGuide()},_onMouseMove:function(t){var e=this._map.mouseEventToLayerPoint(t.originalEvent),n=this._map.layerPointToLatLng(e);this._currentLatLng=n,this._updateTooltip(n),this._updateGuide(e),this._mouseMarker.setLatLng(n),L.DomEvent.preventDefault(t.originalEvent)},_vertexChanged:function(t,e){this._map.fire("draw:drawvertex",{layers:this._markerGroup}),this._updateFinishHandler(),this._updateRunningMeasure(t,e),this._clearGuides(),this._updateTooltip()},_onMouseDown:function(t){var e=t.originalEvent;this._mouseDownOrigin=L.point(e.clientX,e.clientY)},_onMouseUp:function(e){if(this._mouseDownOrigin){var n=L.point(e.originalEvent.clientX,e.originalEvent.clientY).distanceTo(this._mouseDownOrigin);Math.abs(n)<9*(t.devicePixelRatio||1)&&this.addVertex(e.latlng)}this._mouseDownOrigin=null},_onTouch:function(t){L.Browser.touch&&(this._onMouseDown(t),this._onMouseUp(t))},_onMouseOut:function(){this._tooltip&&this._tooltip._onMouseOut.call(this._tooltip)},_updateFinishHandler:function(){var t=this._markers.length;t>1&&this._markers[t-1].on("click",this._finishShape,this),t>2&&this._markers[t-2].off("click",this._finishShape,this)},_createMarker:function(t){var e=new L.Marker(t,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});return this._markerGroup.addLayer(e),e},_updateGuide:function(t){var e=this._markers?this._markers.length:0;e>0&&(t=t||this._map.latLngToLayerPoint(this._currentLatLng),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[e-1].getLatLng()),t))},_updateTooltip:function(t){var e=this._getTooltipText();t&&this._tooltip.updatePosition(t),this._errorShown||this._tooltip.updateContent(e)},_drawGuide:function(t,e){var n,i,o,r=Math.floor(Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))),s=this.options.guidelineDistance,a=this.options.maxGuideLineLength,h=r>a?r-a:s;for(this._guidesContainer||(this._guidesContainer=L.DomUtil.create("div","leaflet-draw-guides",this._overlayPane));r>h;h+=this.options.guidelineDistance)n=h/r,i={x:Math.floor(t.x*(1-n)+n*e.x),y:Math.floor(t.y*(1-n)+n*e.y)},o=L.DomUtil.create("div","leaflet-draw-guide-dash",this._guidesContainer),o.style.backgroundColor=this._errorShown?this.options.drawError.color:this.options.shapeOptions.color,L.DomUtil.setPosition(o,i)},_updateGuideColor:function(t){if(this._guidesContainer)for(var e=0,n=this._guidesContainer.childNodes.length;n>e;e++)this._guidesContainer.childNodes[e].style.backgroundColor=t},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild)},_getTooltipText:function(){var t,e,n=this.options.showLength;return 0===this._markers.length?t={text:L.drawLocal.draw.handlers.polyline.tooltip.start}:(e=n?this._getMeasurementString():"",t=1===this._markers.length?{text:L.drawLocal.draw.handlers.polyline.tooltip.cont,subtext:e}:{text:L.drawLocal.draw.handlers.polyline.tooltip.end,subtext:e}),t},_updateRunningMeasure:function(t,e){var n,i,o=this._markers.length;1===this._markers.length?this._measurementRunningTotal=0:(n=o-(e?2:1),i=t.distanceTo(this._markers[n].getLatLng()),this._measurementRunningTotal+=i*(e?1:-1))},_getMeasurementString:function(){var t,e=this._currentLatLng,n=this._markers[this._markers.length-1].getLatLng();return t=this._measurementRunningTotal+e.distanceTo(n),L.GeometryUtil.readableDistance(t,this.options.metric,this.options.feet)},_showErrorTooltip:function(){this._errorShown=!0,this._tooltip.showAsError().updateContent({text:this.options.drawError.message}),this._updateGuideColor(this.options.drawError.color),this._poly.setStyle({color:this.options.drawError.color}),this._clearHideErrorTimeout(),this._hideErrorTimeout=setTimeout(L.Util.bind(this._hideErrorTooltip,this),this.options.drawError.timeout)},_hideErrorTooltip:function(){this._errorShown=!1,this._clearHideErrorTimeout(),this._tooltip.removeError().updateContent(this._getTooltipText()),this._updateGuideColor(this.options.shapeOptions.color),
this._poly.setStyle({color:this.options.shapeOptions.color})},_clearHideErrorTimeout:function(){this._hideErrorTimeout&&(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_cleanUpShape:function(){this._markers.length>1&&this._markers[this._markers.length-1].off("click",this._finishShape,this)},_fireCreatedEvent:function(){var t=new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions);L.Draw.Feature.prototype._fireCreatedEvent.call(this,t)}}),L.Draw.Polygon=L.Draw.Polyline.extend({statics:{TYPE:"polygon"},Poly:L.Polygon,options:{showArea:!1,shapeOptions:{stroke:!0,color:"#f06eaa",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},metric:!0},initialize:function(t,e){L.Draw.Polyline.prototype.initialize.call(this,t,e),this.type=L.Draw.Polygon.TYPE},_updateFinishHandler:function(){var t=this._markers.length;1===t&&this._markers[0].on("click",this._finishShape,this),t>2&&(this._markers[t-1].on("dblclick",this._finishShape,this),t>3&&this._markers[t-2].off("dblclick",this._finishShape,this))},_getTooltipText:function(){var t,e;return 0===this._markers.length?t=L.drawLocal.draw.handlers.polygon.tooltip.start:this._markers.length<3?t=L.drawLocal.draw.handlers.polygon.tooltip.cont:(t=L.drawLocal.draw.handlers.polygon.tooltip.end,e=this._getMeasurementString()),{text:t,subtext:e}},_getMeasurementString:function(){var t=this._area;return t?L.GeometryUtil.readableArea(t,this.options.metric):null},_shapeIsValid:function(){return this._markers.length>=3},_vertexChanged:function(t,e){var n;!this.options.allowIntersection&&this.options.showArea&&(n=this._poly.getLatLngs(),this._area=L.GeometryUtil.geodesicArea(n)),L.Draw.Polyline.prototype._vertexChanged.call(this,t,e)},_cleanUpShape:function(){var t=this._markers.length;t>0&&(this._markers[0].off("click",this._finishShape,this),t>2&&this._markers[t-1].off("dblclick",this._finishShape,this))}}),L.SimpleShape={},L.Draw.SimpleShape=L.Draw.Feature.extend({options:{repeatMode:!1},initialize:function(t,e){this._endLabelText=L.drawLocal.draw.handlers.simpleshape.tooltip.end,L.Draw.Feature.prototype.initialize.call(this,t,e)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._mapDraggable=this._map.dragging.enabled(),this._mapDraggable&&this._map.dragging.disable(),this._container.style.cursor="crosshair",this._tooltip.updateContent({text:this._initialLabelText}),this._map.on("mousedown",this._onMouseDown,this).on("mousemove",this._onMouseMove,this).on("touchstart",this._onMouseDown,this).on("touchmove",this._onMouseMove,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._mapDraggable&&this._map.dragging.enable(),this._container.style.cursor="",this._map.off("mousedown",this._onMouseDown,this).off("mousemove",this._onMouseMove,this).off("touchstart",this._onMouseDown,this).off("touchmove",this._onMouseMove,this),L.DomEvent.off(e,"mouseup",this._onMouseUp,this),L.DomEvent.off(e,"touchend",this._onMouseUp,this),this._shape&&(this._map.removeLayer(this._shape),delete this._shape)),this._isDrawing=!1},_getTooltipText:function(){return{text:this._endLabelText}},_onMouseDown:function(t){this._isDrawing=!0,this._startLatLng=t.latlng,L.DomEvent.on(e,"mouseup",this._onMouseUp,this).on(e,"touchend",this._onMouseUp,this).preventDefault(t.originalEvent)},_onMouseMove:function(t){var e=t.latlng;this._tooltip.updatePosition(e),this._isDrawing&&(this._tooltip.updateContent(this._getTooltipText()),this._drawShape(e))},_onMouseUp:function(){this._shape&&this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()}}),L.Draw.Rectangle=L.Draw.SimpleShape.extend({statics:{TYPE:"rectangle"},options:{shapeOptions:{stroke:!0,color:"#f06eaa",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},metric:!0},initialize:function(t,e){this.type=L.Draw.Rectangle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.rectangle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,t,e)},_drawShape:function(t){this._shape?this._shape.setBounds(new L.LatLngBounds(this._startLatLng,t)):(this._shape=new L.Rectangle(new L.LatLngBounds(this._startLatLng,t),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var t=new L.Rectangle(this._shape.getBounds(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,t)},_getTooltipText:function(){var t,e,n,i=L.Draw.SimpleShape.prototype._getTooltipText.call(this),o=this._shape;return o&&(t=this._shape.getLatLngs(),e=L.GeometryUtil.geodesicArea(t),n=L.GeometryUtil.readableArea(e,this.options.metric)),{text:i.text,subtext:n}}}),L.Draw.Circle=L.Draw.SimpleShape.extend({statics:{TYPE:"circle"},options:{shapeOptions:{stroke:!0,color:"#f06eaa",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showRadius:!0,metric:!0,feet:!0},initialize:function(t,e){this.type=L.Draw.Circle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,t,e)},_drawShape:function(t){this._shape?this._shape.setRadius(this._startLatLng.distanceTo(t)):(this._shape=new L.Circle(this._startLatLng,this._startLatLng.distanceTo(t),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var t=new L.Circle(this._startLatLng,this._shape.getRadius(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,t)},_onMouseMove:function(t){var e,n=t.latlng,i=this.options.showRadius,o=this.options.metric;this._tooltip.updatePosition(n),this._isDrawing&&(this._drawShape(n),e=this._shape.getRadius().toFixed(1),this._tooltip.updateContent({text:this._endLabelText,subtext:i?L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(e,o,this.options.feet):""}))}}),L.Draw.Marker=L.Draw.Feature.extend({statics:{TYPE:"marker"},options:{icon:new L.Icon.Default,repeatMode:!1,zIndexOffset:2e3},initialize:function(t,e){this.type=L.Draw.Marker.TYPE,L.Draw.Feature.prototype.initialize.call(this,t,e)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._tooltip.updateContent({text:L.drawLocal.draw.handlers.marker.tooltip.start}),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("click",this._onClick,this).addTo(this._map),this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onTouch,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._marker&&(this._marker.off("click",this._onClick,this),this._map.off("click",this._onClick,this).off("click",this._onTouch,this).removeLayer(this._marker),delete this._marker),this._mouseMarker.off("click",this._onClick,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._map.off("mousemove",this._onMouseMove,this))},_onMouseMove:function(t){var e=t.latlng;this._tooltip.updatePosition(e),this._mouseMarker.setLatLng(e),this._marker?(e=this._mouseMarker.getLatLng(),this._marker.setLatLng(e)):(this._marker=new L.Marker(e,{icon:this.options.icon,zIndexOffset:this.options.zIndexOffset}),this._marker.on("click",this._onClick,this),this._map.on("click",this._onClick,this).addLayer(this._marker))},_onClick:function(){this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_onTouch:function(t){this._onMouseMove(t),this._onClick()},_fireCreatedEvent:function(){var t=new L.Marker.Touch(this._marker.getLatLng(),{icon:this.options.icon});L.Draw.Feature.prototype._fireCreatedEvent.call(this,t)}}),L.Edit=L.Edit||{},L.Edit.Marker=L.Handler.extend({initialize:function(t,e){this._marker=t,L.setOptions(this,e)},addHooks:function(){var t=this._marker;t.dragging.enable(),t.on("dragend",this._onDragEnd,t),this._toggleMarkerHighlight()},removeHooks:function(){var t=this._marker;t.dragging.disable(),t.off("dragend",this._onDragEnd,t),this._toggleMarkerHighlight()},_onDragEnd:function(t){var e=t.target;e.edited=!0,this._map.fire("draw:editmove",{layer:e})},_toggleMarkerHighlight:function(){var t=this._marker._icon;t&&(t.style.display="none",L.DomUtil.hasClass(t,"leaflet-edit-marker-selected")?(L.DomUtil.removeClass(t,"leaflet-edit-marker-selected"),this._offsetMarker(t,-4)):(L.DomUtil.addClass(t,"leaflet-edit-marker-selected"),this._offsetMarker(t,4)),t.style.display="")},_offsetMarker:function(t,e){var n=parseInt(t.style.marginTop,10)-e,i=parseInt(t.style.marginLeft,10)-e;t.style.marginTop=n+"px",t.style.marginLeft=i+"px"}}),L.Marker.addInitHook(function(){L.Edit.Marker&&(this.editing=new L.Edit.Marker(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.Poly=L.Handler.extend({options:{},initialize:function(t,e){this.latlngs=[t._latlngs],t._holes&&(this.latlngs=this.latlngs.concat(t._holes)),this._poly=t,L.setOptions(this,e),this._poly.on("revert-edited",this._updateLatLngs,this)},_eachVertexHandler:function(t){for(var e=0;e<this._verticesHandlers.length;e++)t(this._verticesHandlers[e])},addHooks:function(){this._initHandlers(),this._eachVertexHandler(function(t){t.addHooks()})},removeHooks:function(){this._eachVertexHandler(function(t){t.removeHooks()})},updateMarkers:function(){this._eachVertexHandler(function(t){t.updateMarkers()})},_initHandlers:function(){this._verticesHandlers=[];for(var t=0;t<this.latlngs.length;t++)this._verticesHandlers.push(new L.Edit.PolyVerticesEdit(this._poly,this.latlngs[t],this.options))},_updateLatLngs:function(t){this.latlngs=[t.layer._latlngs],t.layer._holes&&(this.latlngs=this.latlngs.concat(t.layer._holes))}}),L.Edit.PolyVerticesEdit=L.Handler.extend({options:{icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),drawError:{color:"#b00b00",timeout:1e3}},initialize:function(t,e,n){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this._poly=t,n&&n.drawError&&(n.drawError=L.Util.extend({},this.options.drawError,n.drawError)),this._latlngs=e,L.setOptions(this,n)},addHooks:function(){var t=this._poly;t instanceof L.Polygon||(t.options.fill=!1),t.setStyle(t.options.editing),this._poly._map&&(this._map=this._poly._map,this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){var t=this._poly;t.setStyle(t.options.original),t._map&&(t._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._markers=[];var t,e,n,i,o=this._latlngs;for(t=0,n=o.length;n>t;t++)i=this._createMarker(o[t],t),i.on("click",this._onMarkerClick,this),this._markers.push(i);var r,s;for(t=0,e=n-1;n>t;e=t++)(0!==t||L.Polygon&&this._poly instanceof L.Polygon)&&(r=this._markers[e],s=this._markers[t],this._createMiddleMarker(r,s),this._updatePrevNext(r,s))},_createMarker:function(t,e){var n=new L.Marker.Touch(t,{draggable:!0,icon:this.options.icon});return n._origLatLng=t,n._index=e,n.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._fireEdit,this).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._fireEdit,this).on("MSPointerUp",this._fireEdit,this),this._markerGroup.addLayer(n),n},_onMarkerDragStart:function(){this._poly.fire("editstart")},_spliceLatLngs:function(){var t=[].splice.apply(this._latlngs,arguments);return this._poly._convertLatLngs(this._latlngs,!0),this._poly.redraw(),t},_removeMarker:function(t){var e=t._index;this._markerGroup.removeLayer(t),this._markers.splice(e,1),this._spliceLatLngs(e,1),this._updateIndexes(e,-1),t.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._fireEdit,this).off("touchmove",this._onMarkerDrag,this).off("touchend",this._fireEdit,this).off("click",this._onMarkerClick,this).off("MSPointerMove",this._onTouchMove,this).off("MSPointerUp",this._fireEdit,this)},_fireEdit:function(){this._poly.edited=!0,this._poly.fire("edit"),this._poly._map.fire("draw:editvertex",{layers:this._markerGroup})},_onMarkerDrag:function(t){var e=t.target,n=this._poly;if(L.extend(e._origLatLng,e._latlng),e._middleLeft&&e._middleLeft.setLatLng(this._getMiddleLatLng(e._prev,e)),e._middleRight&&e._middleRight.setLatLng(this._getMiddleLatLng(e,e._next)),n.options.poly){var i=n._map._editTooltip;if(!n.options.poly.allowIntersection&&n.intersects()){var o=n.options.color;n.setStyle({color:this.options.drawError.color}),i&&i.updateContent({text:L.drawLocal.draw.handlers.polyline.error}),setTimeout(function(){n.setStyle({color:o}),i&&i.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext})},1e3),this._onMarkerClick(t)}}this._poly.redraw(),this._poly.fire("editdrag")},_onMarkerClick:function(t){var e=L.Polygon&&this._poly instanceof L.Polygon?4:3,n=t.target;this._latlngs.length<e||(this._removeMarker(n),this._updatePrevNext(n._prev,n._next),n._middleLeft&&this._markerGroup.removeLayer(n._middleLeft),n._middleRight&&this._markerGroup.removeLayer(n._middleRight),n._prev&&n._next?this._createMiddleMarker(n._prev,n._next):n._prev?n._next||(n._prev._middleRight=null):n._next._middleLeft=null,this._fireEdit())},_onTouchMove:function(t){var e=this._map.mouseEventToLayerPoint(t.originalEvent.touches[0]),n=this._map.layerPointToLatLng(e),i=t.target;L.extend(i._origLatLng,n),i._middleLeft&&i._middleLeft.setLatLng(this._getMiddleLatLng(i._prev,i)),i._middleRight&&i._middleRight.setLatLng(this._getMiddleLatLng(i,i._next)),this._poly.redraw(),this.updateMarkers()},_updateIndexes:function(t,e){this._markerGroup.eachLayer(function(n){n._index>t&&(n._index+=e)})},_createMiddleMarker:function(t,e){var n,i,o,r=this._getMiddleLatLng(t,e),s=this._createMarker(r);s.setOpacity(.6),t._middleRight=e._middleLeft=s,i=function(){s.off("touchmove",i,this);var o=e._index;s._index=o,s.off("click",n,this).on("click",this._onMarkerClick,this),r.lat=s.getLatLng().lat,r.lng=s.getLatLng().lng,this._spliceLatLngs(o,0,r),this._markers.splice(o,0,s),s.setOpacity(1),this._updateIndexes(o,1),e._index++,this._updatePrevNext(t,s),this._updatePrevNext(s,e),this._poly.fire("editstart")},o=function(){s.off("dragstart",i,this),s.off("dragend",o,this),s.off("touchmove",i,this),this._createMiddleMarker(t,s),this._createMiddleMarker(s,e)},n=function(){i.call(this),o.call(this),this._fireEdit()},s.on("click",n,this).on("dragstart",i,this).on("dragend",o,this).on("touchmove",i,this),this._markerGroup.addLayer(s)},_updatePrevNext:function(t,e){t&&(t._next=e),e&&(e._prev=t)},_getMiddleLatLng:function(t,e){var n=this._poly._map,i=n.project(t.getLatLng()),o=n.project(e.getLatLng());return n.unproject(i._add(o)._divideBy(2))}}),L.Polyline.addInitHook(function(){this.editing||(L.Edit.Poly&&(this.editing=new L.Edit.Poly(this,this.options.poly),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()}))}),L.Edit=L.Edit||{},L.Edit.SimpleShape=L.Handler.extend({options:{moveIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move"}),resizeIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize"}),touchMoveIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move leaflet-touch-icon"}),touchResizeIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize leaflet-touch-icon"})},initialize:function(t,e){L.Browser.touch&&(this.options.moveIcon=this.options.touchMoveIcon,this.options.resizeIcon=this.options.touchResizeIcon),this._shape=t,L.Util.setOptions(this,e)},addHooks:function(){var t=this._shape;this._shape._map&&(this._map=this._shape._map,t.setStyle(t.options.editing),t._map&&(this._map=t._map,this._markerGroup||this._initMarkers(),this._map.addLayer(this._markerGroup)))},removeHooks:function(){var t=this._shape;if(t.setStyle(t.options.original),t._map){this._unbindMarker(this._moveMarker);for(var e=0,n=this._resizeMarkers.length;n>e;e++)this._unbindMarker(this._resizeMarkers[e]);this._resizeMarkers=null,this._map.removeLayer(this._markerGroup),delete this._markerGroup}this._map=null},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._createMoveMarker(),this._createResizeMarker()},_createMoveMarker:function(){},_createResizeMarker:function(){},_createMarker:function(t,e){var n=new L.Marker.Touch(t,{draggable:!0,icon:e,zIndexOffset:10});return this._bindMarker(n),this._markerGroup.addLayer(n),n},_bindMarker:function(t){t.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._onMarkerDragEnd,this).on("touchstart",this._onTouchStart,this).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onTouchEnd,this).on("MSPointerUp",this._onTouchEnd,this)},_unbindMarker:function(t){t.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._onMarkerDragEnd,this).off("touchstart",this._onTouchStart,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onTouchEnd,this).off("MSPointerUp",this._onTouchEnd,this)},_onMarkerDragStart:function(t){var e=t.target;e.setOpacity(0),this._shape.fire("editstart")},_fireEdit:function(){this._shape.edited=!0,this._shape.fire("edit")},_onMarkerDrag:function(t){var e=t.target,n=e.getLatLng();e===this._moveMarker?this._move(n):this._resize(n),this._shape.redraw(),this._shape.fire("editdrag")},_onMarkerDragEnd:function(t){var e=t.target;e.setOpacity(1),this._fireEdit()},_onTouchStart:function(t){if(L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,t),"function"==typeof this._getCorners){var e=this._getCorners(),n=t.target,i=n._cornerIndex;n.setOpacity(0),this._oppositeCorner=e[(i+2)%4],this._toggleCornerMarkers(0,i)}this._shape.fire("editstart")},_onTouchMove:function(t){var e=this._map.mouseEventToLayerPoint(t.originalEvent.touches[0]),n=this._map.layerPointToLatLng(e),i=t.target;return i===this._moveMarker?this._move(n):this._resize(n),this._shape.redraw(),!1},_onTouchEnd:function(t){var e=t.target;e.setOpacity(1),this.updateMarkers(),this._fireEdit()},_move:function(){},_resize:function(){}}),L.Edit=L.Edit||{},L.Edit.Rectangle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var t=this._shape.getBounds(),e=t.getCenter();this._moveMarker=this._createMarker(e,this.options.moveIcon)},_createResizeMarker:function(){var t=this._getCorners();this._resizeMarkers=[];for(var e=0,n=t.length;n>e;e++)this._resizeMarkers.push(this._createMarker(t[e],this.options.resizeIcon)),this._resizeMarkers[e]._cornerIndex=e},_onMarkerDragStart:function(t){L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,t);var e=this._getCorners(),n=t.target,i=n._cornerIndex;this._oppositeCorner=e[(i+2)%4],this._toggleCornerMarkers(0,i)},_onMarkerDragEnd:function(t){var e,n,i=t.target;i===this._moveMarker&&(e=this._shape.getBounds(),n=e.getCenter(),i.setLatLng(n)),this._toggleCornerMarkers(1),this._repositionCornerMarkers(),L.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this,t)},_move:function(t){for(var e,n=this._shape.getLatLngs(),i=this._shape.getBounds(),o=i.getCenter(),r=[],s=0,a=n.length;a>s;s++)e=[n[s].lat-o.lat,n[s].lng-o.lng],r.push([t.lat+e[0],t.lng+e[1]]);this._shape.setLatLngs(r),this._repositionCornerMarkers(),this._map.fire("draw:editmove",{layer:this._shape})},_resize:function(t){var e;this._shape.setBounds(L.latLngBounds(t,this._oppositeCorner)),e=this._shape.getBounds(),this._moveMarker.setLatLng(e.getCenter()),this._map.fire("draw:editresize",{layer:this._shape})},_getCorners:function(){var t=this._shape.getBounds(),e=t.getNorthWest(),n=t.getNorthEast(),i=t.getSouthEast(),o=t.getSouthWest();return[e,n,i,o]},_toggleCornerMarkers:function(t){for(var e=0,n=this._resizeMarkers.length;n>e;e++)this._resizeMarkers[e].setOpacity(t)},_repositionCornerMarkers:function(){for(var t=this._getCorners(),e=0,n=this._resizeMarkers.length;n>e;e++)this._resizeMarkers[e].setLatLng(t[e])}}),L.Rectangle.addInitHook(function(){L.Edit.Rectangle&&(this.editing=new L.Edit.Rectangle(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.Circle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var t=this._shape.getLatLng();this._moveMarker=this._createMarker(t,this.options.moveIcon)},_createResizeMarker:function(){var t=this._shape.getLatLng(),e=this._getResizeMarkerPoint(t);this._resizeMarkers=[],this._resizeMarkers.push(this._createMarker(e,this.options.resizeIcon))},_getResizeMarkerPoint:function(t){var e=this._shape._radius*Math.cos(Math.PI/4),n=this._map.project(t);return this._map.unproject([n.x+e,n.y-e])},_move:function(t){var e=this._getResizeMarkerPoint(t);this._resizeMarkers[0].setLatLng(e),this._shape.setLatLng(t),this._map.fire("draw:editmove",{layer:this._shape})},_resize:function(t){var e=this._moveMarker.getLatLng(),n=e.distanceTo(t);this._shape.setRadius(n),this._map.fire("draw:editresize",{layer:this._shape})}}),L.Circle.addInitHook(function(){L.Edit.Circle&&(this.editing=new L.Edit.Circle(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()})}),L.Map.mergeOptions({touchExtend:!0}),L.Map.TouchExtend=L.Handler.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane},addHooks:function(){L.DomEvent.on(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.on(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.on(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.on(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.on(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.on(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.on(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.on(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.on(this._container,"touchleave",this._onTouchLeave,this))},removeHooks:function(){L.DomEvent.off(this._container,"touchstart",this._onTouchStart),L.DomEvent.off(this._container,"touchend",this._onTouchEnd),L.DomEvent.off(this._container,"touchmove",this._onTouchMove),this._detectIE()?(L.DomEvent.off(this._container,"MSPointerDowm",this._onTouchStart),L.DomEvent.off(this._container,"MSPointerUp",this._onTouchEnd),L.DomEvent.off(this._container,"MSPointerMove",this._onTouchMove),L.DomEvent.off(this._container,"MSPointerCancel",this._onTouchCancel)):(L.DomEvent.off(this._container,"touchcancel",this._onTouchCancel),L.DomEvent.off(this._container,"touchleave",this._onTouchLeave))},_touchEvent:function(t,e){var n={};if("undefined"!=typeof t.touches){if(!t.touches.length)return;n=t.touches[0]}else{if("touch"!==t.pointerType)return;if(n=t,!this._filterClick(t))return}var i=this._map.mouseEventToContainerPoint(n),o=this._map.mouseEventToLayerPoint(n),r=this._map.layerPointToLatLng(o);this._map.fire(e,{latlng:r,layerPoint:o,containerPoint:i,pageX:n.pageX,pageY:n.pageY,originalEvent:t})},_filterClick:function(t){var e=t.timeStamp||t.originalEvent.timeStamp,n=L.DomEvent._lastClick&&e-L.DomEvent._lastClick;return n&&n>100&&500>n||t.target._simulatedClick&&!t._simulated?(L.DomEvent.stop(t),!1):(L.DomEvent._lastClick=e,!0)},_onTouchStart:function(t){if(this._map._loaded){var e="touchstart";this._touchEvent(t,e)}},_onTouchEnd:function(t){if(this._map._loaded){var e="touchend";this._touchEvent(t,e)}},_onTouchCancel:function(t){if(this._map._loaded){var e="touchcancel";this._detectIE()&&(e="pointercancel"),this._touchEvent(t,e)}},_onTouchLeave:function(t){if(this._map._loaded){var e="touchleave";this._touchEvent(t,e)}},_onTouchMove:function(t){if(this._map._loaded){var e="touchmove";this._touchEvent(t,e)}},_detectIE:function(){var e=t.navigator.userAgent,n=e.indexOf("MSIE ");if(n>0)return parseInt(e.substring(n+5,e.indexOf(".",n)),10);var i=e.indexOf("Trident/");if(i>0){var o=e.indexOf("rv:");return parseInt(e.substring(o+3,e.indexOf(".",o)),10)}var r=e.indexOf("Edge/");return r>0?parseInt(e.substring(r+5,e.indexOf(".",r)),10):!1}}),L.Map.addInitHook("addHandler","touchExtend",L.Map.TouchExtend),L.Marker.Touch=L.Marker.extend({_initInteraction:function(){if(this.options.clickable){var t=this._icon,e=["dblclick","mousedown","mouseover","mouseout","contextmenu","touchstart","touchend","touchmove"];this._detectIE?e.concat(["MSPointerDown","MSPointerUp","MSPointerMove","MSPointerCancel"]):e.concat(["touchcancel"]),L.DomUtil.addClass(t,"leaflet-clickable"),L.DomEvent.on(t,"click",this._onMouseClick,this),L.DomEvent.on(t,"keypress",this._onKeyPress,this);for(var n=0;n<e.length;n++)L.DomEvent.on(t,e[n],this._fireMouseEvent,this);L.Handler.MarkerDrag&&(this.dragging=new L.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_detectIE:function(){var e=t.navigator.userAgent,n=e.indexOf("MSIE ");if(n>0)return parseInt(e.substring(n+5,e.indexOf(".",n)),10);var i=e.indexOf("Trident/");if(i>0){var o=e.indexOf("rv:");return parseInt(e.substring(o+3,e.indexOf(".",o)),10)}var r=e.indexOf("Edge/");return r>0?parseInt(e.substring(r+5,e.indexOf(".",r)),10):!1}}),L.LatLngUtil={cloneLatLngs:function(t){for(var e=[],n=0,i=t.length;i>n;n++)e.push(this.cloneLatLng(t[n]));return e},cloneLatLng:function(t){return L.latLng(t.lat,t.lng)}},L.GeometryUtil=L.extend(L.GeometryUtil||{},{geodesicArea:function(t){var e,n,i=t.length,o=0,r=L.LatLng.DEG_TO_RAD;if(i>2){for(var s=0;i>s;s++)e=t[s],n=t[(s+1)%i],o+=(n.lng-e.lng)*r*(2+Math.sin(e.lat*r)+Math.sin(n.lat*r));o=6378137*o*6378137/2}return Math.abs(o)},readableArea:function(t,e){var n;return e?n=t>=1e4?(1e-4*t).toFixed(2)+" ha":t.toFixed(2)+" m&sup2;":(t/=.836127,n=t>=3097600?(t/3097600).toFixed(2)+" mi&sup2;":t>=4840?(t/4840).toFixed(2)+" acres":Math.ceil(t)+" yd&sup2;"),n},readableDistance:function(t,e,n){var i;if(e)i=t>1e3?(t/1e3).toFixed(2)+" km":Math.ceil(t)+" m";else if(t*=1.09361,t>1760)i=(t/1760).toFixed(2)+" miles";else{var o=" yd";n&&(t=3*t,o=" ft"),i=Math.ceil(t)+o}return i}}),L.Util.extend(L.LineUtil,{segmentsIntersect:function(t,e,n,i){return this._checkCounterclockwise(t,n,i)!==this._checkCounterclockwise(e,n,i)&&this._checkCounterclockwise(t,e,n)!==this._checkCounterclockwise(t,e,i)},_checkCounterclockwise:function(t,e,n){return(n.y-t.y)*(e.x-t.x)>(e.y-t.y)*(n.x-t.x)}}),L.Polyline.include({intersects:function(){var t,e,n,i=this._originalPoints,o=i?i.length:0;if(this._tooFewPointsForIntersection())return!1;for(t=o-1;t>=3;t--)if(e=i[t-1],n=i[t],this._lineSegmentsIntersectsRange(e,n,t-2))return!0;return!1},newLatLngIntersects:function(t,e){return this._map?this.newPointIntersects(this._map.latLngToLayerPoint(t),e):!1},newPointIntersects:function(t,e){var n=this._originalPoints,i=n?n.length:0,o=n?n[i-1]:null,r=i-2;return this._tooFewPointsForIntersection(1)?!1:this._lineSegmentsIntersectsRange(o,t,r,e?1:0)},_tooFewPointsForIntersection:function(t){var e=this._originalPoints,n=e?e.length:0;return n+=t||0,!this._originalPoints||3>=n},_lineSegmentsIntersectsRange:function(t,e,n,i){var o,r,s=this._originalPoints;i=i||0;for(var a=n;a>i;a--)if(o=s[a-1],r=s[a],L.LineUtil.segmentsIntersect(t,e,o,r))return!0;return!1}}),L.Polygon.include({intersects:function(){var t,e,n,i,o,r=this._originalPoints;return this._tooFewPointsForIntersection()?!1:(t=L.Polyline.prototype.intersects.call(this))?!0:(e=r.length,n=r[0],i=r[e-1],o=e-2,this._lineSegmentsIntersectsRange(i,n,o,1))}}),L.Control.Draw=L.Control.extend({options:{position:"topleft",draw:{},edit:!1},initialize:function(t){if(L.version<"0.7")throw new Error("Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/");L.Control.prototype.initialize.call(this,t);var e;this._toolbars={},L.DrawToolbar&&this.options.draw&&(e=new L.DrawToolbar(this.options.draw),this._toolbars[L.DrawToolbar.TYPE]=e,this._toolbars[L.DrawToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.EditToolbar&&this.options.edit&&(e=new L.EditToolbar(this.options.edit),this._toolbars[L.EditToolbar.TYPE]=e,this._toolbars[L.EditToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.toolbar=this},onAdd:function(t){var e,n=L.DomUtil.create("div","leaflet-draw"),i=!1,o="leaflet-draw-toolbar-top";for(var r in this._toolbars)this._toolbars.hasOwnProperty(r)&&(e=this._toolbars[r].addToolbar(t),e&&(i||(L.DomUtil.hasClass(e,o)||L.DomUtil.addClass(e.childNodes[0],o),i=!0),n.appendChild(e)));return n},onRemove:function(){for(var t in this._toolbars)this._toolbars.hasOwnProperty(t)&&this._toolbars[t].removeToolbar()},setDrawingOptions:function(t){for(var e in this._toolbars)this._toolbars[e]instanceof L.DrawToolbar&&this._toolbars[e].setOptions(t)},_toolbarEnabled:function(t){var e=t.target;for(var n in this._toolbars)this._toolbars[n]!==e&&this._toolbars[n].disable()}}),L.Map.mergeOptions({drawControlTooltips:!0,drawControl:!1}),L.Map.addInitHook(function(){this.options.drawControl&&(this.drawControl=new L.Control.Draw,this.addControl(this.drawControl))}),L.Toolbar=L.Class.extend({includes:[L.Mixin.Events],initialize:function(t){L.setOptions(this,t),this._modes={},this._actionButtons=[],this._activeMode=null},enabled:function(){return null!==this._activeMode},disable:function(){this.enabled()&&this._activeMode.handler.disable()},addToolbar:function(t){var e,n=L.DomUtil.create("div","leaflet-draw-section"),i=0,o=this._toolbarClass||"",r=this.getModeHandlers(t);for(this._toolbarContainer=L.DomUtil.create("div","leaflet-draw-toolbar leaflet-bar"),this._map=t,e=0;e<r.length;e++)r[e].enabled&&this._initModeHandler(r[e].handler,this._toolbarContainer,i++,o,r[e].title);return i?(this._lastButtonIndex=--i,this._actionsContainer=L.DomUtil.create("ul","leaflet-draw-actions"),n.appendChild(this._toolbarContainer),n.appendChild(this._actionsContainer),n):void 0},removeToolbar:function(){for(var t in this._modes)this._modes.hasOwnProperty(t)&&(this._disposeButton(this._modes[t].button,this._modes[t].handler.enable,this._modes[t].handler),this._modes[t].handler.disable(),this._modes[t].handler.off("enabled",this._handlerActivated,this).off("disabled",this._handlerDeactivated,this));this._modes={};for(var e=0,n=this._actionButtons.length;n>e;e++)this._disposeButton(this._actionButtons[e].button,this._actionButtons[e].callback,this);this._actionButtons=[],this._actionsContainer=null},_initModeHandler:function(t,e,n,i,o){var r=t.type;this._modes[r]={},this._modes[r].handler=t,this._modes[r].button=this._createButton({type:r,title:o,className:i+"-"+r,container:e,callback:this._modes[r].handler.enable,context:this._modes[r].handler}),this._modes[r].buttonIndex=n,this._modes[r].handler.on("enabled",this._handlerActivated,this).on("disabled",this._handlerDeactivated,this)},_createButton:function(t){var e=L.DomUtil.create("a",t.className||"",t.container);return e.href="#",t.text&&(e.innerHTML=t.text),t.title&&(e.title=t.title),L.DomEvent.on(e,"click",L.DomEvent.stopPropagation).on(e,"mousedown",L.DomEvent.stopPropagation).on(e,"dblclick",L.DomEvent.stopPropagation).on(e,"click",L.DomEvent.preventDefault).on(e,"click",t.callback,t.context),e},_disposeButton:function(t,e){
L.DomEvent.off(t,"click",L.DomEvent.stopPropagation).off(t,"mousedown",L.DomEvent.stopPropagation).off(t,"dblclick",L.DomEvent.stopPropagation).off(t,"click",L.DomEvent.preventDefault).off(t,"click",e)},_handlerActivated:function(t){this.disable(),this._activeMode=this._modes[t.handler],L.DomUtil.addClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._showActionsToolbar(),this.fire("enable")},_handlerDeactivated:function(){this._hideActionsToolbar(),L.DomUtil.removeClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._activeMode=null,this.fire("disable")},_createActions:function(t){var e,n,i,o,r=this._actionsContainer,s=this.getActions(t),a=s.length;for(n=0,i=this._actionButtons.length;i>n;n++)this._disposeButton(this._actionButtons[n].button,this._actionButtons[n].callback);for(this._actionButtons=[];r.firstChild;)r.removeChild(r.firstChild);for(var h=0;a>h;h++)"enabled"in s[h]&&!s[h].enabled||(e=L.DomUtil.create("li","",r),o=this._createButton({title:s[h].title,text:s[h].text,container:e,callback:s[h].callback,context:s[h].context}),this._actionButtons.push({button:o,callback:s[h].callback}))},_showActionsToolbar:function(){var t=this._activeMode.buttonIndex,e=this._lastButtonIndex,n=this._activeMode.button.offsetTop-1;this._createActions(this._activeMode.handler),this._actionsContainer.style.top=n+"px",0===t&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-top")),t===e&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-bottom")),this._actionsContainer.style.display="block"},_hideActionsToolbar:function(){this._actionsContainer.style.display="none",L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-top"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-bottom")}}),L.Tooltip=L.Class.extend({initialize:function(t){this._map=t,this._popupPane=t._panes.popupPane,this._container=t.options.drawControlTooltips?L.DomUtil.create("div","leaflet-draw-tooltip",this._popupPane):null,this._singleLineLabel=!1,this._map.on("mouseout",this._onMouseOut,this)},dispose:function(){this._map.off("mouseout",this._onMouseOut,this),this._container&&(this._popupPane.removeChild(this._container),this._container=null)},updateContent:function(t){return this._container?(t.subtext=t.subtext||"",0!==t.subtext.length||this._singleLineLabel?t.subtext.length>0&&this._singleLineLabel&&(L.DomUtil.removeClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!1):(L.DomUtil.addClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!0),this._container.innerHTML=(t.subtext.length>0?'<span class="leaflet-draw-tooltip-subtext">'+t.subtext+"</span><br />":"")+"<span>"+t.text+"</span>",this):this},updatePosition:function(t){var e=this._map.latLngToLayerPoint(t),n=this._container;return this._container&&(n.style.visibility="inherit",L.DomUtil.setPosition(n,e)),this},showAsError:function(){return this._container&&L.DomUtil.addClass(this._container,"leaflet-error-draw-tooltip"),this},removeError:function(){return this._container&&L.DomUtil.removeClass(this._container,"leaflet-error-draw-tooltip"),this},_onMouseOut:function(){this._container&&(this._container.style.visibility="hidden")}}),L.DrawToolbar=L.Toolbar.extend({statics:{TYPE:"draw"},options:{polyline:{},polygon:{},rectangle:{},circle:{},marker:{}},initialize:function(t){for(var e in this.options)this.options.hasOwnProperty(e)&&t[e]&&(t[e]=L.extend({},this.options[e],t[e]));this._toolbarClass="leaflet-draw-draw",L.Toolbar.prototype.initialize.call(this,t)},getModeHandlers:function(t){return[{enabled:this.options.polyline,handler:new L.Draw.Polyline(t,this.options.polyline),title:L.drawLocal.draw.toolbar.buttons.polyline},{enabled:this.options.polygon,handler:new L.Draw.Polygon(t,this.options.polygon),title:L.drawLocal.draw.toolbar.buttons.polygon},{enabled:this.options.rectangle,handler:new L.Draw.Rectangle(t,this.options.rectangle),title:L.drawLocal.draw.toolbar.buttons.rectangle},{enabled:this.options.circle,handler:new L.Draw.Circle(t,this.options.circle),title:L.drawLocal.draw.toolbar.buttons.circle},{enabled:this.options.marker,handler:new L.Draw.Marker(t,this.options.marker),title:L.drawLocal.draw.toolbar.buttons.marker}]},getActions:function(t){return[{enabled:t.completeShape,title:L.drawLocal.draw.toolbar.finish.title,text:L.drawLocal.draw.toolbar.finish.text,callback:t.completeShape,context:t},{enabled:t.deleteLastVertex,title:L.drawLocal.draw.toolbar.undo.title,text:L.drawLocal.draw.toolbar.undo.text,callback:t.deleteLastVertex,context:t},{title:L.drawLocal.draw.toolbar.actions.title,text:L.drawLocal.draw.toolbar.actions.text,callback:this.disable,context:this}]},setOptions:function(t){L.setOptions(this,t);for(var e in this._modes)this._modes.hasOwnProperty(e)&&t.hasOwnProperty(e)&&this._modes[e].handler.setOptions(t[e])}}),L.EditToolbar=L.Toolbar.extend({statics:{TYPE:"edit"},options:{edit:{selectedPathOptions:{dashArray:"10, 10",fill:!0,fillColor:"#fe57a1",fillOpacity:.1,maintainColor:!1}},remove:{},poly:null,featureGroup:null},initialize:function(t){t.edit&&("undefined"==typeof t.edit.selectedPathOptions&&(t.edit.selectedPathOptions=this.options.edit.selectedPathOptions),t.edit.selectedPathOptions=L.extend({},this.options.edit.selectedPathOptions,t.edit.selectedPathOptions)),t.remove&&(t.remove=L.extend({},this.options.remove,t.remove)),t.poly&&(t.poly=L.extend({},this.options.poly,t.poly)),this._toolbarClass="leaflet-draw-edit",L.Toolbar.prototype.initialize.call(this,t),this._selectedFeatureCount=0},getModeHandlers:function(t){var e=this.options.featureGroup;return[{enabled:this.options.edit,handler:new L.EditToolbar.Edit(t,{featureGroup:e,selectedPathOptions:this.options.edit.selectedPathOptions,poly:this.options.poly}),title:L.drawLocal.edit.toolbar.buttons.edit},{enabled:this.options.remove,handler:new L.EditToolbar.Delete(t,{featureGroup:e}),title:L.drawLocal.edit.toolbar.buttons.remove}]},getActions:function(){return[{title:L.drawLocal.edit.toolbar.actions.save.title,text:L.drawLocal.edit.toolbar.actions.save.text,callback:this._save,context:this},{title:L.drawLocal.edit.toolbar.actions.cancel.title,text:L.drawLocal.edit.toolbar.actions.cancel.text,callback:this.disable,context:this}]},addToolbar:function(t){var e=L.Toolbar.prototype.addToolbar.call(this,t);return this._checkDisabled(),this.options.featureGroup.on("layeradd layerremove",this._checkDisabled,this),e},removeToolbar:function(){this.options.featureGroup.off("layeradd layerremove",this._checkDisabled,this),L.Toolbar.prototype.removeToolbar.call(this)},disable:function(){this.enabled()&&(this._activeMode.handler.revertLayers(),L.Toolbar.prototype.disable.call(this))},_save:function(){this._activeMode.handler.save(),this._activeMode&&this._activeMode.handler.disable()},_checkDisabled:function(){var t,e=this.options.featureGroup,n=0!==e.getLayers().length;this.options.edit&&(t=this._modes[L.EditToolbar.Edit.TYPE].button,n?L.DomUtil.removeClass(t,"leaflet-disabled"):L.DomUtil.addClass(t,"leaflet-disabled"),t.setAttribute("title",n?L.drawLocal.edit.toolbar.buttons.edit:L.drawLocal.edit.toolbar.buttons.editDisabled)),this.options.remove&&(t=this._modes[L.EditToolbar.Delete.TYPE].button,n?L.DomUtil.removeClass(t,"leaflet-disabled"):L.DomUtil.addClass(t,"leaflet-disabled"),t.setAttribute("title",n?L.drawLocal.edit.toolbar.buttons.remove:L.drawLocal.edit.toolbar.buttons.removeDisabled))}}),L.EditToolbar.Edit=L.Handler.extend({statics:{TYPE:"edit"},includes:L.Mixin.Events,initialize:function(t,e){if(L.Handler.prototype.initialize.call(this,t),L.setOptions(this,e),this._featureGroup=e.featureGroup,!(this._featureGroup instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this._uneditedLayerProps={},this.type=L.EditToolbar.Edit.TYPE},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire("draw:editstart",{handler:this.type}),L.Handler.prototype.enable.call(this),this._featureGroup.on("layeradd",this._enableLayerEdit,this).on("layerremove",this._disableLayerEdit,this))},disable:function(){this._enabled&&(this._featureGroup.off("layeradd",this._enableLayerEdit,this).off("layerremove",this._disableLayerEdit,this),L.Handler.prototype.disable.call(this),this._map.fire("draw:editstop",{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var t=this._map;t&&(t.getContainer().focus(),this._featureGroup.eachLayer(this._enableLayerEdit,this),this._tooltip=new L.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}),t._editTooltip=this._tooltip,this._updateTooltip(),this._map.on("mousemove",this._onMouseMove,this).on("touchmove",this._onMouseMove,this).on("MSPointerMove",this._onMouseMove,this).on("click",this._editStyle,this).on("draw:editvertex",this._updateTooltip,this))},removeHooks:function(){this._map&&(this._featureGroup.eachLayer(this._disableLayerEdit,this),this._uneditedLayerProps={},this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this).off("touchmove",this._onMouseMove,this).off("MSPointerMove",this._onMouseMove,this).off("click",this._editStyle,this).off("draw:editvertex",this._updateTooltip,this))},revertLayers:function(){this._featureGroup.eachLayer(function(t){this._revertLayer(t)},this)},save:function(){var t=new L.LayerGroup;this._featureGroup.eachLayer(function(e){e.edited&&(t.addLayer(e),e.edited=!1)}),this._map.fire("draw:edited",{layers:t})},_backupLayer:function(t){var e=L.Util.stamp(t);this._uneditedLayerProps[e]||(t instanceof L.Polyline||t instanceof L.Polygon||t instanceof L.Rectangle?this._uneditedLayerProps[e]={latlngs:L.LatLngUtil.cloneLatLngs(t.getLatLngs())}:t instanceof L.Circle?this._uneditedLayerProps[e]={latlng:L.LatLngUtil.cloneLatLng(t.getLatLng()),radius:t.getRadius()}:t instanceof L.Marker&&(this._uneditedLayerProps[e]={latlng:L.LatLngUtil.cloneLatLng(t.getLatLng())}))},_getTooltipText:function(){return{text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}},_updateTooltip:function(){this._tooltip.updateContent(this._getTooltipText())},_revertLayer:function(t){var e=L.Util.stamp(t);t.edited=!1,this._uneditedLayerProps.hasOwnProperty(e)&&(t instanceof L.Polyline||t instanceof L.Polygon||t instanceof L.Rectangle?t.setLatLngs(this._uneditedLayerProps[e].latlngs):t instanceof L.Circle?(t.setLatLng(this._uneditedLayerProps[e].latlng),t.setRadius(this._uneditedLayerProps[e].radius)):t instanceof L.Marker&&t.setLatLng(this._uneditedLayerProps[e].latlng),t.fire("revert-edited",{layer:t}))},_enableLayerEdit:function(t){var e,n,i=t.layer||t.target||t;this._backupLayer(i),this.options.poly&&(n=L.Util.extend({},this.options.poly),i.options.poly=n),this.options.selectedPathOptions&&(e=L.Util.extend({},this.options.selectedPathOptions),e.maintainColor&&(e.color=i.options.color,e.fillColor=i.options.fillColor),i.options.original=L.extend({},i.options),i.options.editing=e),this.isMarker?(i.dragging.enable(),i.on("dragend",this._onMarkerDragEnd).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onMarkerDragEnd,this).on("MSPointerUp",this._onMarkerDragEnd,this)):i.editing.enable()},_disableLayerEdit:function(t){var e=t.layer||t.target||t;e.edited=!1,e.editing.disable(),delete e.options.editing,delete e.options.original,this._selectedPathOptions&&(e instanceof L.Marker?this._toggleMarkerHighlight(e):(e.setStyle(e.options.previousOptions),delete e.options.previousOptions)),e instanceof L.Marker?(e.dragging.disable(),e.off("dragend",this._onMarkerDragEnd,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onMarkerDragEnd,this).off("MSPointerUp",this._onMarkerDragEnd,this)):e.editing.disable()},_onMouseMove:function(t){this._tooltip.updatePosition(t.latlng)},_onTouchMove:function(t){var e=t.originalEvent.changedTouches[0],n=this._map.mouseEventToLayerPoint(e),i=this._map.layerPointToLatLng(n);t.target.setLatLng(i)},_hasAvailableLayers:function(){return 0!==this._featureGroup.getLayers().length}}),L.EditToolbar.Delete=L.Handler.extend({statics:{TYPE:"remove"},includes:L.Mixin.Events,initialize:function(t,e){if(L.Handler.prototype.initialize.call(this,t),L.Util.setOptions(this,e),this._deletableLayers=this.options.featureGroup,!(this._deletableLayers instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this.type=L.EditToolbar.Delete.TYPE},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire("draw:deletestart",{handler:this.type}),L.Handler.prototype.enable.call(this),this._deletableLayers.on("layeradd",this._enableLayerDelete,this).on("layerremove",this._disableLayerDelete,this))},disable:function(){this._enabled&&(this._deletableLayers.off("layeradd",this._enableLayerDelete,this).off("layerremove",this._disableLayerDelete,this),L.Handler.prototype.disable.call(this),this._map.fire("draw:deletestop",{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var t=this._map;t&&(t.getContainer().focus(),this._deletableLayers.eachLayer(this._enableLayerDelete,this),this._deletedLayers=new L.LayerGroup,this._tooltip=new L.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.remove.tooltip.text}),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){this._map&&(this._deletableLayers.eachLayer(this._disableLayerDelete,this),this._deletedLayers=null,this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this))},revertLayers:function(){this._deletedLayers.eachLayer(function(t){this._deletableLayers.addLayer(t),t.fire("revert-deleted",{layer:t})},this)},save:function(){this._map.fire("draw:deleted",{layers:this._deletedLayers})},_enableLayerDelete:function(t){var e=t.layer||t.target||t;e.on("click",this._removeLayer,this)},_disableLayerDelete:function(t){var e=t.layer||t.target||t;e.off("click",this._removeLayer,this),this._deletedLayers.removeLayer(e)},_removeLayer:function(t){var e=t.layer||t.target||t;this._deletableLayers.removeLayer(e),this._deletedLayers.addLayer(e),e.fire("deleted")},_onMouseMove:function(t){this._tooltip.updatePosition(t.latlng)},_hasAvailableLayers:function(){return 0!==this._deletableLayers.getLayers().length}})}(window,document)},{}],28:[function(e,n,i){!function(e,i,o){var r=e.L,s={};s.version="0.7.7","object"==typeof n&&"object"==typeof n.exports?n.exports=s:"function"==typeof t&&t.amd&&t(s),s.noConflict=function(){return e.L=r,this},e.L=s,s.Util={extend:function(t){var e,n,i,o,r=Array.prototype.slice.call(arguments,1);for(n=0,i=r.length;i>n;n++){o=r[n]||{};for(e in o)o.hasOwnProperty(e)&&(t[e]=o[e])}return t},bind:function(t,e){var n=arguments.length>2?Array.prototype.slice.call(arguments,2):null;return function(){return t.apply(e,n||arguments)}},stamp:function(){var t=0,e="_leaflet_id";return function(n){return n[e]=n[e]||++t,n[e]}}(),invokeEach:function(t,e,n){var i,o;if("object"==typeof t){o=Array.prototype.slice.call(arguments,3);for(i in t)e.apply(n,[i,t[i]].concat(o));return!0}return!1},limitExecByInterval:function(t,e,n){var i,o;return function r(){var s=arguments;return i?void(o=!0):(i=!0,setTimeout(function(){i=!1,o&&(r.apply(n,s),o=!1)},e),void t.apply(n,s))}},falseFn:function(){return!1},formatNum:function(t,e){var n=Math.pow(10,e||5);return Math.round(t*n)/n},trim:function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},splitWords:function(t){return s.Util.trim(t).split(/\s+/)},setOptions:function(t,e){return t.options=s.extend({},t.options,e),t.options},getParamString:function(t,e,n){var i=[];for(var o in t)i.push(encodeURIComponent(n?o.toUpperCase():o)+"="+encodeURIComponent(t[o]));return(e&&-1!==e.indexOf("?")?"&":"?")+i.join("&")},template:function(t,e){return t.replace(/\{ *([\w_]+) *\}/g,function(t,n){var i=e[n];if(i===o)throw new Error("No value provided for variable "+t);return"function"==typeof i&&(i=i(e)),i})},isArray:Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},emptyImageUrl:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="},function(){function t(t){var n,i,o=["webkit","moz","o","ms"];for(n=0;n<o.length&&!i;n++)i=e[o[n]+t];return i}function n(t){var n=+new Date,o=Math.max(0,16-(n-i));return i=n+o,e.setTimeout(t,o)}var i=0,o=e.requestAnimationFrame||t("RequestAnimationFrame")||n,r=e.cancelAnimationFrame||t("CancelAnimationFrame")||t("CancelRequestAnimationFrame")||function(t){e.clearTimeout(t)};s.Util.requestAnimFrame=function(t,i,r,a){return t=s.bind(t,i),r&&o===n?void t():o.call(e,t,a)},s.Util.cancelAnimFrame=function(t){t&&r.call(e,t)}}(),s.extend=s.Util.extend,s.bind=s.Util.bind,s.stamp=s.Util.stamp,s.setOptions=s.Util.setOptions,s.Class=function(){},s.Class.extend=function(t){var e=function(){this.initialize&&this.initialize.apply(this,arguments),this._initHooks&&this.callInitHooks()},n=function(){};n.prototype=this.prototype;var i=new n;i.constructor=e,e.prototype=i;for(var o in this)this.hasOwnProperty(o)&&"prototype"!==o&&(e[o]=this[o]);t.statics&&(s.extend(e,t.statics),delete t.statics),t.includes&&(s.Util.extend.apply(null,[i].concat(t.includes)),delete t.includes),t.options&&i.options&&(t.options=s.extend({},i.options,t.options)),s.extend(i,t),i._initHooks=[];var r=this;return e.__super__=r.prototype,i.callInitHooks=function(){if(!this._initHooksCalled){r.prototype.callInitHooks&&r.prototype.callInitHooks.call(this),this._initHooksCalled=!0;for(var t=0,e=i._initHooks.length;e>t;t++)i._initHooks[t].call(this)}},e},s.Class.include=function(t){s.extend(this.prototype,t)},s.Class.mergeOptions=function(t){s.extend(this.prototype.options,t)},s.Class.addInitHook=function(t){var e=Array.prototype.slice.call(arguments,1),n="function"==typeof t?t:function(){this[t].apply(this,e)};this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(n)};var a="_leaflet_events";s.Mixin={},s.Mixin.Events={addEventListener:function(t,e,n){if(s.Util.invokeEach(t,this.addEventListener,this,e,n))return this;var i,o,r,h,l,c,u,d=this[a]=this[a]||{},p=n&&n!==this&&s.stamp(n);for(t=s.Util.splitWords(t),i=0,o=t.length;o>i;i++)r={action:e,context:n||this},h=t[i],p?(l=h+"_idx",c=l+"_len",u=d[l]=d[l]||{},u[p]||(u[p]=[],d[c]=(d[c]||0)+1),u[p].push(r)):(d[h]=d[h]||[],d[h].push(r));return this},hasEventListeners:function(t){var e=this[a];return!!e&&(t in e&&e[t].length>0||t+"_idx"in e&&e[t+"_idx_len"]>0)},removeEventListener:function(t,e,n){if(!this[a])return this;if(!t)return this.clearAllEventListeners();if(s.Util.invokeEach(t,this.removeEventListener,this,e,n))return this;var i,o,r,h,l,c,u,d,p,f=this[a],m=n&&n!==this&&s.stamp(n);for(t=s.Util.splitWords(t),i=0,o=t.length;o>i;i++)if(r=t[i],c=r+"_idx",u=c+"_len",d=f[c],e){if(h=m&&d?d[m]:f[r]){for(l=h.length-1;l>=0;l--)h[l].action!==e||n&&h[l].context!==n||(p=h.splice(l,1),p[0].action=s.Util.falseFn);n&&d&&0===h.length&&(delete d[m],f[u]--)}}else delete f[r],delete f[c],delete f[u];return this},clearAllEventListeners:function(){return delete this[a],this},fireEvent:function(t,e){if(!this.hasEventListeners(t))return this;var n,i,o,r,h,l=s.Util.extend({},e,{type:t,target:this}),c=this[a];if(c[t])for(n=c[t].slice(),i=0,o=n.length;o>i;i++)n[i].action.call(n[i].context,l);r=c[t+"_idx"];for(h in r)if(n=r[h].slice())for(i=0,o=n.length;o>i;i++)n[i].action.call(n[i].context,l);return this},addOneTimeEventListener:function(t,e,n){if(s.Util.invokeEach(t,this.addOneTimeEventListener,this,e,n))return this;var i=s.bind(function(){this.removeEventListener(t,e,n).removeEventListener(t,i,n)},this);return this.addEventListener(t,e,n).addEventListener(t,i,n)}},s.Mixin.Events.on=s.Mixin.Events.addEventListener,s.Mixin.Events.off=s.Mixin.Events.removeEventListener,s.Mixin.Events.once=s.Mixin.Events.addOneTimeEventListener,s.Mixin.Events.fire=s.Mixin.Events.fireEvent,function(){var t="ActiveXObject"in e,n=t&&!i.addEventListener,r=navigator.userAgent.toLowerCase(),a=-1!==r.indexOf("webkit"),h=-1!==r.indexOf("chrome"),l=-1!==r.indexOf("phantom"),c=-1!==r.indexOf("android"),u=-1!==r.search("android [23]"),d=-1!==r.indexOf("gecko"),p=typeof orientation!=o+"",f=!e.PointerEvent&&e.MSPointerEvent,m=e.PointerEvent&&e.navigator.pointerEnabled||f,_="devicePixelRatio"in e&&e.devicePixelRatio>1||"matchMedia"in e&&e.matchMedia("(min-resolution:144dpi)")&&e.matchMedia("(min-resolution:144dpi)").matches,g=i.documentElement,v=t&&"transition"in g.style,y="WebKitCSSMatrix"in e&&"m11"in new e.WebKitCSSMatrix&&!u,L="MozPerspective"in g.style,b="OTransition"in g.style,w=!e.L_DISABLE_3D&&(v||y||L||b)&&!l,E=!e.L_NO_TOUCH&&!l&&(m||"ontouchstart"in e||e.DocumentTouch&&i instanceof e.DocumentTouch);s.Browser={ie:t,ielt9:n,webkit:a,gecko:d&&!a&&!e.opera&&!t,android:c,android23:u,chrome:h,ie3d:v,webkit3d:y,gecko3d:L,opera3d:b,any3d:w,mobile:p,mobileWebkit:p&&a,mobileWebkit3d:p&&y,mobileOpera:p&&e.opera,touch:E,msPointer:f,pointer:m,retina:_}}(),s.Point=function(t,e,n){this.x=n?Math.round(t):t,this.y=n?Math.round(e):e},s.Point.prototype={clone:function(){return new s.Point(this.x,this.y)},add:function(t){return this.clone()._add(s.point(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(s.point(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},distanceTo:function(t){t=s.point(t);var e=t.x-this.x,n=t.y-this.y;return Math.sqrt(e*e+n*n)},equals:function(t){return t=s.point(t),t.x===this.x&&t.y===this.y},contains:function(t){return t=s.point(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+s.Util.formatNum(this.x)+", "+s.Util.formatNum(this.y)+")"}},s.point=function(t,e,n){return t instanceof s.Point?t:s.Util.isArray(t)?new s.Point(t[0],t[1]):t===o||null===t?t:new s.Point(t,e,n)},s.Bounds=function(t,e){if(t)for(var n=e?[t,e]:t,i=0,o=n.length;o>i;i++)this.extend(n[i])},s.Bounds.prototype={extend:function(t){return t=s.point(t),this.min||this.max?(this.min.x=Math.min(t.x,this.min.x),this.max.x=Math.max(t.x,this.max.x),this.min.y=Math.min(t.y,this.min.y),this.max.y=Math.max(t.y,this.max.y)):(this.min=t.clone(),this.max=t.clone()),this},getCenter:function(t){return new s.Point((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return new s.Point(this.min.x,this.max.y)},getTopRight:function(){return new s.Point(this.max.x,this.min.y)},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var e,n;return t="number"==typeof t[0]||t instanceof s.Point?s.point(t):s.bounds(t),t instanceof s.Bounds?(e=t.min,n=t.max):e=n=t,e.x>=this.min.x&&n.x<=this.max.x&&e.y>=this.min.y&&n.y<=this.max.y},intersects:function(t){t=s.bounds(t);var e=this.min,n=this.max,i=t.min,o=t.max,r=o.x>=e.x&&i.x<=n.x,a=o.y>=e.y&&i.y<=n.y;return r&&a},isValid:function(){return!(!this.min||!this.max)}},s.bounds=function(t,e){return!t||t instanceof s.Bounds?t:new s.Bounds(t,e)},s.Transformation=function(t,e,n,i){this._a=t,this._b=e,this._c=n,this._d=i},s.Transformation.prototype={transform:function(t,e){return this._transform(t.clone(),e)},_transform:function(t,e){return e=e||1,t.x=e*(this._a*t.x+this._b),t.y=e*(this._c*t.y+this._d),t},untransform:function(t,e){return e=e||1,new s.Point((t.x/e-this._b)/this._a,(t.y/e-this._d)/this._c)}},s.DomUtil={get:function(t){return"string"==typeof t?i.getElementById(t):t},getStyle:function(t,e){var n=t.style[e];if(!n&&t.currentStyle&&(n=t.currentStyle[e]),(!n||"auto"===n)&&i.defaultView){var o=i.defaultView.getComputedStyle(t,null);n=o?o[e]:null}return"auto"===n?null:n},getViewportOffset:function(t){var e,n=0,o=0,r=t,a=i.body,h=i.documentElement;do{if(n+=r.offsetTop||0,o+=r.offsetLeft||0,n+=parseInt(s.DomUtil.getStyle(r,"borderTopWidth"),10)||0,o+=parseInt(s.DomUtil.getStyle(r,"borderLeftWidth"),10)||0,e=s.DomUtil.getStyle(r,"position"),r.offsetParent===a&&"absolute"===e)break;if("fixed"===e){n+=a.scrollTop||h.scrollTop||0,o+=a.scrollLeft||h.scrollLeft||0;break}if("relative"===e&&!r.offsetLeft){var l=s.DomUtil.getStyle(r,"width"),c=s.DomUtil.getStyle(r,"max-width"),u=r.getBoundingClientRect();("none"!==l||"none"!==c)&&(o+=u.left+r.clientLeft),n+=u.top+(a.scrollTop||h.scrollTop||0);break}r=r.offsetParent}while(r);r=t;do{if(r===a)break;n-=r.scrollTop||0,o-=r.scrollLeft||0,r=r.parentNode}while(r);return new s.Point(o,n)},documentIsLtr:function(){return s.DomUtil._docIsLtrCached||(s.DomUtil._docIsLtrCached=!0,s.DomUtil._docIsLtr="ltr"===s.DomUtil.getStyle(i.body,"direction")),s.DomUtil._docIsLtr},create:function(t,e,n){var o=i.createElement(t);return o.className=e,n&&n.appendChild(o),o},hasClass:function(t,e){if(t.classList!==o)return t.classList.contains(e);var n=s.DomUtil._getClass(t);return n.length>0&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(n)},addClass:function(t,e){if(t.classList!==o)for(var n=s.Util.splitWords(e),i=0,r=n.length;r>i;i++)t.classList.add(n[i]);else if(!s.DomUtil.hasClass(t,e)){var a=s.DomUtil._getClass(t);s.DomUtil._setClass(t,(a?a+" ":"")+e)}},removeClass:function(t,e){t.classList!==o?t.classList.remove(e):s.DomUtil._setClass(t,s.Util.trim((" "+s.DomUtil._getClass(t)+" ").replace(" "+e+" "," ")))},_setClass:function(t,e){t.className.baseVal===o?t.className=e:t.className.baseVal=e},_getClass:function(t){return t.className.baseVal===o?t.className:t.className.baseVal},setOpacity:function(t,e){if("opacity"in t.style)t.style.opacity=e;else if("filter"in t.style){var n=!1,i="DXImageTransform.Microsoft.Alpha";try{n=t.filters.item(i)}catch(o){if(1===e)return}e=Math.round(100*e),n?(n.Enabled=100!==e,n.Opacity=e):t.style.filter+=" progid:"+i+"(opacity="+e+")"}},testProp:function(t){for(var e=i.documentElement.style,n=0;n<t.length;n++)if(t[n]in e)return t[n];return!1},getTranslateString:function(t){var e=s.Browser.webkit3d,n="translate"+(e?"3d":"")+"(",i=(e?",0":"")+")";return n+t.x+"px,"+t.y+"px"+i},getScaleString:function(t,e){var n=s.DomUtil.getTranslateString(e.add(e.multiplyBy(-1*t))),i=" scale("+t+") ";return n+i},setPosition:function(t,e,n){t._leaflet_pos=e,!n&&s.Browser.any3d?t.style[s.DomUtil.TRANSFORM]=s.DomUtil.getTranslateString(e):(t.style.left=e.x+"px",t.style.top=e.y+"px")},getPosition:function(t){return t._leaflet_pos}},s.DomUtil.TRANSFORM=s.DomUtil.testProp(["transform","WebkitTransform","OTransform","MozTransform","msTransform"]),s.DomUtil.TRANSITION=s.DomUtil.testProp(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),s.DomUtil.TRANSITION_END="webkitTransition"===s.DomUtil.TRANSITION||"OTransition"===s.DomUtil.TRANSITION?s.DomUtil.TRANSITION+"End":"transitionend",function(){if("onselectstart"in i)s.extend(s.DomUtil,{disableTextSelection:function(){s.DomEvent.on(e,"selectstart",s.DomEvent.preventDefault)},enableTextSelection:function(){s.DomEvent.off(e,"selectstart",s.DomEvent.preventDefault)}});else{var t=s.DomUtil.testProp(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);s.extend(s.DomUtil,{disableTextSelection:function(){if(t){var e=i.documentElement.style;this._userSelect=e[t],e[t]="none"}},enableTextSelection:function(){t&&(i.documentElement.style[t]=this._userSelect,delete this._userSelect)}})}s.extend(s.DomUtil,{disableImageDrag:function(){s.DomEvent.on(e,"dragstart",s.DomEvent.preventDefault)},enableImageDrag:function(){s.DomEvent.off(e,"dragstart",s.DomEvent.preventDefault)}})}(),s.LatLng=function(t,e,n){if(t=parseFloat(t),e=parseFloat(e),isNaN(t)||isNaN(e))throw new Error("Invalid LatLng object: ("+t+", "+e+")");this.lat=t,this.lng=e,n!==o&&(this.alt=parseFloat(n))},s.extend(s.LatLng,{DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,MAX_MARGIN:1e-9}),s.LatLng.prototype={equals:function(t){if(!t)return!1;t=s.latLng(t);var e=Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng));return e<=s.LatLng.MAX_MARGIN},toString:function(t){return"LatLng("+s.Util.formatNum(this.lat,t)+", "+s.Util.formatNum(this.lng,t)+")"},distanceTo:function(t){t=s.latLng(t);var e=6378137,n=s.LatLng.DEG_TO_RAD,i=(t.lat-this.lat)*n,o=(t.lng-this.lng)*n,r=this.lat*n,a=t.lat*n,h=Math.sin(i/2),l=Math.sin(o/2),c=h*h+l*l*Math.cos(r)*Math.cos(a);return 2*e*Math.atan2(Math.sqrt(c),Math.sqrt(1-c))},wrap:function(t,e){var n=this.lng;return t=t||-180,e=e||180,n=(n+e)%(e-t)+(t>n||n===e?e:t),new s.LatLng(this.lat,n)}},s.latLng=function(t,e){return t instanceof s.LatLng?t:s.Util.isArray(t)?"number"==typeof t[0]||"string"==typeof t[0]?new s.LatLng(t[0],t[1],t[2]):null:t===o||null===t?t:"object"==typeof t&&"lat"in t?new s.LatLng(t.lat,"lng"in t?t.lng:t.lon):e===o?null:new s.LatLng(t,e)},s.LatLngBounds=function(t,e){if(t)for(var n=e?[t,e]:t,i=0,o=n.length;o>i;i++)this.extend(n[i])},s.LatLngBounds.prototype={extend:function(t){if(!t)return this;var e=s.latLng(t);return t=null!==e?e:s.latLngBounds(t),t instanceof s.LatLng?this._southWest||this._northEast?(this._southWest.lat=Math.min(t.lat,this._southWest.lat),this._southWest.lng=Math.min(t.lng,this._southWest.lng),this._northEast.lat=Math.max(t.lat,this._northEast.lat),this._northEast.lng=Math.max(t.lng,this._northEast.lng)):(this._southWest=new s.LatLng(t.lat,t.lng),this._northEast=new s.LatLng(t.lat,t.lng)):t instanceof s.LatLngBounds&&(this.extend(t._southWest),this.extend(t._northEast)),this},pad:function(t){var e=this._southWest,n=this._northEast,i=Math.abs(e.lat-n.lat)*t,o=Math.abs(e.lng-n.lng)*t;return new s.LatLngBounds(new s.LatLng(e.lat-i,e.lng-o),new s.LatLng(n.lat+i,n.lng+o))},getCenter:function(){return new s.LatLng((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new s.LatLng(this.getNorth(),this.getWest())},getSouthEast:function(){return new s.LatLng(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){t="number"==typeof t[0]||t instanceof s.LatLng?s.latLng(t):s.latLngBounds(t);var e,n,i=this._southWest,o=this._northEast;return t instanceof s.LatLngBounds?(e=t.getSouthWest(),n=t.getNorthEast()):e=n=t,e.lat>=i.lat&&n.lat<=o.lat&&e.lng>=i.lng&&n.lng<=o.lng},intersects:function(t){t=s.latLngBounds(t);var e=this._southWest,n=this._northEast,i=t.getSouthWest(),o=t.getNorthEast(),r=o.lat>=e.lat&&i.lat<=n.lat,a=o.lng>=e.lng&&i.lng<=n.lng;return r&&a},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t){return t?(t=s.latLngBounds(t),this._southWest.equals(t.getSouthWest())&&this._northEast.equals(t.getNorthEast())):!1},isValid:function(){return!(!this._southWest||!this._northEast)}},s.latLngBounds=function(t,e){return!t||t instanceof s.LatLngBounds?t:new s.LatLngBounds(t,e)},s.Projection={},s.Projection.SphericalMercator={MAX_LATITUDE:85.0511287798,project:function(t){
var e=s.LatLng.DEG_TO_RAD,n=this.MAX_LATITUDE,i=Math.max(Math.min(n,t.lat),-n),o=t.lng*e,r=i*e;return r=Math.log(Math.tan(Math.PI/4+r/2)),new s.Point(o,r)},unproject:function(t){var e=s.LatLng.RAD_TO_DEG,n=t.x*e,i=(2*Math.atan(Math.exp(t.y))-Math.PI/2)*e;return new s.LatLng(i,n)}},s.Projection.LonLat={project:function(t){return new s.Point(t.lng,t.lat)},unproject:function(t){return new s.LatLng(t.y,t.x)}},s.CRS={latLngToPoint:function(t,e){var n=this.projection.project(t),i=this.scale(e);return this.transformation._transform(n,i)},pointToLatLng:function(t,e){var n=this.scale(e),i=this.transformation.untransform(t,n);return this.projection.unproject(i)},project:function(t){return this.projection.project(t)},scale:function(t){return 256*Math.pow(2,t)},getSize:function(t){var e=this.scale(t);return s.point(e,e)}},s.CRS.Simple=s.extend({},s.CRS,{projection:s.Projection.LonLat,transformation:new s.Transformation(1,0,-1,0),scale:function(t){return Math.pow(2,t)}}),s.CRS.EPSG3857=s.extend({},s.CRS,{code:"EPSG:3857",projection:s.Projection.SphericalMercator,transformation:new s.Transformation(.5/Math.PI,.5,-.5/Math.PI,.5),project:function(t){var e=this.projection.project(t),n=6378137;return e.multiplyBy(n)}}),s.CRS.EPSG900913=s.extend({},s.CRS.EPSG3857,{code:"EPSG:900913"}),s.CRS.EPSG4326=s.extend({},s.CRS,{code:"EPSG:4326",projection:s.Projection.LonLat,transformation:new s.Transformation(1/360,.5,-1/360,.5)}),s.Map=s.Class.extend({includes:s.Mixin.Events,options:{crs:s.CRS.EPSG3857,fadeAnimation:s.DomUtil.TRANSITION&&!s.Browser.android23,trackResize:!0,markerZoomAnimation:s.DomUtil.TRANSITION&&s.Browser.any3d},initialize:function(t,e){e=s.setOptions(this,e),this._initContainer(t),this._initLayout(),this._onResize=s.bind(this._onResize,this),this._initEvents(),e.maxBounds&&this.setMaxBounds(e.maxBounds),e.center&&e.zoom!==o&&this.setView(s.latLng(e.center),e.zoom,{reset:!0}),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._tileLayersNum=0,this.callInitHooks(),this._addLayers(e.layers)},setView:function(t,e){return e=e===o?this.getZoom():e,this._resetView(s.latLng(t),this._limitZoom(e)),this},setZoom:function(t,e){return this._loaded?this.setView(this.getCenter(),t,{zoom:e}):(this._zoom=this._limitZoom(t),this)},zoomIn:function(t,e){return this.setZoom(this._zoom+(t||1),e)},zoomOut:function(t,e){return this.setZoom(this._zoom-(t||1),e)},setZoomAround:function(t,e,n){var i=this.getZoomScale(e),o=this.getSize().divideBy(2),r=t instanceof s.Point?t:this.latLngToContainerPoint(t),a=r.subtract(o).multiplyBy(1-1/i),h=this.containerPointToLatLng(o.add(a));return this.setView(h,e,{zoom:n})},fitBounds:function(t,e){e=e||{},t=t.getBounds?t.getBounds():s.latLngBounds(t);var n=s.point(e.paddingTopLeft||e.padding||[0,0]),i=s.point(e.paddingBottomRight||e.padding||[0,0]),o=this.getBoundsZoom(t,!1,n.add(i));o=e.maxZoom?Math.min(e.maxZoom,o):o;var r=i.subtract(n).divideBy(2),a=this.project(t.getSouthWest(),o),h=this.project(t.getNorthEast(),o),l=this.unproject(a.add(h).divideBy(2).add(r),o);return this.setView(l,o,e)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,e){return this.setView(t,this._zoom,{pan:e})},panBy:function(t){return this.fire("movestart"),this._rawPanBy(s.point(t)),this.fire("move"),this.fire("moveend")},setMaxBounds:function(t){return t=s.latLngBounds(t),this.options.maxBounds=t,t?(this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds,this)):this.off("moveend",this._panInsideMaxBounds,this)},panInsideBounds:function(t,e){var n=this.getCenter(),i=this._limitCenter(n,this._zoom,t);return n.equals(i)?this:this.panTo(i,e)},addLayer:function(t){var e=s.stamp(t);return this._layers[e]?this:(this._layers[e]=t,!t.options||isNaN(t.options.maxZoom)&&isNaN(t.options.minZoom)||(this._zoomBoundLayers[e]=t,this._updateZoomLevels()),this.options.zoomAnimation&&s.TileLayer&&t instanceof s.TileLayer&&(this._tileLayersNum++,this._tileLayersToLoad++,t.on("load",this._onTileLayerLoad,this)),this._loaded&&this._layerAdd(t),this)},removeLayer:function(t){var e=s.stamp(t);return this._layers[e]?(this._loaded&&t.onRemove(this),delete this._layers[e],this._loaded&&this.fire("layerremove",{layer:t}),this._zoomBoundLayers[e]&&(delete this._zoomBoundLayers[e],this._updateZoomLevels()),this.options.zoomAnimation&&s.TileLayer&&t instanceof s.TileLayer&&(this._tileLayersNum--,this._tileLayersToLoad--,t.off("load",this._onTileLayerLoad,this)),this):this},hasLayer:function(t){return t?s.stamp(t)in this._layers:!1},eachLayer:function(t,e){for(var n in this._layers)t.call(e,this._layers[n]);return this},invalidateSize:function(t){if(!this._loaded)return this;t=s.extend({animate:!1,pan:!0},t===!0?{animate:!0}:t);var e=this.getSize();this._sizeChanged=!0,this._initialCenter=null;var n=this.getSize(),i=e.divideBy(2).round(),o=n.divideBy(2).round(),r=i.subtract(o);return r.x||r.y?(t.animate&&t.pan?this.panBy(r):(t.pan&&this._rawPanBy(r),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(s.bind(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:e,newSize:n})):this},addHandler:function(t,e){if(!e)return this;var n=this[t]=new e(this);return this._handlers.push(n),this.options[t]&&n.enable(),this},remove:function(){this._loaded&&this.fire("unload"),this._initEvents("off");try{delete this._container._leaflet}catch(t){this._container._leaflet=o}return this._clearPanes(),this._clearControlPos&&this._clearControlPos(),this._clearHandlers(),this},getCenter:function(){return this._checkIfLoaded(),this._initialCenter&&!this._moved()?this._initialCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds(),e=this.unproject(t.getBottomLeft()),n=this.unproject(t.getTopRight());return new s.LatLngBounds(e,n)},getMinZoom:function(){return this.options.minZoom===o?this._layersMinZoom===o?0:this._layersMinZoom:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===o?this._layersMaxZoom===o?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,e,n){t=s.latLngBounds(t);var i,o=this.getMinZoom()-(e?1:0),r=this.getMaxZoom(),a=this.getSize(),h=t.getNorthWest(),l=t.getSouthEast(),c=!0;n=s.point(n||[0,0]);do o++,i=this.project(l,o).subtract(this.project(h,o)).add(n),c=e?i.x<a.x||i.y<a.y:a.contains(i);while(c&&r>=o);return c&&e?null:e?o:o-1},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new s.Point(this._container.clientWidth,this._container.clientHeight),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(){var t=this._getTopLeftPoint();return new s.Bounds(t,t.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._initialTopLeftPoint},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t){var e=this.options.crs;return e.scale(t)/e.scale(this._zoom)},getScaleZoom:function(t){return this._zoom+Math.log(t)/Math.LN2},project:function(t,e){return e=e===o?this._zoom:e,this.options.crs.latLngToPoint(s.latLng(t),e)},unproject:function(t,e){return e=e===o?this._zoom:e,this.options.crs.pointToLatLng(s.point(t),e)},layerPointToLatLng:function(t){var e=s.point(t).add(this.getPixelOrigin());return this.unproject(e)},latLngToLayerPoint:function(t){var e=this.project(s.latLng(t))._round();return e._subtract(this.getPixelOrigin())},containerPointToLayerPoint:function(t){return s.point(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return s.point(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var e=this.containerPointToLayerPoint(s.point(t));return this.layerPointToLatLng(e)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(s.latLng(t)))},mouseEventToContainerPoint:function(t){return s.DomEvent.getMousePosition(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var e=this._container=s.DomUtil.get(t);if(!e)throw new Error("Map container not found.");if(e._leaflet)throw new Error("Map container is already initialized.");e._leaflet=!0},_initLayout:function(){var t=this._container;s.DomUtil.addClass(t,"leaflet-container"+(s.Browser.touch?" leaflet-touch":"")+(s.Browser.retina?" leaflet-retina":"")+(s.Browser.ielt9?" leaflet-oldie":"")+(this.options.fadeAnimation?" leaflet-fade-anim":""));var e=s.DomUtil.getStyle(t,"position");"absolute"!==e&&"relative"!==e&&"fixed"!==e&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._mapPane=t.mapPane=this._createPane("leaflet-map-pane",this._container),this._tilePane=t.tilePane=this._createPane("leaflet-tile-pane",this._mapPane),t.objectsPane=this._createPane("leaflet-objects-pane",this._mapPane),t.shadowPane=this._createPane("leaflet-shadow-pane"),t.overlayPane=this._createPane("leaflet-overlay-pane"),t.markerPane=this._createPane("leaflet-marker-pane"),t.popupPane=this._createPane("leaflet-popup-pane");var e=" leaflet-zoom-hide";this.options.markerZoomAnimation||(s.DomUtil.addClass(t.markerPane,e),s.DomUtil.addClass(t.shadowPane,e),s.DomUtil.addClass(t.popupPane,e))},_createPane:function(t,e){return s.DomUtil.create("div",t,e||this._panes.objectsPane)},_clearPanes:function(){this._container.removeChild(this._mapPane)},_addLayers:function(t){t=t?s.Util.isArray(t)?t:[t]:[];for(var e=0,n=t.length;n>e;e++)this.addLayer(t[e])},_resetView:function(t,e,n,i){var o=this._zoom!==e;i||(this.fire("movestart"),o&&this.fire("zoomstart")),this._zoom=e,this._initialCenter=t,this._initialTopLeftPoint=this._getNewTopLeftPoint(t),n?this._initialTopLeftPoint._add(this._getMapPanePos()):s.DomUtil.setPosition(this._mapPane,new s.Point(0,0)),this._tileLayersToLoad=this._tileLayersNum;var r=!this._loaded;this._loaded=!0,this.fire("viewreset",{hard:!n}),r&&(this.fire("load"),this.eachLayer(this._layerAdd,this)),this.fire("move"),(o||i)&&this.fire("zoomend"),this.fire("moveend",{hard:!n})},_rawPanBy:function(t){s.DomUtil.setPosition(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_updateZoomLevels:function(){var t,e=1/0,n=-(1/0),i=this._getZoomSpan();for(t in this._zoomBoundLayers){var r=this._zoomBoundLayers[t];isNaN(r.options.minZoom)||(e=Math.min(e,r.options.minZoom)),isNaN(r.options.maxZoom)||(n=Math.max(n,r.options.maxZoom))}t===o?this._layersMaxZoom=this._layersMinZoom=o:(this._layersMaxZoom=n,this._layersMinZoom=e),i!==this._getZoomSpan()&&this.fire("zoomlevelschange")},_panInsideMaxBounds:function(){this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(t){if(s.DomEvent){t=t||"on",s.DomEvent[t](this._container,"click",this._onMouseClick,this);var n,i,o=["dblclick","mousedown","mouseup","mouseenter","mouseleave","mousemove","contextmenu"];for(n=0,i=o.length;i>n;n++)s.DomEvent[t](this._container,o[n],this._fireMouseEvent,this);this.options.trackResize&&s.DomEvent[t](e,"resize",this._onResize,this)}},_onResize:function(){s.Util.cancelAnimFrame(this._resizeRequest),this._resizeRequest=s.Util.requestAnimFrame(function(){this.invalidateSize({debounceMoveend:!0})},this,!1,this._container)},_onMouseClick:function(t){!this._loaded||!t._simulated&&(this.dragging&&this.dragging.moved()||this.boxZoom&&this.boxZoom.moved())||s.DomEvent._skipped(t)||(this.fire("preclick"),this._fireMouseEvent(t))},_fireMouseEvent:function(t){if(this._loaded&&!s.DomEvent._skipped(t)){var e=t.type;if(e="mouseenter"===e?"mouseover":"mouseleave"===e?"mouseout":e,this.hasEventListeners(e)){"contextmenu"===e&&s.DomEvent.preventDefault(t);var n=this.mouseEventToContainerPoint(t),i=this.containerPointToLayerPoint(n),o=this.layerPointToLatLng(i);this.fire(e,{latlng:o,layerPoint:i,containerPoint:n,originalEvent:t})}}},_onTileLayerLoad:function(){this._tileLayersToLoad--,this._tileLayersNum&&!this._tileLayersToLoad&&this.fire("tilelayersload")},_clearHandlers:function(){for(var t=0,e=this._handlers.length;e>t;t++)this._handlers[t].disable()},whenReady:function(t,e){return this._loaded?t.call(e||this,this):this.on("load",t,e),this},_layerAdd:function(t){t.onAdd(this),this.fire("layeradd",{layer:t})},_getMapPanePos:function(){return s.DomUtil.getPosition(this._mapPane)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(){return this.getPixelOrigin().subtract(this._getMapPanePos())},_getNewTopLeftPoint:function(t,e){var n=this.getSize()._divideBy(2);return this.project(t,e)._subtract(n)._round()},_latLngToNewLayerPoint:function(t,e,n){var i=this._getNewTopLeftPoint(n,e).add(this._getMapPanePos());return this.project(t,e)._subtract(i)},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,e,n){if(!n)return t;var i=this.project(t,e),o=this.getSize().divideBy(2),r=new s.Bounds(i.subtract(o),i.add(o)),a=this._getBoundsOffset(r,n,e);return this.unproject(i.add(a),e)},_limitOffset:function(t,e){if(!e)return t;var n=this.getPixelBounds(),i=new s.Bounds(n.min.add(t),n.max.add(t));return t.add(this._getBoundsOffset(i,e))},_getBoundsOffset:function(t,e,n){var i=this.project(e.getNorthWest(),n).subtract(t.min),o=this.project(e.getSouthEast(),n).subtract(t.max),r=this._rebound(i.x,-o.x),a=this._rebound(i.y,-o.y);return new s.Point(r,a)},_rebound:function(t,e){return t+e>0?Math.round(t-e)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(e))},_limitZoom:function(t){var e=this.getMinZoom(),n=this.getMaxZoom();return Math.max(e,Math.min(n,t))}}),s.map=function(t,e){return new s.Map(t,e)},s.Projection.Mercator={MAX_LATITUDE:85.0840591556,R_MINOR:6356752.314245179,R_MAJOR:6378137,project:function(t){var e=s.LatLng.DEG_TO_RAD,n=this.MAX_LATITUDE,i=Math.max(Math.min(n,t.lat),-n),o=this.R_MAJOR,r=this.R_MINOR,a=t.lng*e*o,h=i*e,l=r/o,c=Math.sqrt(1-l*l),u=c*Math.sin(h);u=Math.pow((1-u)/(1+u),.5*c);var d=Math.tan(.5*(.5*Math.PI-h))/u;return h=-o*Math.log(d),new s.Point(a,h)},unproject:function(t){for(var e,n=s.LatLng.RAD_TO_DEG,i=this.R_MAJOR,o=this.R_MINOR,r=t.x*n/i,a=o/i,h=Math.sqrt(1-a*a),l=Math.exp(-t.y/i),c=Math.PI/2-2*Math.atan(l),u=15,d=1e-7,p=u,f=.1;Math.abs(f)>d&&--p>0;)e=h*Math.sin(c),f=Math.PI/2-2*Math.atan(l*Math.pow((1-e)/(1+e),.5*h))-c,c+=f;return new s.LatLng(c*n,r)}},s.CRS.EPSG3395=s.extend({},s.CRS,{code:"EPSG:3395",projection:s.Projection.Mercator,transformation:function(){var t=s.Projection.Mercator,e=t.R_MAJOR,n=.5/(Math.PI*e);return new s.Transformation(n,.5,-n,.5)}()}),s.TileLayer=s.Class.extend({includes:s.Mixin.Events,options:{minZoom:0,maxZoom:18,tileSize:256,subdomains:"abc",errorTileUrl:"",attribution:"",zoomOffset:0,opacity:1,unloadInvisibleTiles:s.Browser.mobile,updateWhenIdle:s.Browser.mobile},initialize:function(t,e){e=s.setOptions(this,e),e.detectRetina&&s.Browser.retina&&e.maxZoom>0&&(e.tileSize=Math.floor(e.tileSize/2),e.zoomOffset++,e.minZoom>0&&e.minZoom--,this.options.maxZoom--),e.bounds&&(e.bounds=s.latLngBounds(e.bounds)),this._url=t;var n=this.options.subdomains;"string"==typeof n&&(this.options.subdomains=n.split(""))},onAdd:function(t){this._map=t,this._animated=t._zoomAnimated,this._initContainer(),t.on({viewreset:this._reset,moveend:this._update},this),this._animated&&t.on({zoomanim:this._animateZoom,zoomend:this._endZoomAnim},this),this.options.updateWhenIdle||(this._limitedUpdate=s.Util.limitExecByInterval(this._update,150,this),t.on("move",this._limitedUpdate,this)),this._reset(),this._update()},addTo:function(t){return t.addLayer(this),this},onRemove:function(t){this._container.parentNode.removeChild(this._container),t.off({viewreset:this._reset,moveend:this._update},this),this._animated&&t.off({zoomanim:this._animateZoom,zoomend:this._endZoomAnim},this),this.options.updateWhenIdle||t.off("move",this._limitedUpdate,this),this._container=null,this._map=null},bringToFront:function(){var t=this._map._panes.tilePane;return this._container&&(t.appendChild(this._container),this._setAutoZIndex(t,Math.max)),this},bringToBack:function(){var t=this._map._panes.tilePane;return this._container&&(t.insertBefore(this._container,t.firstChild),this._setAutoZIndex(t,Math.min)),this},getAttribution:function(){return this.options.attribution},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},setUrl:function(t,e){return this._url=t,e||this.redraw(),this},redraw:function(){return this._map&&(this._reset({hard:!0}),this._update()),this},_updateZIndex:function(){this._container&&this.options.zIndex!==o&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t,e){var n,i,o,r=t.children,s=-e(1/0,-(1/0));for(i=0,o=r.length;o>i;i++)r[i]!==this._container&&(n=parseInt(r[i].style.zIndex,10),isNaN(n)||(s=e(s,n)));this.options.zIndex=this._container.style.zIndex=(isFinite(s)?s:0)+e(1,-1)},_updateOpacity:function(){var t,e=this._tiles;if(s.Browser.ielt9)for(t in e)s.DomUtil.setOpacity(e[t],this.options.opacity);else s.DomUtil.setOpacity(this._container,this.options.opacity)},_initContainer:function(){var t=this._map._panes.tilePane;if(!this._container){if(this._container=s.DomUtil.create("div","leaflet-layer"),this._updateZIndex(),this._animated){var e="leaflet-tile-container";this._bgBuffer=s.DomUtil.create("div",e,this._container),this._tileContainer=s.DomUtil.create("div",e,this._container)}else this._tileContainer=this._container;t.appendChild(this._container),this.options.opacity<1&&this._updateOpacity()}},_reset:function(t){for(var e in this._tiles)this.fire("tileunload",{tile:this._tiles[e]});this._tiles={},this._tilesToLoad=0,this.options.reuseTiles&&(this._unusedTiles=[]),this._tileContainer.innerHTML="",this._animated&&t&&t.hard&&this._clearBgBuffer(),this._initContainer()},_getTileSize:function(){var t=this._map,e=t.getZoom()+this.options.zoomOffset,n=this.options.maxNativeZoom,i=this.options.tileSize;return n&&e>n&&(i=Math.round(t.getZoomScale(e)/t.getZoomScale(n)*i)),i},_update:function(){if(this._map){var t=this._map,e=t.getPixelBounds(),n=t.getZoom(),i=this._getTileSize();if(!(n>this.options.maxZoom||n<this.options.minZoom)){var o=s.bounds(e.min.divideBy(i)._floor(),e.max.divideBy(i)._floor());this._addTilesFromCenterOut(o),(this.options.unloadInvisibleTiles||this.options.reuseTiles)&&this._removeOtherTiles(o)}}},_addTilesFromCenterOut:function(t){var e,n,o,r=[],a=t.getCenter();for(e=t.min.y;e<=t.max.y;e++)for(n=t.min.x;n<=t.max.x;n++)o=new s.Point(n,e),this._tileShouldBeLoaded(o)&&r.push(o);var h=r.length;if(0!==h){r.sort(function(t,e){return t.distanceTo(a)-e.distanceTo(a)});var l=i.createDocumentFragment();for(this._tilesToLoad||this.fire("loading"),this._tilesToLoad+=h,n=0;h>n;n++)this._addTile(r[n],l);this._tileContainer.appendChild(l)}},_tileShouldBeLoaded:function(t){if(t.x+":"+t.y in this._tiles)return!1;var e=this.options;if(!e.continuousWorld){var n=this._getWrapTileNum();if(e.noWrap&&(t.x<0||t.x>=n.x)||t.y<0||t.y>=n.y)return!1}if(e.bounds){var i=this._getTileSize(),o=t.multiplyBy(i),r=o.add([i,i]),s=this._map.unproject(o),a=this._map.unproject(r);if(e.continuousWorld||e.noWrap||(s=s.wrap(),a=a.wrap()),!e.bounds.intersects([s,a]))return!1}return!0},_removeOtherTiles:function(t){var e,n,i,o;for(o in this._tiles)e=o.split(":"),n=parseInt(e[0],10),i=parseInt(e[1],10),(n<t.min.x||n>t.max.x||i<t.min.y||i>t.max.y)&&this._removeTile(o)},_removeTile:function(t){var e=this._tiles[t];this.fire("tileunload",{tile:e,url:e.src}),this.options.reuseTiles?(s.DomUtil.removeClass(e,"leaflet-tile-loaded"),this._unusedTiles.push(e)):e.parentNode===this._tileContainer&&this._tileContainer.removeChild(e),s.Browser.android||(e.onload=null,e.src=s.Util.emptyImageUrl),delete this._tiles[t]},_addTile:function(t,e){var n=this._getTilePos(t),i=this._getTile();s.DomUtil.setPosition(i,n,s.Browser.chrome),this._tiles[t.x+":"+t.y]=i,this._loadTile(i,t),i.parentNode!==this._tileContainer&&e.appendChild(i)},_getZoomForUrl:function(){var t=this.options,e=this._map.getZoom();return t.zoomReverse&&(e=t.maxZoom-e),e+=t.zoomOffset,t.maxNativeZoom?Math.min(e,t.maxNativeZoom):e},_getTilePos:function(t){var e=this._map.getPixelOrigin(),n=this._getTileSize();return t.multiplyBy(n).subtract(e)},getTileUrl:function(t){return s.Util.template(this._url,s.extend({s:this._getSubdomain(t),z:t.z,x:t.x,y:t.y},this.options))},_getWrapTileNum:function(){var t=this._map.options.crs,e=t.getSize(this._map.getZoom());return e.divideBy(this._getTileSize())._floor()},_adjustTilePoint:function(t){var e=this._getWrapTileNum();this.options.continuousWorld||this.options.noWrap||(t.x=(t.x%e.x+e.x)%e.x),this.options.tms&&(t.y=e.y-t.y-1),t.z=this._getZoomForUrl()},_getSubdomain:function(t){var e=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[e]},_getTile:function(){if(this.options.reuseTiles&&this._unusedTiles.length>0){var t=this._unusedTiles.pop();return this._resetTile(t),t}return this._createTile()},_resetTile:function(){},_createTile:function(){var t=s.DomUtil.create("img","leaflet-tile");return t.style.width=t.style.height=this._getTileSize()+"px",t.galleryimg="no",t.onselectstart=t.onmousemove=s.Util.falseFn,s.Browser.ielt9&&this.options.opacity!==o&&s.DomUtil.setOpacity(t,this.options.opacity),s.Browser.mobileWebkit3d&&(t.style.WebkitBackfaceVisibility="hidden"),t},_loadTile:function(t,e){t._layer=this,t.onload=this._tileOnLoad,t.onerror=this._tileOnError,this._adjustTilePoint(e),t.src=this.getTileUrl(e),this.fire("tileloadstart",{tile:t,url:t.src})},_tileLoaded:function(){this._tilesToLoad--,this._animated&&s.DomUtil.addClass(this._tileContainer,"leaflet-zoom-animated"),this._tilesToLoad||(this.fire("load"),this._animated&&(clearTimeout(this._clearBgBufferTimer),this._clearBgBufferTimer=setTimeout(s.bind(this._clearBgBuffer,this),500)))},_tileOnLoad:function(){var t=this._layer;this.src!==s.Util.emptyImageUrl&&(s.DomUtil.addClass(this,"leaflet-tile-loaded"),t.fire("tileload",{tile:this,url:this.src})),t._tileLoaded()},_tileOnError:function(){var t=this._layer;t.fire("tileerror",{tile:this,url:this.src});var e=t.options.errorTileUrl;e&&(this.src=e),t._tileLoaded()}}),s.tileLayer=function(t,e){return new s.TileLayer(t,e)},s.TileLayer.WMS=s.TileLayer.extend({defaultWmsParams:{service:"WMS",request:"GetMap",version:"1.1.1",layers:"",styles:"",format:"image/jpeg",transparent:!1},initialize:function(t,e){this._url=t;var n=s.extend({},this.defaultWmsParams),i=e.tileSize||this.options.tileSize;e.detectRetina&&s.Browser.retina?n.width=n.height=2*i:n.width=n.height=i;for(var o in e)this.options.hasOwnProperty(o)||"crs"===o||(n[o]=e[o]);this.wmsParams=n,s.setOptions(this,e)},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var e=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[e]=this._crs.code,s.TileLayer.prototype.onAdd.call(this,t)},getTileUrl:function(t){var e=this._map,n=this.options.tileSize,i=t.multiplyBy(n),o=i.add([n,n]),r=this._crs.project(e.unproject(i,t.z)),a=this._crs.project(e.unproject(o,t.z)),h=this._wmsVersion>=1.3&&this._crs===s.CRS.EPSG4326?[a.y,r.x,r.y,a.x].join(","):[r.x,a.y,a.x,r.y].join(","),l=s.Util.template(this._url,{s:this._getSubdomain(t)});return l+s.Util.getParamString(this.wmsParams,l,!0)+"&BBOX="+h},setParams:function(t,e){return s.extend(this.wmsParams,t),e||this.redraw(),this}}),s.tileLayer.wms=function(t,e){return new s.TileLayer.WMS(t,e)},s.TileLayer.Canvas=s.TileLayer.extend({options:{async:!1},initialize:function(t){s.setOptions(this,t)},redraw:function(){this._map&&(this._reset({hard:!0}),this._update());for(var t in this._tiles)this._redrawTile(this._tiles[t]);return this},_redrawTile:function(t){this.drawTile(t,t._tilePoint,this._map._zoom)},_createTile:function(){var t=s.DomUtil.create("canvas","leaflet-tile");return t.width=t.height=this.options.tileSize,t.onselectstart=t.onmousemove=s.Util.falseFn,t},_loadTile:function(t,e){t._layer=this,t._tilePoint=e,this._redrawTile(t),this.options.async||this.tileDrawn(t)},drawTile:function(){},tileDrawn:function(t){this._tileOnLoad.call(t)}}),s.tileLayer.canvas=function(t){return new s.TileLayer.Canvas(t)},s.ImageOverlay=s.Class.extend({includes:s.Mixin.Events,options:{opacity:1},initialize:function(t,e,n){this._url=t,this._bounds=s.latLngBounds(e),s.setOptions(this,n)},onAdd:function(t){this._map=t,this._image||this._initImage(),t._panes.overlayPane.appendChild(this._image),t.on("viewreset",this._reset,this),t.options.zoomAnimation&&s.Browser.any3d&&t.on("zoomanim",this._animateZoom,this),this._reset()},onRemove:function(t){t.getPanes().overlayPane.removeChild(this._image),t.off("viewreset",this._reset,this),t.options.zoomAnimation&&t.off("zoomanim",this._animateZoom,this)},addTo:function(t){return t.addLayer(this),this},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},bringToFront:function(){return this._image&&this._map._panes.overlayPane.appendChild(this._image),this},bringToBack:function(){var t=this._map._panes.overlayPane;return this._image&&t.insertBefore(this._image,t.firstChild),this},setUrl:function(t){this._url=t,this._image.src=this._url},getAttribution:function(){return this.options.attribution},_initImage:function(){this._image=s.DomUtil.create("img","leaflet-image-layer"),this._map.options.zoomAnimation&&s.Browser.any3d?s.DomUtil.addClass(this._image,"leaflet-zoom-animated"):s.DomUtil.addClass(this._image,"leaflet-zoom-hide"),this._updateOpacity(),s.extend(this._image,{galleryimg:"no",onselectstart:s.Util.falseFn,onmousemove:s.Util.falseFn,onload:s.bind(this._onImageLoad,this),src:this._url})},_animateZoom:function(t){var e=this._map,n=this._image,i=e.getZoomScale(t.zoom),o=this._bounds.getNorthWest(),r=this._bounds.getSouthEast(),a=e._latLngToNewLayerPoint(o,t.zoom,t.center),h=e._latLngToNewLayerPoint(r,t.zoom,t.center)._subtract(a),l=a._add(h._multiplyBy(.5*(1-1/i)));n.style[s.DomUtil.TRANSFORM]=s.DomUtil.getTranslateString(l)+" scale("+i+") "},_reset:function(){var t=this._image,e=this._map.latLngToLayerPoint(this._bounds.getNorthWest()),n=this._map.latLngToLayerPoint(this._bounds.getSouthEast())._subtract(e);s.DomUtil.setPosition(t,e),t.style.width=n.x+"px",t.style.height=n.y+"px"},_onImageLoad:function(){this.fire("load")},_updateOpacity:function(){s.DomUtil.setOpacity(this._image,this.options.opacity)}}),s.imageOverlay=function(t,e,n){return new s.ImageOverlay(t,e,n)},s.Icon=s.Class.extend({options:{className:""},initialize:function(t){s.setOptions(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,e){var n=this._getIconUrl(t);if(!n){if("icon"===t)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var i;return i=e&&"IMG"===e.tagName?this._createImg(n,e):this._createImg(n),this._setIconStyles(i,t),i},_setIconStyles:function(t,e){var n,i=this.options,o=s.point(i[e+"Size"]);n="shadow"===e?s.point(i.shadowAnchor||i.iconAnchor):s.point(i.iconAnchor),!n&&o&&(n=o.divideBy(2,!0)),t.className="leaflet-marker-"+e+" "+i.className,n&&(t.style.marginLeft=-n.x+"px",t.style.marginTop=-n.y+"px"),o&&(t.style.width=o.x+"px",t.style.height=o.y+"px")},_createImg:function(t,e){return e=e||i.createElement("img"),e.src=t,e},_getIconUrl:function(t){return s.Browser.retina&&this.options[t+"RetinaUrl"]?this.options[t+"RetinaUrl"]:this.options[t+"Url"]}}),s.icon=function(t){return new s.Icon(t)},s.Icon.Default=s.Icon.extend({options:{iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]},_getIconUrl:function(t){var e=t+"Url";if(this.options[e])return this.options[e];s.Browser.retina&&"icon"===t&&(t+="-2x");var n=s.Icon.Default.imagePath;if(!n)throw new Error("Couldn't autodetect L.Icon.Default.imagePath, set it manually.");return n+"/marker-"+t+".png"}}),s.Icon.Default.imagePath=function(){var t,e,n,o,r,s=i.getElementsByTagName("script"),a=/[\/^]leaflet[\-\._]?([\w\-\._]*)\.js\??/;for(t=0,e=s.length;e>t;t++)if(n=s[t].src,o=n.match(a))return r=n.split(a)[0],(r?r+"/":"")+"images"}(),s.Marker=s.Class.extend({includes:s.Mixin.Events,options:{icon:new s.Icon.Default,title:"",alt:"",clickable:!0,draggable:!1,keyboard:!0,zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250},initialize:function(t,e){s.setOptions(this,e),this._latlng=s.latLng(t)},onAdd:function(t){this._map=t,t.on("viewreset",this.update,this),this._initIcon(),this.update(),this.fire("add"),t.options.zoomAnimation&&t.options.markerZoomAnimation&&t.on("zoomanim",this._animateZoom,this)},addTo:function(t){return t.addLayer(this),this},onRemove:function(t){this.dragging&&this.dragging.disable(),this._removeIcon(),this._removeShadow(),this.fire("remove"),t.off({viewreset:this.update,zoomanim:this._animateZoom},this),this._map=null},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=s.latLng(t),this.update(),this.fire("move",{latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update(),this},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup),this},update:function(){return this._icon&&this._setPos(this._map.latLngToLayerPoint(this._latlng).round()),this},_initIcon:function(){var t=this.options,e=this._map,n=e.options.zoomAnimation&&e.options.markerZoomAnimation,i=n?"leaflet-zoom-animated":"leaflet-zoom-hide",o=t.icon.createIcon(this._icon),r=!1;o!==this._icon&&(this._icon&&this._removeIcon(),r=!0,t.title&&(o.title=t.title),t.alt&&(o.alt=t.alt)),s.DomUtil.addClass(o,i),t.keyboard&&(o.tabIndex="0"),this._icon=o,this._initInteraction(),t.riseOnHover&&s.DomEvent.on(o,"mouseover",this._bringToFront,this).on(o,"mouseout",this._resetZIndex,this);var a=t.icon.createShadow(this._shadow),h=!1;a!==this._shadow&&(this._removeShadow(),h=!0),a&&s.DomUtil.addClass(a,i),this._shadow=a,t.opacity<1&&this._updateOpacity();var l=this._map._panes;r&&l.markerPane.appendChild(this._icon),a&&h&&l.shadowPane.appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&s.DomEvent.off(this._icon,"mouseover",this._bringToFront).off(this._icon,"mouseout",this._resetZIndex),this._map._panes.markerPane.removeChild(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&this._map._panes.shadowPane.removeChild(this._shadow),this._shadow=null},_setPos:function(t){s.DomUtil.setPosition(this._icon,t),this._shadow&&s.DomUtil.setPosition(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon.style.zIndex=this._zIndex+t},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(e)},_initInteraction:function(){if(this.options.clickable){var t=this._icon,e=["dblclick","mousedown","mouseover","mouseout","contextmenu"];s.DomUtil.addClass(t,"leaflet-clickable"),s.DomEvent.on(t,"click",this._onMouseClick,this),s.DomEvent.on(t,"keypress",this._onKeyPress,this);for(var n=0;n<e.length;n++)s.DomEvent.on(t,e[n],this._fireMouseEvent,this);s.Handler.MarkerDrag&&(this.dragging=new s.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_onMouseClick:function(t){var e=this.dragging&&this.dragging.moved();(this.hasEventListeners(t.type)||e)&&s.DomEvent.stopPropagation(t),e||(this.dragging&&this.dragging._enabled||!this._map.dragging||!this._map.dragging.moved())&&this.fire(t.type,{
originalEvent:t,latlng:this._latlng})},_onKeyPress:function(t){13===t.keyCode&&this.fire("click",{originalEvent:t,latlng:this._latlng})},_fireMouseEvent:function(t){this.fire(t.type,{originalEvent:t,latlng:this._latlng}),"contextmenu"===t.type&&this.hasEventListeners(t.type)&&s.DomEvent.preventDefault(t),"mousedown"!==t.type?s.DomEvent.stopPropagation(t):s.DomEvent.preventDefault(t)},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){s.DomUtil.setOpacity(this._icon,this.options.opacity),this._shadow&&s.DomUtil.setOpacity(this._shadow,this.options.opacity)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)}}),s.marker=function(t,e){return new s.Marker(t,e)},s.DivIcon=s.Icon.extend({options:{iconSize:[12,12],className:"leaflet-div-icon",html:!1},createIcon:function(t){var e=t&&"DIV"===t.tagName?t:i.createElement("div"),n=this.options;return n.html!==!1?e.innerHTML=n.html:e.innerHTML="",n.bgPos&&(e.style.backgroundPosition=-n.bgPos.x+"px "+-n.bgPos.y+"px"),this._setIconStyles(e,"icon"),e},createShadow:function(){return null}}),s.divIcon=function(t){return new s.DivIcon(t)},s.Map.mergeOptions({closePopupOnClick:!0}),s.Popup=s.Class.extend({includes:s.Mixin.Events,options:{minWidth:50,maxWidth:300,autoPan:!0,closeButton:!0,offset:[0,7],autoPanPadding:[5,5],keepInView:!1,className:"",zoomAnimation:!0},initialize:function(t,e){s.setOptions(this,t),this._source=e,this._animated=s.Browser.any3d&&this.options.zoomAnimation,this._isOpen=!1},onAdd:function(t){this._map=t,this._container||this._initLayout();var e=t.options.fadeAnimation;e&&s.DomUtil.setOpacity(this._container,0),t._panes.popupPane.appendChild(this._container),t.on(this._getEvents(),this),this.update(),e&&s.DomUtil.setOpacity(this._container,1),this.fire("open"),t.fire("popupopen",{popup:this}),this._source&&this._source.fire("popupopen",{popup:this})},addTo:function(t){return t.addLayer(this),this},openOn:function(t){return t.openPopup(this),this},onRemove:function(t){t._panes.popupPane.removeChild(this._container),s.Util.falseFn(this._container.offsetWidth),t.off(this._getEvents(),this),t.options.fadeAnimation&&s.DomUtil.setOpacity(this._container,0),this._map=null,this.fire("close"),t.fire("popupclose",{popup:this}),this._source&&this._source.fire("popupclose",{popup:this})},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=s.latLng(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},_getEvents:function(){var t={viewreset:this._updatePosition};return this._animated&&(t.zoomanim=this._zoomAnimation),("closeOnClick"in this.options?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this._close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var t,e="leaflet-popup",n=e+" "+this.options.className+" leaflet-zoom-"+(this._animated?"animated":"hide"),i=this._container=s.DomUtil.create("div",n);this.options.closeButton&&(t=this._closeButton=s.DomUtil.create("a",e+"-close-button",i),t.href="#close",t.innerHTML="&#215;",s.DomEvent.disableClickPropagation(t),s.DomEvent.on(t,"click",this._onCloseButtonClick,this));var o=this._wrapper=s.DomUtil.create("div",e+"-content-wrapper",i);s.DomEvent.disableClickPropagation(o),this._contentNode=s.DomUtil.create("div",e+"-content",o),s.DomEvent.disableScrollPropagation(this._contentNode),s.DomEvent.on(o,"contextmenu",s.DomEvent.stopPropagation),this._tipContainer=s.DomUtil.create("div",e+"-tip-container",i),this._tip=s.DomUtil.create("div",e+"-tip",this._tipContainer)},_updateContent:function(){if(this._content){if("string"==typeof this._content)this._contentNode.innerHTML=this._content;else{for(;this._contentNode.hasChildNodes();)this._contentNode.removeChild(this._contentNode.firstChild);this._contentNode.appendChild(this._content)}this.fire("contentupdate")}},_updateLayout:function(){var t=this._contentNode,e=t.style;e.width="",e.whiteSpace="nowrap";var n=t.offsetWidth;n=Math.min(n,this.options.maxWidth),n=Math.max(n,this.options.minWidth),e.width=n+1+"px",e.whiteSpace="",e.height="";var i=t.offsetHeight,o=this.options.maxHeight,r="leaflet-popup-scrolled";o&&i>o?(e.height=o+"px",s.DomUtil.addClass(t,r)):s.DomUtil.removeClass(t,r),this._containerWidth=this._container.offsetWidth},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),e=this._animated,n=s.point(this.options.offset);e&&s.DomUtil.setPosition(this._container,t),this._containerBottom=-n.y-(e?0:t.y),this._containerLeft=-Math.round(this._containerWidth/2)+n.x+(e?0:t.x),this._container.style.bottom=this._containerBottom+"px",this._container.style.left=this._containerLeft+"px"}},_zoomAnimation:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);s.DomUtil.setPosition(this._container,e)},_adjustPan:function(){if(this.options.autoPan){var t=this._map,e=this._container.offsetHeight,n=this._containerWidth,i=new s.Point(this._containerLeft,-e-this._containerBottom);this._animated&&i._add(s.DomUtil.getPosition(this._container));var o=t.layerPointToContainerPoint(i),r=s.point(this.options.autoPanPadding),a=s.point(this.options.autoPanPaddingTopLeft||r),h=s.point(this.options.autoPanPaddingBottomRight||r),l=t.getSize(),c=0,u=0;o.x+n+h.x>l.x&&(c=o.x+n-l.x+h.x),o.x-c-a.x<0&&(c=o.x-a.x),o.y+e+h.y>l.y&&(u=o.y+e-l.y+h.y),o.y-u-a.y<0&&(u=o.y-a.y),(c||u)&&t.fire("autopanstart").panBy([c,u])}},_onCloseButtonClick:function(t){this._close(),s.DomEvent.stop(t)}}),s.popup=function(t,e){return new s.Popup(t,e)},s.Map.include({openPopup:function(t,e,n){if(this.closePopup(),!(t instanceof s.Popup)){var i=t;t=new s.Popup(n).setLatLng(e).setContent(i)}return t._isOpen=!0,this._popup=t,this.addLayer(t)},closePopup:function(t){return t&&t!==this._popup||(t=this._popup,this._popup=null),t&&(this.removeLayer(t),t._isOpen=!1),this}}),s.Marker.include({openPopup:function(){return this._popup&&this._map&&!this._map.hasLayer(this._popup)&&(this._popup.setLatLng(this._latlng),this._map.openPopup(this._popup)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(){return this._popup&&(this._popup._isOpen?this.closePopup():this.openPopup()),this},bindPopup:function(t,e){var n=s.point(this.options.icon.options.popupAnchor||[0,0]);return n=n.add(s.Popup.prototype.options.offset),e&&e.offset&&(n=n.add(e.offset)),e=s.extend({offset:n},e),this._popupHandlersAdded||(this.on("click",this.togglePopup,this).on("remove",this.closePopup,this).on("move",this._movePopup,this),this._popupHandlersAdded=!0),t instanceof s.Popup?(s.setOptions(t,e),this._popup=t,t._source=this):this._popup=new s.Popup(e,this).setContent(t),this},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},unbindPopup:function(){return this._popup&&(this._popup=null,this.off("click",this.togglePopup,this).off("remove",this.closePopup,this).off("move",this._movePopup,this),this._popupHandlersAdded=!1),this},getPopup:function(){return this._popup},_movePopup:function(t){this._popup.setLatLng(t.latlng)}}),s.LayerGroup=s.Class.extend({initialize:function(t){this._layers={};var e,n;if(t)for(e=0,n=t.length;n>e;e++)this.addLayer(t[e])},addLayer:function(t){var e=this.getLayerId(t);return this._layers[e]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var e=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[e]&&this._map.removeLayer(this._layers[e]),delete this._layers[e],this},hasLayer:function(t){return t?t in this._layers||this.getLayerId(t)in this._layers:!1},clearLayers:function(){return this.eachLayer(this.removeLayer,this),this},invoke:function(t){var e,n,i=Array.prototype.slice.call(arguments,1);for(e in this._layers)n=this._layers[e],n[t]&&n[t].apply(n,i);return this},onAdd:function(t){this._map=t,this.eachLayer(t.addLayer,t)},onRemove:function(t){this.eachLayer(t.removeLayer,t),this._map=null},addTo:function(t){return t.addLayer(this),this},eachLayer:function(t,e){for(var n in this._layers)t.call(e,this._layers[n]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];for(var e in this._layers)t.push(this._layers[e]);return t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return s.stamp(t)}}),s.layerGroup=function(t){return new s.LayerGroup(t)},s.FeatureGroup=s.LayerGroup.extend({includes:s.Mixin.Events,statics:{EVENTS:"click dblclick mouseover mouseout mousemove contextmenu popupopen popupclose"},addLayer:function(t){return this.hasLayer(t)?this:("on"in t&&t.on(s.FeatureGroup.EVENTS,this._propagateEvent,this),s.LayerGroup.prototype.addLayer.call(this,t),this._popupContent&&t.bindPopup&&t.bindPopup(this._popupContent,this._popupOptions),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),"off"in t&&t.off(s.FeatureGroup.EVENTS,this._propagateEvent,this),s.LayerGroup.prototype.removeLayer.call(this,t),this._popupContent&&this.invoke("unbindPopup"),this.fire("layerremove",{layer:t})):this},bindPopup:function(t,e){return this._popupContent=t,this._popupOptions=e,this.invoke("bindPopup",t,e)},openPopup:function(t){for(var e in this._layers){this._layers[e].openPopup(t);break}return this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new s.LatLngBounds;return this.eachLayer(function(e){t.extend(e instanceof s.Marker?e.getLatLng():e.getBounds())}),t},_propagateEvent:function(t){t=s.extend({layer:t.target,target:this},t),this.fire(t.type,t)}}),s.featureGroup=function(t){return new s.FeatureGroup(t)},s.Path=s.Class.extend({includes:[s.Mixin.Events],statics:{CLIP_PADDING:function(){var t=s.Browser.mobile?1280:2e3,n=(t/Math.max(e.outerWidth,e.outerHeight)-1)/2;return Math.max(0,Math.min(.5,n))}()},options:{stroke:!0,color:"#0033ff",dashArray:null,lineCap:null,lineJoin:null,weight:5,opacity:.5,fill:!1,fillColor:null,fillOpacity:.2,clickable:!0},initialize:function(t){s.setOptions(this,t)},onAdd:function(t){this._map=t,this._container||(this._initElements(),this._initEvents()),this.projectLatlngs(),this._updatePath(),this._container&&this._map._pathRoot.appendChild(this._container),this.fire("add"),t.on({viewreset:this.projectLatlngs,moveend:this._updatePath},this)},addTo:function(t){return t.addLayer(this),this},onRemove:function(t){t._pathRoot.removeChild(this._container),this.fire("remove"),this._map=null,s.Browser.vml&&(this._container=null,this._stroke=null,this._fill=null),t.off({viewreset:this.projectLatlngs,moveend:this._updatePath},this)},projectLatlngs:function(){},setStyle:function(t){return s.setOptions(this,t),this._container&&this._updateStyle(),this},redraw:function(){return this._map&&(this.projectLatlngs(),this._updatePath()),this}}),s.Map.include({_updatePathViewport:function(){var t=s.Path.CLIP_PADDING,e=this.getSize(),n=s.DomUtil.getPosition(this._mapPane),i=n.multiplyBy(-1)._subtract(e.multiplyBy(t)._round()),o=i.add(e.multiplyBy(1+2*t)._round());this._pathViewport=new s.Bounds(i,o)}}),s.Path.SVG_NS="http://www.w3.org/2000/svg",s.Browser.svg=!(!i.createElementNS||!i.createElementNS(s.Path.SVG_NS,"svg").createSVGRect),s.Path=s.Path.extend({statics:{SVG:s.Browser.svg},bringToFront:function(){var t=this._map._pathRoot,e=this._container;return e&&t.lastChild!==e&&t.appendChild(e),this},bringToBack:function(){var t=this._map._pathRoot,e=this._container,n=t.firstChild;return e&&n!==e&&t.insertBefore(e,n),this},getPathString:function(){},_createElement:function(t){return i.createElementNS(s.Path.SVG_NS,t)},_initElements:function(){this._map._initPathRoot(),this._initPath(),this._initStyle()},_initPath:function(){this._container=this._createElement("g"),this._path=this._createElement("path"),this.options.className&&s.DomUtil.addClass(this._path,this.options.className),this._container.appendChild(this._path)},_initStyle:function(){this.options.stroke&&(this._path.setAttribute("stroke-linejoin","round"),this._path.setAttribute("stroke-linecap","round")),this.options.fill&&this._path.setAttribute("fill-rule","evenodd"),this.options.pointerEvents&&this._path.setAttribute("pointer-events",this.options.pointerEvents),this.options.clickable||this.options.pointerEvents||this._path.setAttribute("pointer-events","none"),this._updateStyle()},_updateStyle:function(){this.options.stroke?(this._path.setAttribute("stroke",this.options.color),this._path.setAttribute("stroke-opacity",this.options.opacity),this._path.setAttribute("stroke-width",this.options.weight),this.options.dashArray?this._path.setAttribute("stroke-dasharray",this.options.dashArray):this._path.removeAttribute("stroke-dasharray"),this.options.lineCap&&this._path.setAttribute("stroke-linecap",this.options.lineCap),this.options.lineJoin&&this._path.setAttribute("stroke-linejoin",this.options.lineJoin)):this._path.setAttribute("stroke","none"),this.options.fill?(this._path.setAttribute("fill",this.options.fillColor||this.options.color),this._path.setAttribute("fill-opacity",this.options.fillOpacity)):this._path.setAttribute("fill","none")},_updatePath:function(){var t=this.getPathString();t||(t="M0 0"),this._path.setAttribute("d",t)},_initEvents:function(){if(this.options.clickable){(s.Browser.svg||!s.Browser.vml)&&s.DomUtil.addClass(this._path,"leaflet-clickable"),s.DomEvent.on(this._container,"click",this._onMouseClick,this);for(var t=["dblclick","mousedown","mouseover","mouseout","mousemove","contextmenu"],e=0;e<t.length;e++)s.DomEvent.on(this._container,t[e],this._fireMouseEvent,this)}},_onMouseClick:function(t){this._map.dragging&&this._map.dragging.moved()||this._fireMouseEvent(t)},_fireMouseEvent:function(t){if(this._map&&this.hasEventListeners(t.type)){var e=this._map,n=e.mouseEventToContainerPoint(t),i=e.containerPointToLayerPoint(n),o=e.layerPointToLatLng(i);this.fire(t.type,{latlng:o,layerPoint:i,containerPoint:n,originalEvent:t}),"contextmenu"===t.type&&s.DomEvent.preventDefault(t),"mousemove"!==t.type&&s.DomEvent.stopPropagation(t)}}}),s.Map.include({_initPathRoot:function(){this._pathRoot||(this._pathRoot=s.Path.prototype._createElement("svg"),this._panes.overlayPane.appendChild(this._pathRoot),this.options.zoomAnimation&&s.Browser.any3d?(s.DomUtil.addClass(this._pathRoot,"leaflet-zoom-animated"),this.on({zoomanim:this._animatePathZoom,zoomend:this._endPathZoom})):s.DomUtil.addClass(this._pathRoot,"leaflet-zoom-hide"),this.on("moveend",this._updateSvgViewport),this._updateSvgViewport())},_animatePathZoom:function(t){var e=this.getZoomScale(t.zoom),n=this._getCenterOffset(t.center)._multiplyBy(-e)._add(this._pathViewport.min);this._pathRoot.style[s.DomUtil.TRANSFORM]=s.DomUtil.getTranslateString(n)+" scale("+e+") ",this._pathZooming=!0},_endPathZoom:function(){this._pathZooming=!1},_updateSvgViewport:function(){if(!this._pathZooming){this._updatePathViewport();var t=this._pathViewport,e=t.min,n=t.max,i=n.x-e.x,o=n.y-e.y,r=this._pathRoot,a=this._panes.overlayPane;s.Browser.mobileWebkit&&a.removeChild(r),s.DomUtil.setPosition(r,e),r.setAttribute("width",i),r.setAttribute("height",o),r.setAttribute("viewBox",[e.x,e.y,i,o].join(" ")),s.Browser.mobileWebkit&&a.appendChild(r)}}}),s.Path.include({bindPopup:function(t,e){return t instanceof s.Popup?this._popup=t:((!this._popup||e)&&(this._popup=new s.Popup(e,this)),this._popup.setContent(t)),this._popupHandlersAdded||(this.on("click",this._openPopup,this).on("remove",this.closePopup,this),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this._popup=null,this.off("click",this._openPopup).off("remove",this.closePopup),this._popupHandlersAdded=!1),this},openPopup:function(t){return this._popup&&(t=t||this._latlng||this._latlngs[Math.floor(this._latlngs.length/2)],this._openPopup({latlng:t})),this},closePopup:function(){return this._popup&&this._popup._close(),this},_openPopup:function(t){this._popup.setLatLng(t.latlng),this._map.openPopup(this._popup)}}),s.Browser.vml=!s.Browser.svg&&function(){try{var t=i.createElement("div");t.innerHTML='<v:shape adj="1"/>';var e=t.firstChild;return e.style.behavior="url(#default#VML)",e&&"object"==typeof e.adj}catch(n){return!1}}(),s.Path=s.Browser.svg||!s.Browser.vml?s.Path:s.Path.extend({statics:{VML:!0,CLIP_PADDING:.02},_createElement:function(){try{return i.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return i.createElement("<lvml:"+t+' class="lvml">')}}catch(t){return function(t){return i.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),_initPath:function(){var t=this._container=this._createElement("shape");s.DomUtil.addClass(t,"leaflet-vml-shape"+(this.options.className?" "+this.options.className:"")),this.options.clickable&&s.DomUtil.addClass(t,"leaflet-clickable"),t.coordsize="1 1",this._path=this._createElement("path"),t.appendChild(this._path),this._map._pathRoot.appendChild(t)},_initStyle:function(){this._updateStyle()},_updateStyle:function(){var t=this._stroke,e=this._fill,n=this.options,i=this._container;i.stroked=n.stroke,i.filled=n.fill,n.stroke?(t||(t=this._stroke=this._createElement("stroke"),t.endcap="round",i.appendChild(t)),t.weight=n.weight+"px",t.color=n.color,t.opacity=n.opacity,n.dashArray?t.dashStyle=s.Util.isArray(n.dashArray)?n.dashArray.join(" "):n.dashArray.replace(/( *, *)/g," "):t.dashStyle="",n.lineCap&&(t.endcap=n.lineCap.replace("butt","flat")),n.lineJoin&&(t.joinstyle=n.lineJoin)):t&&(i.removeChild(t),this._stroke=null),n.fill?(e||(e=this._fill=this._createElement("fill"),i.appendChild(e)),e.color=n.fillColor||n.color,e.opacity=n.fillOpacity):e&&(i.removeChild(e),this._fill=null)},_updatePath:function(){var t=this._container.style;t.display="none",this._path.v=this.getPathString()+" ",t.display=""}}),s.Map.include(s.Browser.svg||!s.Browser.vml?{}:{_initPathRoot:function(){if(!this._pathRoot){var t=this._pathRoot=i.createElement("div");t.className="leaflet-vml-container",this._panes.overlayPane.appendChild(t),this.on("moveend",this._updatePathViewport),this._updatePathViewport()}}}),s.Browser.canvas=function(){return!!i.createElement("canvas").getContext}(),s.Path=s.Path.SVG&&!e.L_PREFER_CANVAS||!s.Browser.canvas?s.Path:s.Path.extend({statics:{CANVAS:!0,SVG:!1},redraw:function(){return this._map&&(this.projectLatlngs(),this._requestUpdate()),this},setStyle:function(t){return s.setOptions(this,t),this._map&&(this._updateStyle(),this._requestUpdate()),this},onRemove:function(t){t.off("viewreset",this.projectLatlngs,this).off("moveend",this._updatePath,this),this.options.clickable&&(this._map.off("click",this._onClick,this),this._map.off("mousemove",this._onMouseMove,this)),this._requestUpdate(),this.fire("remove"),this._map=null},_requestUpdate:function(){this._map&&!s.Path._updateRequest&&(s.Path._updateRequest=s.Util.requestAnimFrame(this._fireMapMoveEnd,this._map))},_fireMapMoveEnd:function(){s.Path._updateRequest=null,this.fire("moveend")},_initElements:function(){this._map._initPathRoot(),this._ctx=this._map._canvasCtx},_updateStyle:function(){var t=this.options;t.stroke&&(this._ctx.lineWidth=t.weight,this._ctx.strokeStyle=t.color),t.fill&&(this._ctx.fillStyle=t.fillColor||t.color),t.lineCap&&(this._ctx.lineCap=t.lineCap),t.lineJoin&&(this._ctx.lineJoin=t.lineJoin)},_drawPath:function(){var t,e,n,i,o,r;for(this._ctx.beginPath(),t=0,n=this._parts.length;n>t;t++){for(e=0,i=this._parts[t].length;i>e;e++)o=this._parts[t][e],r=(0===e?"move":"line")+"To",this._ctx[r](o.x,o.y);this instanceof s.Polygon&&this._ctx.closePath()}},_checkIfEmpty:function(){return!this._parts.length},_updatePath:function(){if(!this._checkIfEmpty()){var t=this._ctx,e=this.options;this._drawPath(),t.save(),this._updateStyle(),e.fill&&(t.globalAlpha=e.fillOpacity,t.fill(e.fillRule||"evenodd")),e.stroke&&(t.globalAlpha=e.opacity,t.stroke()),t.restore()}},_initEvents:function(){this.options.clickable&&(this._map.on("mousemove",this._onMouseMove,this),this._map.on("click dblclick contextmenu",this._fireMouseEvent,this))},_fireMouseEvent:function(t){this._containsPoint(t.layerPoint)&&this.fire(t.type,t)},_onMouseMove:function(t){this._map&&!this._map._animatingZoom&&(this._containsPoint(t.layerPoint)?(this._ctx.canvas.style.cursor="pointer",this._mouseInside=!0,this.fire("mouseover",t)):this._mouseInside&&(this._ctx.canvas.style.cursor="",this._mouseInside=!1,this.fire("mouseout",t)))}}),s.Map.include(s.Path.SVG&&!e.L_PREFER_CANVAS||!s.Browser.canvas?{}:{_initPathRoot:function(){var t,e=this._pathRoot;e||(e=this._pathRoot=i.createElement("canvas"),e.style.position="absolute",t=this._canvasCtx=e.getContext("2d"),t.lineCap="round",t.lineJoin="round",this._panes.overlayPane.appendChild(e),this.options.zoomAnimation&&(this._pathRoot.className="leaflet-zoom-animated",this.on("zoomanim",this._animatePathZoom),this.on("zoomend",this._endPathZoom)),this.on("moveend",this._updateCanvasViewport),this._updateCanvasViewport())},_updateCanvasViewport:function(){if(!this._pathZooming){this._updatePathViewport();var t=this._pathViewport,e=t.min,n=t.max.subtract(e),i=this._pathRoot;s.DomUtil.setPosition(i,e),i.width=n.x,i.height=n.y,i.getContext("2d").translate(-e.x,-e.y)}}}),s.LineUtil={simplify:function(t,e){if(!e||!t.length)return t.slice();var n=e*e;return t=this._reducePoints(t,n),t=this._simplifyDP(t,n)},pointToSegmentDistance:function(t,e,n){return Math.sqrt(this._sqClosestPointOnSegment(t,e,n,!0))},closestPointOnSegment:function(t,e,n){return this._sqClosestPointOnSegment(t,e,n)},_simplifyDP:function(t,e){var n=t.length,i=typeof Uint8Array!=o+""?Uint8Array:Array,r=new i(n);r[0]=r[n-1]=1,this._simplifyDPStep(t,r,e,0,n-1);var s,a=[];for(s=0;n>s;s++)r[s]&&a.push(t[s]);return a},_simplifyDPStep:function(t,e,n,i,o){var r,s,a,h=0;for(s=i+1;o-1>=s;s++)a=this._sqClosestPointOnSegment(t[s],t[i],t[o],!0),a>h&&(r=s,h=a);h>n&&(e[r]=1,this._simplifyDPStep(t,e,n,i,r),this._simplifyDPStep(t,e,n,r,o))},_reducePoints:function(t,e){for(var n=[t[0]],i=1,o=0,r=t.length;r>i;i++)this._sqDist(t[i],t[o])>e&&(n.push(t[i]),o=i);return r-1>o&&n.push(t[r-1]),n},clipSegment:function(t,e,n,i){var o,r,s,a=i?this._lastCode:this._getBitCode(t,n),h=this._getBitCode(e,n);for(this._lastCode=h;;){if(!(a|h))return[t,e];if(a&h)return!1;o=a||h,r=this._getEdgeIntersection(t,e,o,n),s=this._getBitCode(r,n),o===a?(t=r,a=s):(e=r,h=s)}},_getEdgeIntersection:function(t,e,n,i){var o=e.x-t.x,r=e.y-t.y,a=i.min,h=i.max;return 8&n?new s.Point(t.x+o*(h.y-t.y)/r,h.y):4&n?new s.Point(t.x+o*(a.y-t.y)/r,a.y):2&n?new s.Point(h.x,t.y+r*(h.x-t.x)/o):1&n?new s.Point(a.x,t.y+r*(a.x-t.x)/o):void 0},_getBitCode:function(t,e){var n=0;return t.x<e.min.x?n|=1:t.x>e.max.x&&(n|=2),t.y<e.min.y?n|=4:t.y>e.max.y&&(n|=8),n},_sqDist:function(t,e){var n=e.x-t.x,i=e.y-t.y;return n*n+i*i},_sqClosestPointOnSegment:function(t,e,n,i){var o,r=e.x,a=e.y,h=n.x-r,l=n.y-a,c=h*h+l*l;return c>0&&(o=((t.x-r)*h+(t.y-a)*l)/c,o>1?(r=n.x,a=n.y):o>0&&(r+=h*o,a+=l*o)),h=t.x-r,l=t.y-a,i?h*h+l*l:new s.Point(r,a)}},s.Polyline=s.Path.extend({initialize:function(t,e){s.Path.prototype.initialize.call(this,e),this._latlngs=this._convertLatLngs(t)},options:{smoothFactor:1,noClip:!1},projectLatlngs:function(){this._originalPoints=[];for(var t=0,e=this._latlngs.length;e>t;t++)this._originalPoints[t]=this._map.latLngToLayerPoint(this._latlngs[t])},getPathString:function(){for(var t=0,e=this._parts.length,n="";e>t;t++)n+=this._getPathPartStr(this._parts[t]);return n},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._latlngs=this._convertLatLngs(t),this.redraw()},addLatLng:function(t){return this._latlngs.push(s.latLng(t)),this.redraw()},spliceLatLngs:function(){var t=[].splice.apply(this._latlngs,arguments);return this._convertLatLngs(this._latlngs,!0),this.redraw(),t},closestLayerPoint:function(t){for(var e,n,i=1/0,o=this._parts,r=null,a=0,h=o.length;h>a;a++)for(var l=o[a],c=1,u=l.length;u>c;c++){e=l[c-1],n=l[c];var d=s.LineUtil._sqClosestPointOnSegment(t,e,n,!0);i>d&&(i=d,r=s.LineUtil._sqClosestPointOnSegment(t,e,n))}return r&&(r.distance=Math.sqrt(i)),r},getBounds:function(){return new s.LatLngBounds(this.getLatLngs())},_convertLatLngs:function(t,e){var n,i,o=e?t:[];for(n=0,i=t.length;i>n;n++){if(s.Util.isArray(t[n])&&"number"!=typeof t[n][0])return;o[n]=s.latLng(t[n])}return o},_initEvents:function(){s.Path.prototype._initEvents.call(this)},_getPathPartStr:function(t){for(var e,n=s.Path.VML,i=0,o=t.length,r="";o>i;i++)e=t[i],n&&e._round(),r+=(i?"L":"M")+e.x+" "+e.y;return r},_clipPoints:function(){var t,e,n,i=this._originalPoints,o=i.length;if(this.options.noClip)return void(this._parts=[i]);this._parts=[];var r=this._parts,a=this._map._pathViewport,h=s.LineUtil;for(t=0,e=0;o-1>t;t++)n=h.clipSegment(i[t],i[t+1],a,t),n&&(r[e]=r[e]||[],r[e].push(n[0]),(n[1]!==i[t+1]||t===o-2)&&(r[e].push(n[1]),e++))},_simplifyPoints:function(){for(var t=this._parts,e=s.LineUtil,n=0,i=t.length;i>n;n++)t[n]=e.simplify(t[n],this.options.smoothFactor)},_updatePath:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),s.Path.prototype._updatePath.call(this))}}),s.polyline=function(t,e){return new s.Polyline(t,e)},s.PolyUtil={},s.PolyUtil.clipPolygon=function(t,e){var n,i,o,r,a,h,l,c,u,d=[1,4,2,8],p=s.LineUtil;for(i=0,l=t.length;l>i;i++)t[i]._code=p._getBitCode(t[i],e);for(r=0;4>r;r++){for(c=d[r],n=[],i=0,l=t.length,o=l-1;l>i;o=i++)a=t[i],h=t[o],a._code&c?h._code&c||(u=p._getEdgeIntersection(h,a,c,e),u._code=p._getBitCode(u,e),n.push(u)):(h._code&c&&(u=p._getEdgeIntersection(h,a,c,e),u._code=p._getBitCode(u,e),n.push(u)),n.push(a));t=n}return t},s.Polygon=s.Polyline.extend({options:{fill:!0},initialize:function(t,e){s.Polyline.prototype.initialize.call(this,t,e),this._initWithHoles(t)},_initWithHoles:function(t){var e,n,i;if(t&&s.Util.isArray(t[0])&&"number"!=typeof t[0][0])for(this._latlngs=this._convertLatLngs(t[0]),this._holes=t.slice(1),e=0,n=this._holes.length;n>e;e++)i=this._holes[e]=this._convertLatLngs(this._holes[e]),i[0].equals(i[i.length-1])&&i.pop();t=this._latlngs,t.length>=2&&t[0].equals(t[t.length-1])&&t.pop()},projectLatlngs:function(){if(s.Polyline.prototype.projectLatlngs.call(this),this._holePoints=[],this._holes){var t,e,n,i;for(t=0,n=this._holes.length;n>t;t++)for(this._holePoints[t]=[],e=0,i=this._holes[t].length;i>e;e++)this._holePoints[t][e]=this._map.latLngToLayerPoint(this._holes[t][e])}},setLatLngs:function(t){return t&&s.Util.isArray(t[0])&&"number"!=typeof t[0][0]?(this._initWithHoles(t),this.redraw()):s.Polyline.prototype.setLatLngs.call(this,t)},_clipPoints:function(){var t=this._originalPoints,e=[];if(this._parts=[t].concat(this._holePoints),!this.options.noClip){for(var n=0,i=this._parts.length;i>n;n++){var o=s.PolyUtil.clipPolygon(this._parts[n],this._map._pathViewport);o.length&&e.push(o)}this._parts=e}},_getPathPartStr:function(t){var e=s.Polyline.prototype._getPathPartStr.call(this,t);return e+(s.Browser.svg?"z":"x")}}),s.polygon=function(t,e){return new s.Polygon(t,e)},function(){function t(t){return s.FeatureGroup.extend({initialize:function(t,e){this._layers={},this._options=e,this.setLatLngs(t)},setLatLngs:function(e){var n=0,i=e.length;for(this.eachLayer(function(t){i>n?t.setLatLngs(e[n++]):this.removeLayer(t)},this);i>n;)this.addLayer(new t(e[n++],this._options));return this},getLatLngs:function(){var t=[];return this.eachLayer(function(e){t.push(e.getLatLngs())}),t}})}s.MultiPolyline=t(s.Polyline),s.MultiPolygon=t(s.Polygon),s.multiPolyline=function(t,e){return new s.MultiPolyline(t,e)},s.multiPolygon=function(t,e){return new s.MultiPolygon(t,e)}}(),s.Rectangle=s.Polygon.extend({initialize:function(t,e){s.Polygon.prototype.initialize.call(this,this._boundsToLatLngs(t),e)},setBounds:function(t){this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return t=s.latLngBounds(t),[t.getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}}),s.rectangle=function(t,e){return new s.Rectangle(t,e)},s.Circle=s.Path.extend({initialize:function(t,e,n){s.Path.prototype.initialize.call(this,n),this._latlng=s.latLng(t),this._mRadius=e},options:{fill:!0},setLatLng:function(t){return this._latlng=s.latLng(t),this.redraw()},setRadius:function(t){return this._mRadius=t,this.redraw()},projectLatlngs:function(){var t=this._getLngRadius(),e=this._latlng,n=this._map.latLngToLayerPoint([e.lat,e.lng-t]);this._point=this._map.latLngToLayerPoint(e),this._radius=Math.max(this._point.x-n.x,1)},getBounds:function(){var t=this._getLngRadius(),e=this._mRadius/40075017*360,n=this._latlng;return new s.LatLngBounds([n.lat-e,n.lng-t],[n.lat+e,n.lng+t])},getLatLng:function(){return this._latlng},getPathString:function(){var t=this._point,e=this._radius;return this._checkIfEmpty()?"":s.Browser.svg?"M"+t.x+","+(t.y-e)+"A"+e+","+e+",0,1,1,"+(t.x-.1)+","+(t.y-e)+" z":(t._round(),e=Math.round(e),"AL "+t.x+","+t.y+" "+e+","+e+" 0,23592600")},getRadius:function(){return this._mRadius},_getLatRadius:function(){return this._mRadius/40075017*360},_getLngRadius:function(){return this._getLatRadius()/Math.cos(s.LatLng.DEG_TO_RAD*this._latlng.lat)},_checkIfEmpty:function(){if(!this._map)return!1;var t=this._map._pathViewport,e=this._radius,n=this._point;return n.x-e>t.max.x||n.y-e>t.max.y||n.x+e<t.min.x||n.y+e<t.min.y}}),s.circle=function(t,e,n){return new s.Circle(t,e,n)},s.CircleMarker=s.Circle.extend({options:{radius:10,weight:2},initialize:function(t,e){s.Circle.prototype.initialize.call(this,t,null,e),this._radius=this.options.radius},projectLatlngs:function(){this._point=this._map.latLngToLayerPoint(this._latlng)},_updateStyle:function(){s.Circle.prototype._updateStyle.call(this),this.setRadius(this.options.radius)},setLatLng:function(t){return s.Circle.prototype.setLatLng.call(this,t),this._popup&&this._popup._isOpen&&this._popup.setLatLng(t),this},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius}}),s.circleMarker=function(t,e){return new s.CircleMarker(t,e)},s.Polyline.include(s.Path.CANVAS?{_containsPoint:function(t,e){var n,i,o,r,a,h,l,c=this.options.weight/2;for(s.Browser.touch&&(c+=10),n=0,r=this._parts.length;r>n;n++)for(l=this._parts[n],i=0,a=l.length,o=a-1;a>i;o=i++)if((e||0!==i)&&(h=s.LineUtil.pointToSegmentDistance(t,l[o],l[i]),c>=h))return!0;return!1}}:{}),s.Polygon.include(s.Path.CANVAS?{_containsPoint:function(t){var e,n,i,o,r,a,h,l,c=!1;if(s.Polyline.prototype._containsPoint.call(this,t,!0))return!0;for(o=0,h=this._parts.length;h>o;o++)for(e=this._parts[o],r=0,l=e.length,a=l-1;l>r;a=r++)n=e[r],i=e[a],n.y>t.y!=i.y>t.y&&t.x<(i.x-n.x)*(t.y-n.y)/(i.y-n.y)+n.x&&(c=!c);return c}}:{}),s.Circle.include(s.Path.CANVAS?{_drawPath:function(){var t=this._point;this._ctx.beginPath(),this._ctx.arc(t.x,t.y,this._radius,0,2*Math.PI,!1)},_containsPoint:function(t){var e=this._point,n=this.options.stroke?this.options.weight/2:0;return t.distanceTo(e)<=this._radius+n}}:{}),s.CircleMarker.include(s.Path.CANVAS?{_updateStyle:function(){s.Path.prototype._updateStyle.call(this)}}:{}),s.GeoJSON=s.FeatureGroup.extend({initialize:function(t,e){s.setOptions(this,e),this._layers={},t&&this.addData(t)},addData:function(t){var e,n,i,o=s.Util.isArray(t)?t:t.features;if(o){for(e=0,n=o.length;n>e;e++)i=o[e],(i.geometries||i.geometry||i.features||i.coordinates)&&this.addData(o[e]);return this}var r=this.options;if(!r.filter||r.filter(t)){var a=s.GeoJSON.geometryToLayer(t,r.pointToLayer,r.coordsToLatLng,r);return a.feature=s.GeoJSON.asFeature(t),a.defaultOptions=a.options,
this.resetStyle(a),r.onEachFeature&&r.onEachFeature(t,a),this.addLayer(a)}},resetStyle:function(t){var e=this.options.style;e&&(s.Util.extend(t.options,t.defaultOptions),this._setLayerStyle(t,e))},setStyle:function(t){this.eachLayer(function(e){this._setLayerStyle(e,t)},this)},_setLayerStyle:function(t,e){"function"==typeof e&&(e=e(t.feature)),t.setStyle&&t.setStyle(e)}}),s.extend(s.GeoJSON,{geometryToLayer:function(t,e,n,i){var o,r,a,h,l="Feature"===t.type?t.geometry:t,c=l.coordinates,u=[];switch(n=n||this.coordsToLatLng,l.type){case"Point":return o=n(c),e?e(t,o):new s.Marker(o);case"MultiPoint":for(a=0,h=c.length;h>a;a++)o=n(c[a]),u.push(e?e(t,o):new s.Marker(o));return new s.FeatureGroup(u);case"LineString":return r=this.coordsToLatLngs(c,0,n),new s.Polyline(r,i);case"Polygon":if(2===c.length&&!c[1].length)throw new Error("Invalid GeoJSON object.");return r=this.coordsToLatLngs(c,1,n),new s.Polygon(r,i);case"MultiLineString":return r=this.coordsToLatLngs(c,1,n),new s.MultiPolyline(r,i);case"MultiPolygon":return r=this.coordsToLatLngs(c,2,n),new s.MultiPolygon(r,i);case"GeometryCollection":for(a=0,h=l.geometries.length;h>a;a++)u.push(this.geometryToLayer({geometry:l.geometries[a],type:"Feature",properties:t.properties},e,n,i));return new s.FeatureGroup(u);default:throw new Error("Invalid GeoJSON object.")}},coordsToLatLng:function(t){return new s.LatLng(t[1],t[0],t[2])},coordsToLatLngs:function(t,e,n){var i,o,r,s=[];for(o=0,r=t.length;r>o;o++)i=e?this.coordsToLatLngs(t[o],e-1,n):(n||this.coordsToLatLng)(t[o]),s.push(i);return s},latLngToCoords:function(t){var e=[t.lng,t.lat];return t.alt!==o&&e.push(t.alt),e},latLngsToCoords:function(t){for(var e=[],n=0,i=t.length;i>n;n++)e.push(s.GeoJSON.latLngToCoords(t[n]));return e},getFeature:function(t,e){return t.feature?s.extend({},t.feature,{geometry:e}):s.GeoJSON.asFeature(e)},asFeature:function(t){return"Feature"===t.type?t:{type:"Feature",properties:{},geometry:t}}});var h={toGeoJSON:function(){return s.GeoJSON.getFeature(this,{type:"Point",coordinates:s.GeoJSON.latLngToCoords(this.getLatLng())})}};s.Marker.include(h),s.Circle.include(h),s.CircleMarker.include(h),s.Polyline.include({toGeoJSON:function(){return s.GeoJSON.getFeature(this,{type:"LineString",coordinates:s.GeoJSON.latLngsToCoords(this.getLatLngs())})}}),s.Polygon.include({toGeoJSON:function(){var t,e,n,i=[s.GeoJSON.latLngsToCoords(this.getLatLngs())];if(i[0].push(i[0][0]),this._holes)for(t=0,e=this._holes.length;e>t;t++)n=s.GeoJSON.latLngsToCoords(this._holes[t]),n.push(n[0]),i.push(n);return s.GeoJSON.getFeature(this,{type:"Polygon",coordinates:i})}}),function(){function t(t){return function(){var e=[];return this.eachLayer(function(t){e.push(t.toGeoJSON().geometry.coordinates)}),s.GeoJSON.getFeature(this,{type:t,coordinates:e})}}s.MultiPolyline.include({toGeoJSON:t("MultiLineString")}),s.MultiPolygon.include({toGeoJSON:t("MultiPolygon")}),s.LayerGroup.include({toGeoJSON:function(){var e,n=this.feature&&this.feature.geometry,i=[];if(n&&"MultiPoint"===n.type)return t("MultiPoint").call(this);var o=n&&"GeometryCollection"===n.type;return this.eachLayer(function(t){t.toGeoJSON&&(e=t.toGeoJSON(),i.push(o?e.geometry:s.GeoJSON.asFeature(e)))}),o?s.GeoJSON.getFeature(this,{geometries:i,type:"GeometryCollection"}):{type:"FeatureCollection",features:i}}})}(),s.geoJson=function(t,e){return new s.GeoJSON(t,e)},s.DomEvent={addListener:function(t,e,n,i){var o,r,a,h=s.stamp(n),l="_leaflet_"+e+h;return t[l]?this:(o=function(e){return n.call(i||t,e||s.DomEvent._getEvent())},s.Browser.pointer&&0===e.indexOf("touch")?this.addPointerListener(t,e,o,h):(s.Browser.touch&&"dblclick"===e&&this.addDoubleTapListener&&this.addDoubleTapListener(t,o,h),"addEventListener"in t?"mousewheel"===e?(t.addEventListener("DOMMouseScroll",o,!1),t.addEventListener(e,o,!1)):"mouseenter"===e||"mouseleave"===e?(r=o,a="mouseenter"===e?"mouseover":"mouseout",o=function(e){return s.DomEvent._checkMouse(t,e)?r(e):void 0},t.addEventListener(a,o,!1)):"click"===e&&s.Browser.android?(r=o,o=function(t){return s.DomEvent._filterClick(t,r)},t.addEventListener(e,o,!1)):t.addEventListener(e,o,!1):"attachEvent"in t&&t.attachEvent("on"+e,o),t[l]=o,this))},removeListener:function(t,e,n){var i=s.stamp(n),o="_leaflet_"+e+i,r=t[o];return r?(s.Browser.pointer&&0===e.indexOf("touch")?this.removePointerListener(t,e,i):s.Browser.touch&&"dblclick"===e&&this.removeDoubleTapListener?this.removeDoubleTapListener(t,i):"removeEventListener"in t?"mousewheel"===e?(t.removeEventListener("DOMMouseScroll",r,!1),t.removeEventListener(e,r,!1)):"mouseenter"===e||"mouseleave"===e?t.removeEventListener("mouseenter"===e?"mouseover":"mouseout",r,!1):t.removeEventListener(e,r,!1):"detachEvent"in t&&t.detachEvent("on"+e,r),t[o]=null,this):this},stopPropagation:function(t){return t.stopPropagation?t.stopPropagation():t.cancelBubble=!0,s.DomEvent._skipped(t),this},disableScrollPropagation:function(t){var e=s.DomEvent.stopPropagation;return s.DomEvent.on(t,"mousewheel",e).on(t,"MozMousePixelScroll",e)},disableClickPropagation:function(t){for(var e=s.DomEvent.stopPropagation,n=s.Draggable.START.length-1;n>=0;n--)s.DomEvent.on(t,s.Draggable.START[n],e);return s.DomEvent.on(t,"click",s.DomEvent._fakeStop).on(t,"dblclick",e)},preventDefault:function(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this},stop:function(t){return s.DomEvent.preventDefault(t).stopPropagation(t)},getMousePosition:function(t,e){if(!e)return new s.Point(t.clientX,t.clientY);var n=e.getBoundingClientRect();return new s.Point(t.clientX-n.left-e.clientLeft,t.clientY-n.top-e.clientTop)},getWheelDelta:function(t){var e=0;return t.wheelDelta&&(e=t.wheelDelta/120),t.detail&&(e=-t.detail/3),e},_skipEvents:{},_fakeStop:function(t){s.DomEvent._skipEvents[t.type]=!0},_skipped:function(t){var e=this._skipEvents[t.type];return this._skipEvents[t.type]=!1,e},_checkMouse:function(t,e){var n=e.relatedTarget;if(!n)return!0;try{for(;n&&n!==t;)n=n.parentNode}catch(i){return!1}return n!==t},_getEvent:function(){var t=e.event;if(!t)for(var n=arguments.callee.caller;n&&(t=n.arguments[0],!t||e.Event!==t.constructor);)n=n.caller;return t},_filterClick:function(t,e){var n=t.timeStamp||t.originalEvent.timeStamp,i=s.DomEvent._lastClick&&n-s.DomEvent._lastClick;return i&&i>100&&500>i||t.target._simulatedClick&&!t._simulated?void s.DomEvent.stop(t):(s.DomEvent._lastClick=n,e(t))}},s.DomEvent.on=s.DomEvent.addListener,s.DomEvent.off=s.DomEvent.removeListener,s.Draggable=s.Class.extend({includes:s.Mixin.Events,statics:{START:s.Browser.touch?["touchstart","mousedown"]:["mousedown"],END:{mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},MOVE:{mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"}},initialize:function(t,e){this._element=t,this._dragStartTarget=e||t},enable:function(){if(!this._enabled){for(var t=s.Draggable.START.length-1;t>=0;t--)s.DomEvent.on(this._dragStartTarget,s.Draggable.START[t],this._onDown,this);this._enabled=!0}},disable:function(){if(this._enabled){for(var t=s.Draggable.START.length-1;t>=0;t--)s.DomEvent.off(this._dragStartTarget,s.Draggable.START[t],this._onDown,this);this._enabled=!1,this._moved=!1}},_onDown:function(t){if(this._moved=!1,!t.shiftKey&&(1===t.which||1===t.button||t.touches)&&(s.DomEvent.stopPropagation(t),!s.Draggable._disabled&&(s.DomUtil.disableImageDrag(),s.DomUtil.disableTextSelection(),!this._moving))){var e=t.touches?t.touches[0]:t;this._startPoint=new s.Point(e.clientX,e.clientY),this._startPos=this._newPos=s.DomUtil.getPosition(this._element),s.DomEvent.on(i,s.Draggable.MOVE[t.type],this._onMove,this).on(i,s.Draggable.END[t.type],this._onUp,this)}},_onMove:function(t){if(t.touches&&t.touches.length>1)return void(this._moved=!0);var e=t.touches&&1===t.touches.length?t.touches[0]:t,n=new s.Point(e.clientX,e.clientY),o=n.subtract(this._startPoint);(o.x||o.y)&&(s.Browser.touch&&Math.abs(o.x)+Math.abs(o.y)<3||(s.DomEvent.preventDefault(t),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=s.DomUtil.getPosition(this._element).subtract(o),s.DomUtil.addClass(i.body,"leaflet-dragging"),this._lastTarget=t.target||t.srcElement,s.DomUtil.addClass(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(o),this._moving=!0,s.Util.cancelAnimFrame(this._animRequest),this._animRequest=s.Util.requestAnimFrame(this._updatePosition,this,!0,this._dragStartTarget)))},_updatePosition:function(){this.fire("predrag"),s.DomUtil.setPosition(this._element,this._newPos),this.fire("drag")},_onUp:function(){s.DomUtil.removeClass(i.body,"leaflet-dragging"),this._lastTarget&&(s.DomUtil.removeClass(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null);for(var t in s.Draggable.MOVE)s.DomEvent.off(i,s.Draggable.MOVE[t],this._onMove).off(i,s.Draggable.END[t],this._onUp);s.DomUtil.enableImageDrag(),s.DomUtil.enableTextSelection(),this._moved&&this._moving&&(s.Util.cancelAnimFrame(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)})),this._moving=!1}}),s.Handler=s.Class.extend({initialize:function(t){this._map=t},enable:function(){this._enabled||(this._enabled=!0,this.addHooks())},disable:function(){this._enabled&&(this._enabled=!1,this.removeHooks())},enabled:function(){return!!this._enabled}}),s.Map.mergeOptions({dragging:!0,inertia:!s.Browser.android23,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,inertiaThreshold:s.Browser.touch?32:18,easeLinearity:.25,worldCopyJump:!1}),s.Map.Drag=s.Handler.extend({addHooks:function(){if(!this._draggable){var t=this._map;this._draggable=new s.Draggable(t._mapPane,t._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDrag,this),t.on("viewreset",this._onViewReset,this),t.whenReady(this._onViewReset,this))}this._draggable.enable()},removeHooks:function(){this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){var t=this._map;t._panAnim&&t._panAnim.stop(),t.fire("movestart").fire("dragstart"),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(){if(this._map.options.inertia){var t=this._lastTime=+new Date,e=this._lastPos=this._draggable._newPos;this._positions.push(e),this._times.push(t),t-this._times[0]>200&&(this._positions.shift(),this._times.shift())}this._map.fire("move").fire("drag")},_onViewReset:function(){var t=this._map.getSize()._divideBy(2),e=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=e.subtract(t).x,this._worldWidth=this._map.project([0,180]).x},_onPreDrag:function(){var t=this._worldWidth,e=Math.round(t/2),n=this._initialWorldOffset,i=this._draggable._newPos.x,o=(i-e+n)%t+e-n,r=(i+e+n)%t-e-n,s=Math.abs(o+n)<Math.abs(r+n)?o:r;this._draggable._newPos.x=s},_onDragEnd:function(t){var e=this._map,n=e.options,i=+new Date-this._lastTime,o=!n.inertia||i>n.inertiaThreshold||!this._positions[0];if(e.fire("dragend",t),o)e.fire("moveend");else{var r=this._lastPos.subtract(this._positions[0]),a=(this._lastTime+i-this._times[0])/1e3,h=n.easeLinearity,l=r.multiplyBy(h/a),c=l.distanceTo([0,0]),u=Math.min(n.inertiaMaxSpeed,c),d=l.multiplyBy(u/c),p=u/(n.inertiaDeceleration*h),f=d.multiplyBy(-p/2).round();f.x&&f.y?(f=e._limitOffset(f,e.options.maxBounds),s.Util.requestAnimFrame(function(){e.panBy(f,{duration:p,easeLinearity:h,noMoveStart:!0})})):e.fire("moveend")}}}),s.Map.addInitHook("addHandler","dragging",s.Map.Drag),s.Map.mergeOptions({doubleClickZoom:!0}),s.Map.DoubleClickZoom=s.Handler.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var e=this._map,n=e.getZoom()+(t.originalEvent.shiftKey?-1:1);"center"===e.options.doubleClickZoom?e.setZoom(n):e.setZoomAround(t.containerPoint,n)}}),s.Map.addInitHook("addHandler","doubleClickZoom",s.Map.DoubleClickZoom),s.Map.mergeOptions({scrollWheelZoom:!0}),s.Map.ScrollWheelZoom=s.Handler.extend({addHooks:function(){s.DomEvent.on(this._map._container,"mousewheel",this._onWheelScroll,this),s.DomEvent.on(this._map._container,"MozMousePixelScroll",s.DomEvent.preventDefault),this._delta=0},removeHooks:function(){s.DomEvent.off(this._map._container,"mousewheel",this._onWheelScroll),s.DomEvent.off(this._map._container,"MozMousePixelScroll",s.DomEvent.preventDefault)},_onWheelScroll:function(t){var e=s.DomEvent.getWheelDelta(t);this._delta+=e,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);var n=Math.max(40-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(s.bind(this._performZoom,this),n),s.DomEvent.preventDefault(t),s.DomEvent.stopPropagation(t)},_performZoom:function(){var t=this._map,e=this._delta,n=t.getZoom();e=e>0?Math.ceil(e):Math.floor(e),e=Math.max(Math.min(e,4),-4),e=t._limitZoom(n+e)-n,this._delta=0,this._startTime=null,e&&("center"===t.options.scrollWheelZoom?t.setZoom(n+e):t.setZoomAround(this._lastMousePos,n+e))}}),s.Map.addInitHook("addHandler","scrollWheelZoom",s.Map.ScrollWheelZoom),s.extend(s.DomEvent,{_touchstart:s.Browser.msPointer?"MSPointerDown":s.Browser.pointer?"pointerdown":"touchstart",_touchend:s.Browser.msPointer?"MSPointerUp":s.Browser.pointer?"pointerup":"touchend",addDoubleTapListener:function(t,e,n){function o(t){var e;if(s.Browser.pointer?(f.push(t.pointerId),e=f.length):e=t.touches.length,!(e>1)){var n=Date.now(),i=n-(a||n);h=t.touches?t.touches[0]:t,l=i>0&&c>=i,a=n}}function r(t){if(s.Browser.pointer){var n=f.indexOf(t.pointerId);if(-1===n)return;f.splice(n,1)}if(l){if(s.Browser.pointer){var i,o={};for(var r in h)i=h[r],"function"==typeof i?o[r]=i.bind(h):o[r]=i;h=o}h.type="dblclick",e(h),a=null}}var a,h,l=!1,c=250,u="_leaflet_",d=this._touchstart,p=this._touchend,f=[];t[u+d+n]=o,t[u+p+n]=r;var m=s.Browser.pointer?i.documentElement:t;return t.addEventListener(d,o,!1),m.addEventListener(p,r,!1),s.Browser.pointer&&m.addEventListener(s.DomEvent.POINTER_CANCEL,r,!1),this},removeDoubleTapListener:function(t,e){var n="_leaflet_";return t.removeEventListener(this._touchstart,t[n+this._touchstart+e],!1),(s.Browser.pointer?i.documentElement:t).removeEventListener(this._touchend,t[n+this._touchend+e],!1),s.Browser.pointer&&i.documentElement.removeEventListener(s.DomEvent.POINTER_CANCEL,t[n+this._touchend+e],!1),this}}),s.extend(s.DomEvent,{POINTER_DOWN:s.Browser.msPointer?"MSPointerDown":"pointerdown",POINTER_MOVE:s.Browser.msPointer?"MSPointerMove":"pointermove",POINTER_UP:s.Browser.msPointer?"MSPointerUp":"pointerup",POINTER_CANCEL:s.Browser.msPointer?"MSPointerCancel":"pointercancel",_pointers:[],_pointerDocumentListener:!1,addPointerListener:function(t,e,n,i){switch(e){case"touchstart":return this.addPointerListenerStart(t,e,n,i);case"touchend":return this.addPointerListenerEnd(t,e,n,i);case"touchmove":return this.addPointerListenerMove(t,e,n,i);default:throw"Unknown touch event type"}},addPointerListenerStart:function(t,e,n,o){var r="_leaflet_",a=this._pointers,h=function(t){"mouse"!==t.pointerType&&t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&s.DomEvent.preventDefault(t);for(var e=!1,i=0;i<a.length;i++)if(a[i].pointerId===t.pointerId){e=!0;break}e||a.push(t),t.touches=a.slice(),t.changedTouches=[t],n(t)};if(t[r+"touchstart"+o]=h,t.addEventListener(this.POINTER_DOWN,h,!1),!this._pointerDocumentListener){var l=function(t){for(var e=0;e<a.length;e++)if(a[e].pointerId===t.pointerId){a.splice(e,1);break}};i.documentElement.addEventListener(this.POINTER_UP,l,!1),i.documentElement.addEventListener(this.POINTER_CANCEL,l,!1),this._pointerDocumentListener=!0}return this},addPointerListenerMove:function(t,e,n,i){function o(t){if(t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&"mouse"!==t.pointerType||0!==t.buttons){for(var e=0;e<s.length;e++)if(s[e].pointerId===t.pointerId){s[e]=t;break}t.touches=s.slice(),t.changedTouches=[t],n(t)}}var r="_leaflet_",s=this._pointers;return t[r+"touchmove"+i]=o,t.addEventListener(this.POINTER_MOVE,o,!1),this},addPointerListenerEnd:function(t,e,n,i){var o="_leaflet_",r=this._pointers,s=function(t){for(var e=0;e<r.length;e++)if(r[e].pointerId===t.pointerId){r.splice(e,1);break}t.touches=r.slice(),t.changedTouches=[t],n(t)};return t[o+"touchend"+i]=s,t.addEventListener(this.POINTER_UP,s,!1),t.addEventListener(this.POINTER_CANCEL,s,!1),this},removePointerListener:function(t,e,n){var i="_leaflet_",o=t[i+e+n];switch(e){case"touchstart":t.removeEventListener(this.POINTER_DOWN,o,!1);break;case"touchmove":t.removeEventListener(this.POINTER_MOVE,o,!1);break;case"touchend":t.removeEventListener(this.POINTER_UP,o,!1),t.removeEventListener(this.POINTER_CANCEL,o,!1)}return this}}),s.Map.mergeOptions({touchZoom:s.Browser.touch&&!s.Browser.android23,bounceAtZoomLimits:!0}),s.Map.TouchZoom=s.Handler.extend({addHooks:function(){s.DomEvent.on(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){s.DomEvent.off(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var e=this._map;if(t.touches&&2===t.touches.length&&!e._animatingZoom&&!this._zooming){var n=e.mouseEventToLayerPoint(t.touches[0]),o=e.mouseEventToLayerPoint(t.touches[1]),r=e._getCenterLayerPoint();this._startCenter=n.add(o)._divideBy(2),this._startDist=n.distanceTo(o),this._moved=!1,this._zooming=!0,this._centerOffset=r.subtract(this._startCenter),e._panAnim&&e._panAnim.stop(),s.DomEvent.on(i,"touchmove",this._onTouchMove,this).on(i,"touchend",this._onTouchEnd,this),s.DomEvent.preventDefault(t)}},_onTouchMove:function(t){var e=this._map;if(t.touches&&2===t.touches.length&&this._zooming){var n=e.mouseEventToLayerPoint(t.touches[0]),i=e.mouseEventToLayerPoint(t.touches[1]);this._scale=n.distanceTo(i)/this._startDist,this._delta=n._add(i)._divideBy(2)._subtract(this._startCenter),1!==this._scale&&(e.options.bounceAtZoomLimits||!(e.getZoom()===e.getMinZoom()&&this._scale<1||e.getZoom()===e.getMaxZoom()&&this._scale>1))&&(this._moved||(s.DomUtil.addClass(e._mapPane,"leaflet-touching"),e.fire("movestart").fire("zoomstart"),this._moved=!0),s.Util.cancelAnimFrame(this._animRequest),this._animRequest=s.Util.requestAnimFrame(this._updateOnMove,this,!0,this._map._container),s.DomEvent.preventDefault(t))}},_updateOnMove:function(){var t=this._map,e=this._getScaleOrigin(),n=t.layerPointToLatLng(e),i=t.getScaleZoom(this._scale);t._animateZoom(n,i,this._startCenter,this._scale,this._delta,!1,!0)},_onTouchEnd:function(){if(!this._moved||!this._zooming)return void(this._zooming=!1);var t=this._map;this._zooming=!1,s.DomUtil.removeClass(t._mapPane,"leaflet-touching"),s.Util.cancelAnimFrame(this._animRequest),s.DomEvent.off(i,"touchmove",this._onTouchMove).off(i,"touchend",this._onTouchEnd);var e=this._getScaleOrigin(),n=t.layerPointToLatLng(e),o=t.getZoom(),r=t.getScaleZoom(this._scale)-o,a=r>0?Math.ceil(r):Math.floor(r),h=t._limitZoom(o+a),l=t.getZoomScale(h)/this._scale;t._animateZoom(n,h,e,l)},_getScaleOrigin:function(){var t=this._centerOffset.subtract(this._delta).divideBy(this._scale);return this._startCenter.add(t)}}),s.Map.addInitHook("addHandler","touchZoom",s.Map.TouchZoom),s.Map.mergeOptions({tap:!0,tapTolerance:15}),s.Map.Tap=s.Handler.extend({addHooks:function(){s.DomEvent.on(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){s.DomEvent.off(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(t.touches){if(s.DomEvent.preventDefault(t),this._fireClick=!0,t.touches.length>1)return this._fireClick=!1,void clearTimeout(this._holdTimeout);var e=t.touches[0],n=e.target;this._startPos=this._newPos=new s.Point(e.clientX,e.clientY),n.tagName&&"a"===n.tagName.toLowerCase()&&s.DomUtil.addClass(n,"leaflet-active"),this._holdTimeout=setTimeout(s.bind(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",e))},this),1e3),s.DomEvent.on(i,"touchmove",this._onMove,this).on(i,"touchend",this._onUp,this)}},_onUp:function(t){if(clearTimeout(this._holdTimeout),s.DomEvent.off(i,"touchmove",this._onMove,this).off(i,"touchend",this._onUp,this),this._fireClick&&t&&t.changedTouches){var e=t.changedTouches[0],n=e.target;n&&n.tagName&&"a"===n.tagName.toLowerCase()&&s.DomUtil.removeClass(n,"leaflet-active"),this._isTapValid()&&this._simulateEvent("click",e)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(t){var e=t.touches[0];this._newPos=new s.Point(e.clientX,e.clientY)},_simulateEvent:function(t,n){var o=i.createEvent("MouseEvents");o._simulated=!0,n.target._simulatedClick=!0,o.initMouseEvent(t,!0,!0,e,1,n.screenX,n.screenY,n.clientX,n.clientY,!1,!1,!1,!1,0,null),n.target.dispatchEvent(o)}}),s.Browser.touch&&!s.Browser.pointer&&s.Map.addInitHook("addHandler","tap",s.Map.Tap),s.Map.mergeOptions({boxZoom:!0}),s.Map.BoxZoom=s.Handler.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane,this._moved=!1},addHooks:function(){s.DomEvent.on(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){s.DomEvent.off(this._container,"mousedown",this._onMouseDown),this._moved=!1},moved:function(){return this._moved},_onMouseDown:function(t){return this._moved=!1,!t.shiftKey||1!==t.which&&1!==t.button?!1:(s.DomUtil.disableTextSelection(),s.DomUtil.disableImageDrag(),this._startLayerPoint=this._map.mouseEventToLayerPoint(t),void s.DomEvent.on(i,"mousemove",this._onMouseMove,this).on(i,"mouseup",this._onMouseUp,this).on(i,"keydown",this._onKeyDown,this))},_onMouseMove:function(t){this._moved||(this._box=s.DomUtil.create("div","leaflet-zoom-box",this._pane),s.DomUtil.setPosition(this._box,this._startLayerPoint),this._container.style.cursor="crosshair",this._map.fire("boxzoomstart"));var e=this._startLayerPoint,n=this._box,i=this._map.mouseEventToLayerPoint(t),o=i.subtract(e),r=new s.Point(Math.min(i.x,e.x),Math.min(i.y,e.y));s.DomUtil.setPosition(n,r),this._moved=!0,n.style.width=Math.max(0,Math.abs(o.x)-4)+"px",n.style.height=Math.max(0,Math.abs(o.y)-4)+"px"},_finish:function(){this._moved&&(this._pane.removeChild(this._box),this._container.style.cursor=""),s.DomUtil.enableTextSelection(),s.DomUtil.enableImageDrag(),s.DomEvent.off(i,"mousemove",this._onMouseMove).off(i,"mouseup",this._onMouseUp).off(i,"keydown",this._onKeyDown)},_onMouseUp:function(t){this._finish();var e=this._map,n=e.mouseEventToLayerPoint(t);if(!this._startLayerPoint.equals(n)){var i=new s.LatLngBounds(e.layerPointToLatLng(this._startLayerPoint),e.layerPointToLatLng(n));e.fitBounds(i),e.fire("boxzoomend",{boxZoomBounds:i})}},_onKeyDown:function(t){27===t.keyCode&&this._finish()}}),s.Map.addInitHook("addHandler","boxZoom",s.Map.BoxZoom),s.Map.mergeOptions({keyboard:!0,keyboardPanOffset:80,keyboardZoomOffset:1}),s.Map.Keyboard=s.Handler.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,173]},initialize:function(t){this._map=t,this._setPanOffset(t.options.keyboardPanOffset),this._setZoomOffset(t.options.keyboardZoomOffset)},addHooks:function(){var t=this._map._container;-1===t.tabIndex&&(t.tabIndex="0"),s.DomEvent.on(t,"focus",this._onFocus,this).on(t,"blur",this._onBlur,this).on(t,"mousedown",this._onMouseDown,this),this._map.on("focus",this._addHooks,this).on("blur",this._removeHooks,this)},removeHooks:function(){this._removeHooks();var t=this._map._container;s.DomEvent.off(t,"focus",this._onFocus,this).off(t,"blur",this._onBlur,this).off(t,"mousedown",this._onMouseDown,this),this._map.off("focus",this._addHooks,this).off("blur",this._removeHooks,this)},_onMouseDown:function(){if(!this._focused){var t=i.body,n=i.documentElement,o=t.scrollTop||n.scrollTop,r=t.scrollLeft||n.scrollLeft;this._map._container.focus(),e.scrollTo(r,o)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanOffset:function(t){var e,n,i=this._panKeys={},o=this.keyCodes;for(e=0,n=o.left.length;n>e;e++)i[o.left[e]]=[-1*t,0];for(e=0,n=o.right.length;n>e;e++)i[o.right[e]]=[t,0];for(e=0,n=o.down.length;n>e;e++)i[o.down[e]]=[0,t];for(e=0,n=o.up.length;n>e;e++)i[o.up[e]]=[0,-1*t]},_setZoomOffset:function(t){var e,n,i=this._zoomKeys={},o=this.keyCodes;for(e=0,n=o.zoomIn.length;n>e;e++)i[o.zoomIn[e]]=t;for(e=0,n=o.zoomOut.length;n>e;e++)i[o.zoomOut[e]]=-t},_addHooks:function(){s.DomEvent.on(i,"keydown",this._onKeyDown,this)},_removeHooks:function(){s.DomEvent.off(i,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){var e=t.keyCode,n=this._map;if(e in this._panKeys){if(n._panAnim&&n._panAnim._inProgress)return;n.panBy(this._panKeys[e]),n.options.maxBounds&&n.panInsideBounds(n.options.maxBounds)}else{if(!(e in this._zoomKeys))return;n.setZoom(n.getZoom()+this._zoomKeys[e])}s.DomEvent.stop(t)}}),s.Map.addInitHook("addHandler","keyboard",s.Map.Keyboard),s.Handler.MarkerDrag=s.Handler.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new s.Draggable(t,t)),this._draggable.on("dragstart",this._onDragStart,this).on("drag",this._onDrag,this).on("dragend",this._onDragEnd,this),this._draggable.enable(),s.DomUtil.addClass(this._marker._icon,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off("dragstart",this._onDragStart,this).off("drag",this._onDrag,this).off("dragend",this._onDragEnd,this),this._draggable.disable(),s.DomUtil.removeClass(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){this._marker.closePopup().fire("movestart").fire("dragstart")},_onDrag:function(){var t=this._marker,e=t._shadow,n=s.DomUtil.getPosition(t._icon),i=t._map.layerPointToLatLng(n);e&&s.DomUtil.setPosition(e,n),t._latlng=i,t.fire("move",{latlng:i}).fire("drag")},_onDragEnd:function(t){this._marker.fire("moveend").fire("dragend",t)}}),s.Control=s.Class.extend({options:{position:"topright"},initialize:function(t){s.setOptions(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var e=this._map;return e&&e.removeControl(this),this.options.position=t,e&&e.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this._map=t;var e=this._container=this.onAdd(t),n=this.getPosition(),i=t._controlCorners[n];return s.DomUtil.addClass(e,"leaflet-control"),-1!==n.indexOf("bottom")?i.insertBefore(e,i.firstChild):i.appendChild(e),this},removeFrom:function(t){var e=this.getPosition(),n=t._controlCorners[e];return n.removeChild(this._container),this._map=null,this.onRemove&&this.onRemove(t),this},_refocusOnMap:function(){this._map&&this._map.getContainer().focus()}}),s.control=function(t){return new s.Control(t)},s.Map.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.removeFrom(this),this},_initControlPos:function(){function t(t,o){var r=n+t+" "+n+o;e[t+o]=s.DomUtil.create("div",r,i)}var e=this._controlCorners={},n="leaflet-",i=this._controlContainer=s.DomUtil.create("div",n+"control-container",this._container);t("top","left"),t("top","right"),t("bottom","left"),t("bottom","right")},_clearControlPos:function(){this._container.removeChild(this._controlContainer)}}),s.Control.Zoom=s.Control.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"-",zoomOutTitle:"Zoom out"},onAdd:function(t){var e="leaflet-control-zoom",n=s.DomUtil.create("div",e+" leaflet-bar");return this._map=t,this._zoomInButton=this._createButton(this.options.zoomInText,this.options.zoomInTitle,e+"-in",n,this._zoomIn,this),this._zoomOutButton=this._createButton(this.options.zoomOutText,this.options.zoomOutTitle,e+"-out",n,this._zoomOut,this),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),n},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},_zoomIn:function(t){this._map.zoomIn(t.shiftKey?3:1)},_zoomOut:function(t){this._map.zoomOut(t.shiftKey?3:1)},_createButton:function(t,e,n,i,o,r){var a=s.DomUtil.create("a",n,i);a.innerHTML=t,a.href="#",a.title=e;var h=s.DomEvent.stopPropagation;return s.DomEvent.on(a,"click",h).on(a,"mousedown",h).on(a,"dblclick",h).on(a,"click",s.DomEvent.preventDefault).on(a,"click",o,r).on(a,"click",this._refocusOnMap,r),a},_updateDisabled:function(){var t=this._map,e="leaflet-disabled";s.DomUtil.removeClass(this._zoomInButton,e),s.DomUtil.removeClass(this._zoomOutButton,e),t._zoom===t.getMinZoom()&&s.DomUtil.addClass(this._zoomOutButton,e),t._zoom===t.getMaxZoom()&&s.DomUtil.addClass(this._zoomInButton,e)}}),s.Map.mergeOptions({zoomControl:!0}),s.Map.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new s.Control.Zoom,this.addControl(this.zoomControl))}),s.control.zoom=function(t){return new s.Control.Zoom(t)},s.Control.Attribution=s.Control.extend({options:{position:"bottomright",prefix:'<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(t){s.setOptions(this,t),this._attributions={}},onAdd:function(t){this._container=s.DomUtil.create("div","leaflet-control-attribution"),s.DomEvent.disableClickPropagation(this._container);for(var e in t._layers)t._layers[e].getAttribution&&this.addAttribution(t._layers[e].getAttribution());return t.on("layeradd",this._onLayerAdd,this).on("layerremove",this._onLayerRemove,this),this._update(),this._container},onRemove:function(t){t.off("layeradd",this._onLayerAdd).off("layerremove",this._onLayerRemove)},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t?(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update(),this):void 0},removeAttribution:function(t){return t?(this._attributions[t]&&(this._attributions[t]--,this._update()),this):void 0},_update:function(){if(this._map){var t=[];for(var e in this._attributions)this._attributions[e]&&t.push(e);var n=[];this.options.prefix&&n.push(this.options.prefix),t.length&&n.push(t.join(", ")),this._container.innerHTML=n.join(" | ")}},_onLayerAdd:function(t){t.layer.getAttribution&&this.addAttribution(t.layer.getAttribution())},_onLayerRemove:function(t){t.layer.getAttribution&&this.removeAttribution(t.layer.getAttribution())}}),s.Map.mergeOptions({attributionControl:!0}),s.Map.addInitHook(function(){this.options.attributionControl&&(this.attributionControl=(new s.Control.Attribution).addTo(this))}),s.control.attribution=function(t){return new s.Control.Attribution(t)},s.Control.Scale=s.Control.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0,updateWhenIdle:!1},onAdd:function(t){this._map=t;var e="leaflet-control-scale",n=s.DomUtil.create("div",e),i=this.options;return this._addScales(i,e,n),t.on(i.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),n},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,e,n){t.metric&&(this._mScale=s.DomUtil.create("div",e+"-line",n)),t.imperial&&(this._iScale=s.DomUtil.create("div",e+"-line",n))},_update:function(){var t=this._map.getBounds(),e=t.getCenter().lat,n=6378137*Math.PI*Math.cos(e*Math.PI/180),i=n*(t.getNorthEast().lng-t.getSouthWest().lng)/180,o=this._map.getSize(),r=this.options,s=0;o.x>0&&(s=i*(r.maxWidth/o.x)),this._updateScales(r,s)},_updateScales:function(t,e){t.metric&&e&&this._updateMetric(e),t.imperial&&e&&this._updateImperial(e)},_updateMetric:function(t){var e=this._getRoundNum(t);this._mScale.style.width=this._getScaleWidth(e/t)+"px",this._mScale.innerHTML=1e3>e?e+" m":e/1e3+" km"},_updateImperial:function(t){var e,n,i,o=3.2808399*t,r=this._iScale;o>5280?(e=o/5280,n=this._getRoundNum(e),r.style.width=this._getScaleWidth(n/e)+"px",r.innerHTML=n+" mi"):(i=this._getRoundNum(o),r.style.width=this._getScaleWidth(i/o)+"px",r.innerHTML=i+" ft");
},_getScaleWidth:function(t){return Math.round(this.options.maxWidth*t)-10},_getRoundNum:function(t){var e=Math.pow(10,(Math.floor(t)+"").length-1),n=t/e;return n=n>=10?10:n>=5?5:n>=3?3:n>=2?2:1,e*n}}),s.control.scale=function(t){return new s.Control.Scale(t)},s.Control.Layers=s.Control.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0},initialize:function(t,e,n){s.setOptions(this,n),this._layers={},this._lastZIndex=0,this._handlingClick=!1;for(var i in t)this._addLayer(t[i],i);for(i in e)this._addLayer(e[i],i,!0)},onAdd:function(t){return this._initLayout(),this._update(),t.on("layeradd",this._onLayerChange,this).on("layerremove",this._onLayerChange,this),this._container},onRemove:function(t){t.off("layeradd",this._onLayerChange,this).off("layerremove",this._onLayerChange,this)},addBaseLayer:function(t,e){return this._addLayer(t,e),this._update(),this},addOverlay:function(t,e){return this._addLayer(t,e,!0),this._update(),this},removeLayer:function(t){var e=s.stamp(t);return delete this._layers[e],this._update(),this},_initLayout:function(){var t="leaflet-control-layers",e=this._container=s.DomUtil.create("div",t);e.setAttribute("aria-haspopup",!0),s.Browser.touch?s.DomEvent.on(e,"click",s.DomEvent.stopPropagation):s.DomEvent.disableClickPropagation(e).disableScrollPropagation(e);var n=this._form=s.DomUtil.create("form",t+"-list");if(this.options.collapsed){s.Browser.android||s.DomEvent.on(e,"mouseover",this._expand,this).on(e,"mouseout",this._collapse,this);var i=this._layersLink=s.DomUtil.create("a",t+"-toggle",e);i.href="#",i.title="Layers",s.Browser.touch?s.DomEvent.on(i,"click",s.DomEvent.stop).on(i,"click",this._expand,this):s.DomEvent.on(i,"focus",this._expand,this),s.DomEvent.on(n,"click",function(){setTimeout(s.bind(this._onInputClick,this),0)},this),this._map.on("click",this._collapse,this)}else this._expand();this._baseLayersList=s.DomUtil.create("div",t+"-base",n),this._separator=s.DomUtil.create("div",t+"-separator",n),this._overlaysList=s.DomUtil.create("div",t+"-overlays",n),e.appendChild(n)},_addLayer:function(t,e,n){var i=s.stamp(t);this._layers[i]={layer:t,name:e,overlay:n},this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex))},_update:function(){if(this._container){this._baseLayersList.innerHTML="",this._overlaysList.innerHTML="";var t,e,n=!1,i=!1;for(t in this._layers)e=this._layers[t],this._addItem(e),i=i||e.overlay,n=n||!e.overlay;this._separator.style.display=i&&n?"":"none"}},_onLayerChange:function(t){var e=this._layers[s.stamp(t.layer)];if(e){this._handlingClick||this._update();var n=e.overlay?"layeradd"===t.type?"overlayadd":"overlayremove":"layeradd"===t.type?"baselayerchange":null;n&&this._map.fire(n,e)}},_createRadioElement:function(t,e){var n='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"';e&&(n+=' checked="checked"'),n+="/>";var o=i.createElement("div");return o.innerHTML=n,o.firstChild},_addItem:function(t){var e,n=i.createElement("label"),o=this._map.hasLayer(t.layer);t.overlay?(e=i.createElement("input"),e.type="checkbox",e.className="leaflet-control-layers-selector",e.defaultChecked=o):e=this._createRadioElement("leaflet-base-layers",o),e.layerId=s.stamp(t.layer),s.DomEvent.on(e,"click",this._onInputClick,this);var r=i.createElement("span");r.innerHTML=" "+t.name,n.appendChild(e),n.appendChild(r);var a=t.overlay?this._overlaysList:this._baseLayersList;return a.appendChild(n),n},_onInputClick:function(){var t,e,n,i=this._form.getElementsByTagName("input"),o=i.length;for(this._handlingClick=!0,t=0;o>t;t++)e=i[t],n=this._layers[e.layerId],e.checked&&!this._map.hasLayer(n.layer)?this._map.addLayer(n.layer):!e.checked&&this._map.hasLayer(n.layer)&&this._map.removeLayer(n.layer);this._handlingClick=!1,this._refocusOnMap()},_expand:function(){s.DomUtil.addClass(this._container,"leaflet-control-layers-expanded")},_collapse:function(){this._container.className=this._container.className.replace(" leaflet-control-layers-expanded","")}}),s.control.layers=function(t,e,n){return new s.Control.Layers(t,e,n)},s.PosAnimation=s.Class.extend({includes:s.Mixin.Events,run:function(t,e,n,i){this.stop(),this._el=t,this._inProgress=!0,this._newPos=e,this.fire("start"),t.style[s.DomUtil.TRANSITION]="all "+(n||.25)+"s cubic-bezier(0,0,"+(i||.5)+",1)",s.DomEvent.on(t,s.DomUtil.TRANSITION_END,this._onTransitionEnd,this),s.DomUtil.setPosition(t,e),s.Util.falseFn(t.offsetWidth),this._stepTimer=setInterval(s.bind(this._onStep,this),50)},stop:function(){this._inProgress&&(s.DomUtil.setPosition(this._el,this._getPos()),this._onTransitionEnd(),s.Util.falseFn(this._el.offsetWidth))},_onStep:function(){var t=this._getPos();return t?(this._el._leaflet_pos=t,void this.fire("step")):void this._onTransitionEnd()},_transformRe:/([-+]?(?:\d*\.)?\d+)\D*, ([-+]?(?:\d*\.)?\d+)\D*\)/,_getPos:function(){var t,n,i,o=this._el,r=e.getComputedStyle(o);if(s.Browser.any3d){if(i=r[s.DomUtil.TRANSFORM].match(this._transformRe),!i)return;t=parseFloat(i[1]),n=parseFloat(i[2])}else t=parseFloat(r.left),n=parseFloat(r.top);return new s.Point(t,n,!0)},_onTransitionEnd:function(){s.DomEvent.off(this._el,s.DomUtil.TRANSITION_END,this._onTransitionEnd,this),this._inProgress&&(this._inProgress=!1,this._el.style[s.DomUtil.TRANSITION]="",this._el._leaflet_pos=this._newPos,clearInterval(this._stepTimer),this.fire("step").fire("end"))}}),s.Map.include({setView:function(t,e,n){if(e=e===o?this._zoom:this._limitZoom(e),t=this._limitCenter(s.latLng(t),e,this.options.maxBounds),n=n||{},this._panAnim&&this._panAnim.stop(),this._loaded&&!n.reset&&n!==!0){n.animate!==o&&(n.zoom=s.extend({animate:n.animate},n.zoom),n.pan=s.extend({animate:n.animate},n.pan));var i=this._zoom!==e?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,e,n.zoom):this._tryAnimatedPan(t,n.pan);if(i)return clearTimeout(this._sizeTimer),this}return this._resetView(t,e),this},panBy:function(t,e){if(t=s.point(t).round(),e=e||{},!t.x&&!t.y)return this;if(this._panAnim||(this._panAnim=new s.PosAnimation,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),e.noMoveStart||this.fire("movestart"),e.animate!==!1){s.DomUtil.addClass(this._mapPane,"leaflet-pan-anim");var n=this._getMapPanePos().subtract(t);this._panAnim.run(this._mapPane,n,e.duration||.25,e.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){s.DomUtil.removeClass(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,e){var n=this._getCenterOffset(t)._floor();return(e&&e.animate)===!0||this.getSize().contains(n)?(this.panBy(n,e),!0):!1}}),s.PosAnimation=s.DomUtil.TRANSITION?s.PosAnimation:s.PosAnimation.extend({run:function(t,e,n,i){this.stop(),this._el=t,this._inProgress=!0,this._duration=n||.25,this._easeOutPower=1/Math.max(i||.5,.2),this._startPos=s.DomUtil.getPosition(t),this._offset=e.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(),this._complete())},_animate:function(){this._animId=s.Util.requestAnimFrame(this._animate,this),this._step()},_step:function(){var t=+new Date-this._startTime,e=1e3*this._duration;e>t?this._runFrame(this._easeOut(t/e)):(this._runFrame(1),this._complete())},_runFrame:function(t){var e=this._startPos.add(this._offset.multiplyBy(t));s.DomUtil.setPosition(this._el,e),this.fire("step")},_complete:function(){s.Util.cancelAnimFrame(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),s.Map.mergeOptions({zoomAnimation:!0,zoomAnimationThreshold:4}),s.DomUtil.TRANSITION&&s.Map.addInitHook(function(){this._zoomAnimated=this.options.zoomAnimation&&s.DomUtil.TRANSITION&&s.Browser.any3d&&!s.Browser.android23&&!s.Browser.mobileOpera,this._zoomAnimated&&s.DomEvent.on(this._mapPane,s.DomUtil.TRANSITION_END,this._catchTransitionEnd,this)}),s.Map.include(s.DomUtil.TRANSITION?{_catchTransitionEnd:function(t){this._animatingZoom&&t.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,e,n){if(this._animatingZoom)return!0;if(n=n||{},!this._zoomAnimated||n.animate===!1||this._nothingToAnimate()||Math.abs(e-this._zoom)>this.options.zoomAnimationThreshold)return!1;var i=this.getZoomScale(e),o=this._getCenterOffset(t)._divideBy(1-1/i),r=this._getCenterLayerPoint()._add(o);return n.animate===!0||this.getSize().contains(o)?(this.fire("movestart").fire("zoomstart"),this._animateZoom(t,e,r,i,null,!0),!0):!1},_animateZoom:function(t,e,n,i,o,r,a){a||(this._animatingZoom=!0),s.DomUtil.addClass(this._mapPane,"leaflet-zoom-anim"),this._animateToCenter=t,this._animateToZoom=e,s.Draggable&&(s.Draggable._disabled=!0),s.Util.requestAnimFrame(function(){this.fire("zoomanim",{center:t,zoom:e,origin:n,scale:i,delta:o,backwards:r}),setTimeout(s.bind(this._onZoomTransitionEnd,this),250)},this)},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._animatingZoom=!1,s.DomUtil.removeClass(this._mapPane,"leaflet-zoom-anim"),s.Util.requestAnimFrame(function(){this._resetView(this._animateToCenter,this._animateToZoom,!0,!0),s.Draggable&&(s.Draggable._disabled=!1)},this))}}:{}),s.TileLayer.include({_animateZoom:function(t){this._animating||(this._animating=!0,this._prepareBgBuffer());var e=this._bgBuffer,n=s.DomUtil.TRANSFORM,i=t.delta?s.DomUtil.getTranslateString(t.delta):e.style[n],o=s.DomUtil.getScaleString(t.scale,t.origin);e.style[n]=t.backwards?o+" "+i:i+" "+o},_endZoomAnim:function(){var t=this._tileContainer,e=this._bgBuffer;t.style.visibility="",t.parentNode.appendChild(t),s.Util.falseFn(e.offsetWidth);var n=this._map.getZoom();(n>this.options.maxZoom||n<this.options.minZoom)&&this._clearBgBuffer(),this._animating=!1},_clearBgBuffer:function(){var t=this._map;!t||t._animatingZoom||t.touchZoom._zooming||(this._bgBuffer.innerHTML="",this._bgBuffer.style[s.DomUtil.TRANSFORM]="")},_prepareBgBuffer:function(){var t=this._tileContainer,e=this._bgBuffer,n=this._getLoadedTilesPercentage(e),i=this._getLoadedTilesPercentage(t);return e&&n>.5&&.5>i?(t.style.visibility="hidden",void this._stopLoadingImages(t)):(e.style.visibility="hidden",e.style[s.DomUtil.TRANSFORM]="",this._tileContainer=e,e=this._bgBuffer=t,this._stopLoadingImages(e),void clearTimeout(this._clearBgBufferTimer))},_getLoadedTilesPercentage:function(t){var e,n,i=t.getElementsByTagName("img"),o=0;for(e=0,n=i.length;n>e;e++)i[e].complete&&o++;return o/n},_stopLoadingImages:function(t){var e,n,i,o=Array.prototype.slice.call(t.getElementsByTagName("img"));for(e=0,n=o.length;n>e;e++)i=o[e],i.complete||(i.onload=s.Util.falseFn,i.onerror=s.Util.falseFn,i.src=s.Util.emptyImageUrl,i.parentNode.removeChild(i))}}),s.Map.include({_defaultLocateOptions:{watch:!1,setView:!1,maxZoom:1/0,timeout:1e4,maximumAge:0,enableHighAccuracy:!1},locate:function(t){if(t=this._locateOptions=s.extend(this._defaultLocateOptions,t),!navigator.geolocation)return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var e=s.bind(this._handleGeolocationResponse,this),n=s.bind(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(e,n,t):navigator.geolocation.getCurrentPosition(e,n,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){var e=t.code,n=t.message||(1===e?"permission denied":2===e?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:e,message:"Geolocation error: "+n+"."})},_handleGeolocationResponse:function(t){var e=t.coords.latitude,n=t.coords.longitude,i=new s.LatLng(e,n),o=180*t.coords.accuracy/40075017,r=o/Math.cos(s.LatLng.DEG_TO_RAD*e),a=s.latLngBounds([e-o,n-r],[e+o,n+r]),h=this._locateOptions;if(h.setView){var l=Math.min(this.getBoundsZoom(a),h.maxZoom);this.setView(i,l)}var c={latlng:i,bounds:a,timestamp:t.timestamp};for(var u in t.coords)"number"==typeof t.coords[u]&&(c[u]=t.coords[u]);this.fire("locationfound",c)}})}(window,document)},{}],29:[function(t,e,n){function i(t){var e=!1;return function(){return e?void 0:(e=!0,t.apply(this,arguments))}}e.exports=i,i.proto=i(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return i(this)},configurable:!0})})},{}],30:[function(t,e,n){var i=t("trim"),o=t("for-each"),r=function(t){return"[object Array]"===Object.prototype.toString.call(t)};e.exports=function(t){if(!t)return{};var e={};return o(i(t).split("\n"),function(t){var n=t.indexOf(":"),o=i(t.slice(0,n)).toLowerCase(),s=i(t.slice(n+1));"undefined"==typeof e[o]?e[o]=s:r(e[o])?e[o].push(s):e[o]=[e[o],s]}),e}},{"for-each":15,trim:55}],31:[function(e,n,i){(function(e){!function(o){function r(t){throw RangeError(O[t])}function s(t,e){for(var n=t.length;n--;)t[n]=e(t[n]);return t}function a(t,e){return s(t.split(A),e).join(".")}function h(t){for(var e,n,i=[],o=0,r=t.length;r>o;)e=t.charCodeAt(o++),e>=55296&&56319>=e&&r>o?(n=t.charCodeAt(o++),56320==(64512&n)?i.push(((1023&e)<<10)+(1023&n)+65536):(i.push(e),o--)):i.push(e);return i}function l(t){return s(t,function(t){var e="";return t>65535&&(t-=65536,e+=N(t>>>10&1023|55296),t=56320|1023&t),e+=N(t)}).join("")}function c(t){return 10>t-48?t-22:26>t-65?t-65:26>t-97?t-97:E}function u(t,e){return t+22+75*(26>t)-((0!=e)<<5)}function d(t,e,n){var i=0;for(t=n?U(t/C):t>>1,t+=U(t/e);t>R*P>>1;i+=E)t=U(t/R);return U(i+(R+1)*t/(t+T))}function p(t){var e,n,i,o,s,a,h,u,p,f,m=[],_=t.length,g=0,v=k,y=M;for(n=t.lastIndexOf(S),0>n&&(n=0),i=0;n>i;++i)t.charCodeAt(i)>=128&&r("not-basic"),m.push(t.charCodeAt(i));for(o=n>0?n+1:0;_>o;){for(s=g,a=1,h=E;o>=_&&r("invalid-input"),u=c(t.charCodeAt(o++)),(u>=E||u>U((w-g)/a))&&r("overflow"),g+=u*a,p=y>=h?x:h>=y+P?P:h-y,!(p>u);h+=E)f=E-p,a>U(w/f)&&r("overflow"),a*=f;e=m.length+1,y=d(g-s,e,0==s),U(g/e)>w-v&&r("overflow"),v+=U(g/e),g%=e,m.splice(g++,0,v)}return l(m)}function f(t){var e,n,i,o,s,a,l,c,p,f,m,_,g,v,y,L=[];for(t=h(t),_=t.length,e=k,n=0,s=M,a=0;_>a;++a)m=t[a],128>m&&L.push(N(m));for(i=o=L.length,o&&L.push(S);_>i;){for(l=w,a=0;_>a;++a)m=t[a],m>=e&&l>m&&(l=m);for(g=i+1,l-e>U((w-n)/g)&&r("overflow"),n+=(l-e)*g,e=l,a=0;_>a;++a)if(m=t[a],e>m&&++n>w&&r("overflow"),m==e){for(c=n,p=E;f=s>=p?x:p>=s+P?P:p-s,!(f>c);p+=E)y=c-f,v=E-f,L.push(N(u(f+y%v,0))),c=U(y/v);L.push(N(u(c,0))),s=d(n,g,i==o),n=0,++i}++n,++e}return L.join("")}function m(t){return a(t,function(t){return D.test(t)?p(t.slice(4).toLowerCase()):t})}function _(t){return a(t,function(t){return I.test(t)?"xn--"+f(t):t})}var g="object"==typeof i&&i,v="object"==typeof n&&n&&n.exports==g&&n,y="object"==typeof e&&e;(y.global===y||y.window===y)&&(o=y);var L,b,w=2147483647,E=36,x=1,P=26,T=38,C=700,M=72,k=128,S="-",D=/^xn--/,I=/[^ -~]/,A=/\x2E|\u3002|\uFF0E|\uFF61/g,O={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},R=E-x,U=Math.floor,N=String.fromCharCode;if(L={version:"1.2.4",ucs2:{decode:h,encode:l},decode:p,encode:f,toASCII:_,toUnicode:m},"function"==typeof t&&"object"==typeof t.amd&&t.amd)t("punycode",function(){return L});else if(g&&!g.nodeType)if(v)v.exports=L;else for(b in L)L.hasOwnProperty(b)&&(g[b]=L[b]);else o.punycode=L}(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],32:[function(t,e,n){"use strict";var i=t("strict-uri-encode");n.extract=function(t){return t.split("?")[1]||""},n.parse=function(t){return"string"!=typeof t?{}:(t=t.trim().replace(/^(\?|#|&)/,""),t?t.split("&").reduce(function(t,e){var n=e.replace(/\+/g," ").split("="),i=n.shift(),o=n.length>0?n.join("="):void 0;return i=decodeURIComponent(i),o=void 0===o?null:decodeURIComponent(o),t.hasOwnProperty(i)?Array.isArray(t[i])?t[i].push(o):t[i]=[t[i],o]:t[i]=o,t},{}):{})},n.stringify=function(t){return t?Object.keys(t).sort().map(function(e){var n=t[e];return Array.isArray(n)?n.sort().map(function(t){return i(e)+"="+i(t)}).join("&"):i(e)+"="+i(n)}).filter(function(t){return t.length>0}).join("&"):""}},{"strict-uri-encode":50}],33:[function(t,e,n){"use strict";function i(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.exports=function(t,e,n,r){e=e||"&",n=n||"=";var s={};if("string"!=typeof t||0===t.length)return s;var a=/\+/g;t=t.split(e);var h=1e3;r&&"number"==typeof r.maxKeys&&(h=r.maxKeys);var l=t.length;h>0&&l>h&&(l=h);for(var c=0;l>c;++c){var u,d,p,f,m=t[c].replace(a,"%20"),_=m.indexOf(n);_>=0?(u=m.substr(0,_),d=m.substr(_+1)):(u=m,d=""),p=decodeURIComponent(u),f=decodeURIComponent(d),i(s,p)?o(s[p])?s[p].push(f):s[p]=[s[p],f]:s[p]=f}return s};var o=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},{}],34:[function(t,e,n){"use strict";function i(t,e){if(t.map)return t.map(e);for(var n=[],i=0;i<t.length;i++)n.push(e(t[i],i));return n}var o=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};e.exports=function(t,e,n,a){return e=e||"&",n=n||"=",null===t&&(t=void 0),"object"==typeof t?i(s(t),function(s){var a=encodeURIComponent(o(s))+n;return r(t[s])?i(t[s],function(t){return a+encodeURIComponent(o(t))}).join(e):a+encodeURIComponent(o(t[s]))}).join(e):a?encodeURIComponent(o(a))+n+encodeURIComponent(o(t)):""};var r=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},s=Object.keys||function(t){var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(n);return e}},{}],35:[function(t,e,n){"use strict";n.decode=n.parse=t("./decode"),n.encode=n.stringify=t("./encode")},{"./decode":33,"./encode":34}],36:[function(t,e,n){function i(t){return this instanceof i?(a.call(this),t=t||{},this.concurrency=t.concurrency||1/0,this.timeout=t.timeout||0,this.pending=0,this.session=0,this.running=!1,void(this.jobs=[])):new i(t)}function o(t){function e(t){i.end(t)}function n(o){i.removeListener("error",e),i.removeListener("end",n),t(o)}var i=this;this.on("error",e),this.on("end",n)}function r(t){this.session++,this.running=!1,this.emit("end",t)}var s=t("inherits"),a=t("events").EventEmitter;e.exports=i,s(i,a);var h=["push","unshift","splice","pop","shift","slice","reverse","indexOf","lastIndexOf"];for(var l in h)(function(t){i.prototype[t]=function(){return Array.prototype[t].apply(this.jobs,arguments)}})(h[l]);Object.defineProperty(i.prototype,"length",{get:function(){return this.pending+this.jobs.length}}),i.prototype.start=function(t){function e(t,e){s&&n.session===a&&(s=!1,n.pending--,null!==h&&clearTimeout(h),t?n.emit("error",t,i):l===!1&&n.emit("success",e,i),n.session===a&&(0===n.pending&&0===n.jobs.length?r.call(n):n.running&&n.start()))}if(t&&o.call(this,t),this.pending!==this.concurrency){if(0===this.jobs.length)return void(0===this.pending&&r.call(this));var n=this,i=this.jobs.shift(),s=!0,a=this.session,h=null,l=!1;this.timeout&&(h=setTimeout(function(){l=!0,n.listeners("timeout").length>0?n.emit("timeout",e,i):e()},this.timeout)),this.pending++,this.running=!0,i(e),this.jobs.length>0&&this.start()}},i.prototype.stop=function(){this.running=!1},i.prototype.end=function(t){this.jobs.length=0,this.pending=0,r.call(this,t)}},{events:13,inherits:23}],37:[function(t,e,n){function i(){o.call(this)}e.exports=i;var o=t("events").EventEmitter,r=t("inherits");r(i,o),i.Readable=t("readable-stream/readable.js"),i.Writable=t("readable-stream/writable.js"),i.Duplex=t("readable-stream/duplex.js"),i.Transform=t("readable-stream/transform.js"),i.PassThrough=t("readable-stream/passthrough.js"),i.Stream=i,i.prototype.pipe=function(t,e){function n(e){t.writable&&!1===t.write(e)&&l.pause&&l.pause()}function i(){l.readable&&l.resume&&l.resume()}function r(){c||(c=!0,t.end())}function s(){c||(c=!0,"function"==typeof t.destroy&&t.destroy())}function a(t){if(h(),0===o.listenerCount(this,"error"))throw t}function h(){l.removeListener("data",n),t.removeListener("drain",i),l.removeListener("end",r),l.removeListener("close",s),l.removeListener("error",a),t.removeListener("error",a),l.removeListener("end",h),l.removeListener("close",h),t.removeListener("close",h)}var l=this;l.on("data",n),t.on("drain",i),t._isStdio||e&&e.end===!1||(l.on("end",r),l.on("close",s));var c=!1;return l.on("error",a),t.on("error",a),l.on("end",h),l.on("close",h),t.on("close",h),t.emit("pipe",l),t}},{events:13,inherits:23,"readable-stream/duplex.js":39,"readable-stream/passthrough.js":45,"readable-stream/readable.js":46,"readable-stream/transform.js":47,"readable-stream/writable.js":48}],38:[function(t,e,n){e.exports=Array.isArray||function(t){return"[object Array]"==Object.prototype.toString.call(t)}},{}],39:[function(t,e,n){e.exports=t("./lib/_stream_duplex.js")},{"./lib/_stream_duplex.js":40}],40:[function(t,e,n){(function(n){function i(t){return this instanceof i?(h.call(this,t),l.call(this,t),t&&t.readable===!1&&(this.readable=!1),t&&t.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,t&&t.allowHalfOpen===!1&&(this.allowHalfOpen=!1),void this.once("end",o)):new i(t)}function o(){this.allowHalfOpen||this._writableState.ended||n.nextTick(this.end.bind(this))}function r(t,e){for(var n=0,i=t.length;i>n;n++)e(t[n],n)}e.exports=i;var s=Object.keys||function(t){var e=[];for(var n in t)e.push(n);return e},a=t("core-util-is");a.inherits=t("inherits");var h=t("./_stream_readable"),l=t("./_stream_writable");a.inherits(i,h),r(s(l.prototype),function(t){i.prototype[t]||(i.prototype[t]=l.prototype[t])})}).call(this,t("_process"))},{"./_stream_readable":42,"./_stream_writable":44,_process:7,"core-util-is":9,inherits:23}],41:[function(t,e,n){function i(t){return this instanceof i?void o.call(this,t):new i(t)}e.exports=i;var o=t("./_stream_transform"),r=t("core-util-is");r.inherits=t("inherits"),r.inherits(i,o),i.prototype._transform=function(t,e,n){n(null,t)}},{"./_stream_transform":43,"core-util-is":9,inherits:23}],42:[function(t,e,n){(function(n){function i(e,n){var i=t("./_stream_duplex");e=e||{};var o=e.highWaterMark,r=e.objectMode?16:16384;this.highWaterMark=o||0===o?o:r,this.highWaterMark=~~this.highWaterMark,this.buffer=[],this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.objectMode=!!e.objectMode,n instanceof i&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.defaultEncoding=e.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(M||(M=t("string_decoder/").StringDecoder),this.decoder=new M(e.encoding),this.encoding=e.encoding)}function o(e){t("./_stream_duplex");return this instanceof o?(this._readableState=new i(e,this),this.readable=!0,void T.call(this)):new o(e)}function r(t,e,n,i,o){var r=l(e,n);if(r)t.emit("error",r);else if(C.isNullOrUndefined(n))e.reading=!1,e.ended||c(t,e);else if(e.objectMode||n&&n.length>0)if(e.ended&&!o){var a=new Error("stream.push() after EOF");t.emit("error",a)}else if(e.endEmitted&&o){var a=new Error("stream.unshift() after end event");t.emit("error",a)}else!e.decoder||o||i||(n=e.decoder.write(n)),o||(e.reading=!1),e.flowing&&0===e.length&&!e.sync?(t.emit("data",n),t.read(0)):(e.length+=e.objectMode?1:n.length,o?e.buffer.unshift(n):e.buffer.push(n),e.needReadable&&u(t)),p(t,e);else o||(e.reading=!1);return s(e)}function s(t){return!t.ended&&(t.needReadable||t.length<t.highWaterMark||0===t.length)}function a(t){if(t>=S)t=S;else{t--;for(var e=1;32>e;e<<=1)t|=t>>e;t++}return t}function h(t,e){return 0===e.length&&e.ended?0:e.objectMode?0===t?0:1:isNaN(t)||C.isNull(t)?e.flowing&&e.buffer.length?e.buffer[0].length:e.length:0>=t?0:(t>e.highWaterMark&&(e.highWaterMark=a(t)),t>e.length?e.ended?e.length:(e.needReadable=!0,0):t)}function l(t,e){var n=null;return C.isBuffer(e)||C.isString(e)||C.isNullOrUndefined(e)||t.objectMode||(n=new TypeError("Invalid non-string/buffer chunk")),n}function c(t,e){if(e.decoder&&!e.ended){var n=e.decoder.end();n&&n.length&&(e.buffer.push(n),e.length+=e.objectMode?1:n.length)}e.ended=!0,u(t)}function u(t){var e=t._readableState;e.needReadable=!1,e.emittedReadable||(k("emitReadable",e.flowing),e.emittedReadable=!0,e.sync?n.nextTick(function(){d(t)}):d(t))}function d(t){k("emit readable"),t.emit("readable"),v(t)}function p(t,e){e.readingMore||(e.readingMore=!0,n.nextTick(function(){f(t,e)}))}function f(t,e){for(var n=e.length;!e.reading&&!e.flowing&&!e.ended&&e.length<e.highWaterMark&&(k("maybeReadMore read 0"),t.read(0),n!==e.length);)n=e.length;e.readingMore=!1}function m(t){return function(){var e=t._readableState;k("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&P.listenerCount(t,"data")&&(e.flowing=!0,v(t))}}function _(t,e){e.resumeScheduled||(e.resumeScheduled=!0,n.nextTick(function(){g(t,e)}))}function g(t,e){e.resumeScheduled=!1,t.emit("resume"),v(t),e.flowing&&!e.reading&&t.read(0)}function v(t){var e=t._readableState;if(k("flow",e.flowing),e.flowing)do var n=t.read();while(null!==n&&e.flowing)}function y(t,e){var n,i=e.buffer,o=e.length,r=!!e.decoder,s=!!e.objectMode;if(0===i.length)return null;if(0===o)n=null;else if(s)n=i.shift();else if(!t||t>=o)n=r?i.join(""):x.concat(i,o),i.length=0;else if(t<i[0].length){var a=i[0];n=a.slice(0,t),i[0]=a.slice(t)}else if(t===i[0].length)n=i.shift();else{n=r?"":new x(t);for(var h=0,l=0,c=i.length;c>l&&t>h;l++){var a=i[0],u=Math.min(t-h,a.length);r?n+=a.slice(0,u):a.copy(n,h,0,u),u<a.length?i[0]=a.slice(u):i.shift(),h+=u}}return n}function L(t){var e=t._readableState;if(e.length>0)throw new Error("endReadable called on non-empty stream");e.endEmitted||(e.ended=!0,n.nextTick(function(){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}))}function b(t,e){for(var n=0,i=t.length;i>n;n++)e(t[n],n)}function w(t,e){for(var n=0,i=t.length;i>n;n++)if(t[n]===e)return n;return-1}e.exports=o;var E=t("isarray"),x=t("buffer").Buffer;o.ReadableState=i;var P=t("events").EventEmitter;P.listenerCount||(P.listenerCount=function(t,e){return t.listeners(e).length});var T=t("stream"),C=t("core-util-is");C.inherits=t("inherits");var M,k=t("util");k=k&&k.debuglog?k.debuglog("stream"):function(){},C.inherits(o,T),o.prototype.push=function(t,e){var n=this._readableState;return C.isString(t)&&!n.objectMode&&(e=e||n.defaultEncoding,e!==n.encoding&&(t=new x(t,e),e="")),r(this,n,t,e,!1)},o.prototype.unshift=function(t){var e=this._readableState;return r(this,e,t,"",!0)},o.prototype.setEncoding=function(e){return M||(M=t("string_decoder/").StringDecoder),this._readableState.decoder=new M(e),this._readableState.encoding=e,this};var S=8388608;o.prototype.read=function(t){k("read",t);var e=this._readableState,n=t;if((!C.isNumber(t)||t>0)&&(e.emittedReadable=!1),0===t&&e.needReadable&&(e.length>=e.highWaterMark||e.ended))return k("read: emitReadable",e.length,e.ended),0===e.length&&e.ended?L(this):u(this),null;if(t=h(t,e),0===t&&e.ended)return 0===e.length&&L(this),null;var i=e.needReadable;k("need readable",i),(0===e.length||e.length-t<e.highWaterMark)&&(i=!0,k("length less than watermark",i)),(e.ended||e.reading)&&(i=!1,k("reading or ended",i)),i&&(k("do read"),e.reading=!0,e.sync=!0,0===e.length&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1),i&&!e.reading&&(t=h(n,e));var o;return o=t>0?y(t,e):null,C.isNull(o)&&(e.needReadable=!0,t=0),e.length-=t,0!==e.length||e.ended||(e.needReadable=!0),n!==t&&e.ended&&0===e.length&&L(this),C.isNull(o)||this.emit("data",o),o},o.prototype._read=function(t){this.emit("error",new Error("not implemented"))},o.prototype.pipe=function(t,e){function i(t){k("onunpipe"),t===u&&r()}function o(){k("onend"),t.end()}function r(){k("cleanup"),t.removeListener("close",h),t.removeListener("finish",l),t.removeListener("drain",_),t.removeListener("error",a),t.removeListener("unpipe",i),u.removeListener("end",o),u.removeListener("end",r),u.removeListener("data",s),!d.awaitDrain||t._writableState&&!t._writableState.needDrain||_()}function s(e){k("ondata");var n=t.write(e);!1===n&&(k("false write response, pause",u._readableState.awaitDrain),u._readableState.awaitDrain++,u.pause())}function a(e){k("onerror",e),c(),t.removeListener("error",a),0===P.listenerCount(t,"error")&&t.emit("error",e)}function h(){t.removeListener("finish",l),c()}function l(){k("onfinish"),t.removeListener("close",h),c()}function c(){k("unpipe"),u.unpipe(t)}var u=this,d=this._readableState;switch(d.pipesCount){case 0:d.pipes=t;break;case 1:d.pipes=[d.pipes,t];break;default:d.pipes.push(t)}d.pipesCount+=1,k("pipe count=%d opts=%j",d.pipesCount,e);var p=(!e||e.end!==!1)&&t!==n.stdout&&t!==n.stderr,f=p?o:r;d.endEmitted?n.nextTick(f):u.once("end",f),t.on("unpipe",i);var _=m(u);return t.on("drain",_),u.on("data",s),t._events&&t._events.error?E(t._events.error)?t._events.error.unshift(a):t._events.error=[a,t._events.error]:t.on("error",a),t.once("close",h),t.once("finish",l),t.emit("pipe",u),d.flowing||(k("pipe resume"),u.resume()),t},o.prototype.unpipe=function(t){var e=this._readableState;if(0===e.pipesCount)return this;if(1===e.pipesCount)return t&&t!==e.pipes?this:(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this),this);if(!t){var n=e.pipes,i=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var o=0;i>o;o++)n[o].emit("unpipe",this);return this}var o=w(e.pipes,t);return-1===o?this:(e.pipes.splice(o,1),e.pipesCount-=1,1===e.pipesCount&&(e.pipes=e.pipes[0]),t.emit("unpipe",this),this)},o.prototype.on=function(t,e){var i=T.prototype.on.call(this,t,e);if("data"===t&&!1!==this._readableState.flowing&&this.resume(),"readable"===t&&this.readable){var o=this._readableState;if(!o.readableListening)if(o.readableListening=!0,o.emittedReadable=!1,o.needReadable=!0,o.reading)o.length&&u(this,o);else{var r=this;n.nextTick(function(){k("readable nexttick read 0"),r.read(0)})}}return i},o.prototype.addListener=o.prototype.on,o.prototype.resume=function(){var t=this._readableState;return t.flowing||(k("resume"),t.flowing=!0,t.reading||(k("resume read 0"),this.read(0)),_(this,t)),this},o.prototype.pause=function(){return k("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(k("pause"),this._readableState.flowing=!1,this.emit("pause")),this},o.prototype.wrap=function(t){var e=this._readableState,n=!1,i=this;t.on("end",function(){if(k("wrapped end"),e.decoder&&!e.ended){var t=e.decoder.end();t&&t.length&&i.push(t)}i.push(null)}),t.on("data",function(o){if(k("wrapped data"),e.decoder&&(o=e.decoder.write(o)),o&&(e.objectMode||o.length)){var r=i.push(o);r||(n=!0,t.pause())}});for(var o in t)C.isFunction(t[o])&&C.isUndefined(this[o])&&(this[o]=function(e){return function(){return t[e].apply(t,arguments)}}(o));var r=["error","close","destroy","pause","resume"];return b(r,function(e){t.on(e,i.emit.bind(i,e))}),i._read=function(e){k("wrapped _read",e),n&&(n=!1,t.resume())},i},o._fromList=y}).call(this,t("_process"))},{"./_stream_duplex":40,_process:7,buffer:8,"core-util-is":9,events:13,inherits:23,isarray:38,stream:37,"string_decoder/":49,util:5}],43:[function(t,e,n){function i(t,e){this.afterTransform=function(t,n){return o(e,t,n)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null}function o(t,e,n){var i=t._transformState;i.transforming=!1;var o=i.writecb;if(!o)return t.emit("error",new Error("no writecb in Transform class"));i.writechunk=null,i.writecb=null,h.isNullOrUndefined(n)||t.push(n),o&&o(e);var r=t._readableState;r.reading=!1,(r.needReadable||r.length<r.highWaterMark)&&t._read(r.highWaterMark)}function r(t){if(!(this instanceof r))return new r(t);a.call(this,t),
this._transformState=new i(t,this);var e=this;this._readableState.needReadable=!0,this._readableState.sync=!1,this.once("prefinish",function(){h.isFunction(this._flush)?this._flush(function(t){s(e,t)}):s(e)})}function s(t,e){if(e)return t.emit("error",e);var n=t._writableState,i=t._transformState;if(n.length)throw new Error("calling transform done when ws.length != 0");if(i.transforming)throw new Error("calling transform done when still transforming");return t.push(null)}e.exports=r;var a=t("./_stream_duplex"),h=t("core-util-is");h.inherits=t("inherits"),h.inherits(r,a),r.prototype.push=function(t,e){return this._transformState.needTransform=!1,a.prototype.push.call(this,t,e)},r.prototype._transform=function(t,e,n){throw new Error("not implemented")},r.prototype._write=function(t,e,n){var i=this._transformState;if(i.writecb=n,i.writechunk=t,i.writeencoding=e,!i.transforming){var o=this._readableState;(i.needTransform||o.needReadable||o.length<o.highWaterMark)&&this._read(o.highWaterMark)}},r.prototype._read=function(t){var e=this._transformState;h.isNull(e.writechunk)||!e.writecb||e.transforming?e.needTransform=!0:(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform))}},{"./_stream_duplex":40,"core-util-is":9,inherits:23}],44:[function(t,e,n){(function(n){function i(t,e,n){this.chunk=t,this.encoding=e,this.callback=n}function o(e,n){var i=t("./_stream_duplex");e=e||{};var o=e.highWaterMark,r=e.objectMode?16:16384;this.highWaterMark=o||0===o?o:r,this.objectMode=!!e.objectMode,n instanceof i&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var s=e.decodeStrings===!1;this.decodeStrings=!s,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){p(n,t)},this.writecb=null,this.writelen=0,this.buffer=[],this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1}function r(e){var n=t("./_stream_duplex");return this instanceof r||this instanceof n?(this._writableState=new o(e,this),this.writable=!0,void E.call(this)):new r(e)}function s(t,e,i){var o=new Error("write after end");t.emit("error",o),n.nextTick(function(){i(o)})}function a(t,e,i,o){var r=!0;if(!(w.isBuffer(i)||w.isString(i)||w.isNullOrUndefined(i)||e.objectMode)){var s=new TypeError("Invalid non-string/buffer chunk");t.emit("error",s),n.nextTick(function(){o(s)}),r=!1}return r}function h(t,e,n){return!t.objectMode&&t.decodeStrings!==!1&&w.isString(e)&&(e=new b(e,n)),e}function l(t,e,n,o,r){n=h(e,n,o),w.isBuffer(n)&&(o="buffer");var s=e.objectMode?1:n.length;e.length+=s;var a=e.length<e.highWaterMark;return a||(e.needDrain=!0),e.writing||e.corked?e.buffer.push(new i(n,o,r)):c(t,e,!1,s,n,o,r),a}function c(t,e,n,i,o,r,s){e.writelen=i,e.writecb=s,e.writing=!0,e.sync=!0,n?t._writev(o,e.onwrite):t._write(o,r,e.onwrite),e.sync=!1}function u(t,e,i,o,r){i?n.nextTick(function(){e.pendingcb--,r(o)}):(e.pendingcb--,r(o)),t._writableState.errorEmitted=!0,t.emit("error",o)}function d(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}function p(t,e){var i=t._writableState,o=i.sync,r=i.writecb;if(d(i),e)u(t,i,o,e,r);else{var s=g(t,i);s||i.corked||i.bufferProcessing||!i.buffer.length||_(t,i),o?n.nextTick(function(){f(t,i,s,r)}):f(t,i,s,r)}}function f(t,e,n,i){n||m(t,e),e.pendingcb--,i(),y(t,e)}function m(t,e){0===e.length&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}function _(t,e){if(e.bufferProcessing=!0,t._writev&&e.buffer.length>1){for(var n=[],i=0;i<e.buffer.length;i++)n.push(e.buffer[i].callback);e.pendingcb++,c(t,e,!0,e.length,e.buffer,"",function(t){for(var i=0;i<n.length;i++)e.pendingcb--,n[i](t)}),e.buffer=[]}else{for(var i=0;i<e.buffer.length;i++){var o=e.buffer[i],r=o.chunk,s=o.encoding,a=o.callback,h=e.objectMode?1:r.length;if(c(t,e,!1,h,r,s,a),e.writing){i++;break}}i<e.buffer.length?e.buffer=e.buffer.slice(i):e.buffer.length=0}e.bufferProcessing=!1}function g(t,e){return e.ending&&0===e.length&&!e.finished&&!e.writing}function v(t,e){e.prefinished||(e.prefinished=!0,t.emit("prefinish"))}function y(t,e){var n=g(t,e);return n&&(0===e.pendingcb?(v(t,e),e.finished=!0,t.emit("finish")):v(t,e)),n}function L(t,e,i){e.ending=!0,y(t,e),i&&(e.finished?n.nextTick(i):t.once("finish",i)),e.ended=!0}e.exports=r;var b=t("buffer").Buffer;r.WritableState=o;var w=t("core-util-is");w.inherits=t("inherits");var E=t("stream");w.inherits(r,E),r.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe. Not readable."))},r.prototype.write=function(t,e,n){var i=this._writableState,o=!1;return w.isFunction(e)&&(n=e,e=null),w.isBuffer(t)?e="buffer":e||(e=i.defaultEncoding),w.isFunction(n)||(n=function(){}),i.ended?s(this,i,n):a(this,i,t,n)&&(i.pendingcb++,o=l(this,i,t,e,n)),o},r.prototype.cork=function(){var t=this._writableState;t.corked++},r.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,t.writing||t.corked||t.finished||t.bufferProcessing||!t.buffer.length||_(this,t))},r.prototype._write=function(t,e,n){n(new Error("not implemented"))},r.prototype._writev=null,r.prototype.end=function(t,e,n){var i=this._writableState;w.isFunction(t)?(n=t,t=null,e=null):w.isFunction(e)&&(n=e,e=null),w.isNullOrUndefined(t)||this.write(t,e),i.corked&&(i.corked=1,this.uncork()),i.ending||i.finished||L(this,i,n)}}).call(this,t("_process"))},{"./_stream_duplex":40,_process:7,buffer:8,"core-util-is":9,inherits:23,stream:37}],45:[function(t,e,n){e.exports=t("./lib/_stream_passthrough.js")},{"./lib/_stream_passthrough.js":41}],46:[function(t,e,n){(function(i){n=e.exports=t("./lib/_stream_readable.js"),n.Stream=t("stream"),n.Readable=n,n.Writable=t("./lib/_stream_writable.js"),n.Duplex=t("./lib/_stream_duplex.js"),n.Transform=t("./lib/_stream_transform.js"),n.PassThrough=t("./lib/_stream_passthrough.js"),i.browser||"disable"!==i.env.READABLE_STREAM||(e.exports=t("stream"))}).call(this,t("_process"))},{"./lib/_stream_duplex.js":40,"./lib/_stream_passthrough.js":41,"./lib/_stream_readable.js":42,"./lib/_stream_transform.js":43,"./lib/_stream_writable.js":44,_process:7,stream:37}],47:[function(t,e,n){e.exports=t("./lib/_stream_transform.js")},{"./lib/_stream_transform.js":43}],48:[function(t,e,n){e.exports=t("./lib/_stream_writable.js")},{"./lib/_stream_writable.js":44}],49:[function(t,e,n){function i(t){if(t&&!h(t))throw new Error("Unknown encoding: "+t)}function o(t){return t.toString(this.encoding)}function r(t){this.charReceived=t.length%2,this.charLength=this.charReceived?2:0}function s(t){this.charReceived=t.length%3,this.charLength=this.charReceived?3:0}var a=t("buffer").Buffer,h=a.isEncoding||function(t){switch(t&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}},l=n.StringDecoder=function(t){switch(this.encoding=(t||"utf8").toLowerCase().replace(/[-_]/,""),i(t),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=r;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=s;break;default:return void(this.write=o)}this.charBuffer=new a(6),this.charReceived=0,this.charLength=0};l.prototype.write=function(t){for(var e="";this.charLength;){var n=t.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:t.length;if(t.copy(this.charBuffer,this.charReceived,0,n),this.charReceived+=n,this.charReceived<this.charLength)return"";t=t.slice(n,t.length),e=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var i=e.charCodeAt(e.length-1);if(!(i>=55296&&56319>=i)){if(this.charReceived=this.charLength=0,0===t.length)return e;break}this.charLength+=this.surrogateSize,e=""}this.detectIncompleteChar(t);var o=t.length;this.charLength&&(t.copy(this.charBuffer,0,t.length-this.charReceived,o),o-=this.charReceived),e+=t.toString(this.encoding,0,o);var o=e.length-1,i=e.charCodeAt(o);if(i>=55296&&56319>=i){var r=this.surrogateSize;return this.charLength+=r,this.charReceived+=r,this.charBuffer.copy(this.charBuffer,r,0,r),t.copy(this.charBuffer,0,0,r),e.substring(0,o)}return e},l.prototype.detectIncompleteChar=function(t){for(var e=t.length>=3?3:t.length;e>0;e--){var n=t[t.length-e];if(1==e&&n>>5==6){this.charLength=2;break}if(2>=e&&n>>4==14){this.charLength=3;break}if(3>=e&&n>>3==30){this.charLength=4;break}}this.charReceived=e},l.prototype.end=function(t){var e="";if(t&&t.length&&(e=this.write(t)),this.charReceived){var n=this.charReceived,i=this.charBuffer,o=this.encoding;e+=i.slice(0,n).toString(o)}return e}},{buffer:8}],50:[function(t,e,n){"use strict";e.exports=function(t){return encodeURIComponent(t).replace(/[!'()*]/g,function(t){return"%"+t.charCodeAt(0).toString(16).toUpperCase()})}},{}],51:[function(t,e,n){var i=t("xhr"),o=t("queue"),r={};r.resolverUrlFor=function(t){var e=encodeURIComponent(t.join("|"));return"http://resolver.globalnames.org/name_resolvers.json?names="+e+"&data_source_ids=12"},r.eolPageIdsFor=function(t,e){var n=function(t){return-1!=[1,2].indexOf(t.match_type)},a=function(t,e){var i=t.reduce(function(t,i){return n(i)&&(t[i.local_id]={name:e,id:i.local_id}),t},{});return Object.keys(i).map(function(t){return i[t]})},h=function(t,e){return appendedIds=[].concat(t),e&&e.results&&(Array.isArray(e.results)?appendedIds=appendedIds.concat(a(e.results,e.supplied_name_string)):n(e.results)&&(appendedIds=appendedIds.concat({name:e.supplied_name_string,id:e.results.local_id}))),appendedIds},l=o();l.timeout=3e4;for(var c=[],u=[],d=50,p=s(t),f=0;f<=p.length/d;f++){var m=f*d,_=p.slice(m,m+d),g=r.resolverUrlFor(_);u.push(g)}u.forEach(function(t){l.push(function(e){i({uri:t,headers:{Accept:"application/json"}},function(t,n,i){var o=[];if(200==n.statusCode){var r=JSON.parse(i);if(r.data){var s=r.data;o=Array.isArray(s)?s.reduce(h,o):h(o,s)}}Array.prototype.push.apply(c,o),e()})})}),l.start(function(t){e(s(c))})};var s=function(t){return t.filter(function(e,n){return t.indexOf(e)==n})};r.saveAsCollection=function(t,e,n,o,r){var a=s(n),h=a.reduce(function(t,e){return t.concat([{collected_item_type:"TaxonConcept",collected_item_id:e}])},[]),l={name:o||"my name",description:r||"my description",collection_items:h},c=JSON.stringify({collection:l});i({body:c,method:"POST",uri:"http://eol.org/wapi/collections",headers:{"Content-Type":"application/json",Authorization:'Token token="'+e+'"'}},function(e,n,i){if(200==n.statusCode){var o=JSON.parse(i).id;t(o,n,c)}else t(null,n,c)})},e.exports=r},{queue:36,xhr:52}],52:[function(t,e,n){"use strict";function i(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0}function o(t,e){function n(){4===u.readyState&&l()}function r(){var t=void 0;if(u.response?t=u.response:"text"!==u.responseType&&u.responseType||(t=u.responseText||u.responseXML),L)try{t=JSON.parse(t)}catch(e){}return t}function s(t){clearTimeout(f),t instanceof Error||(t=new Error(""+(t||"Unknown XMLHttpRequest Error"))),t.statusCode=0,e(t,c)}function l(){if(!p){var n;clearTimeout(f),n=t.useXDR&&void 0===u.status?200:1223===u.status?204:u.status;var i=c,o=null;0!==n?(i={body:r(),statusCode:n,method:_,headers:{},url:m,rawRequest:u},u.getAllResponseHeaders&&(i.headers=h(u.getAllResponseHeaders()))):o=new Error("Internal XMLHttpRequest Error"),e(o,i,i.body)}}var c={body:void 0,headers:{},statusCode:0,method:_,url:m,rawRequest:u};if("string"==typeof t&&(t={uri:t}),t=t||{},"undefined"==typeof e)throw new Error("callback argument missing");e=a(e);var u=t.xhr||null;u||(u=t.cors||t.useXDR?new o.XDomainRequest:new o.XMLHttpRequest);var d,p,f,m=u.url=t.uri||t.url,_=u.method=t.method||"GET",g=t.body||t.data,v=u.headers=t.headers||{},y=!!t.sync,L=!1;if("json"in t&&(L=!0,v.accept||v.Accept||(v.Accept="application/json"),"GET"!==_&&"HEAD"!==_&&(v["content-type"]||v["Content-Type"]||(v["Content-Type"]="application/json"),g=JSON.stringify(t.json))),u.onreadystatechange=n,u.onload=l,u.onerror=s,u.onprogress=function(){},u.ontimeout=s,u.open(_,m,!y,t.username,t.password),y||(u.withCredentials=!!t.withCredentials),!y&&t.timeout>0&&(f=setTimeout(function(){p=!0,u.abort("timeout");var t=new Error("XMLHttpRequest timeout");t.code="ETIMEDOUT",s(t)},t.timeout)),u.setRequestHeader)for(d in v)v.hasOwnProperty(d)&&u.setRequestHeader(d,v[d]);else if(t.headers&&!i(t.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in t&&(u.responseType=t.responseType),"beforeSend"in t&&"function"==typeof t.beforeSend&&t.beforeSend(u),u.send(g),u}function r(){}var s=t("global/window"),a=t("once"),h=t("parse-headers");e.exports=o,o.XMLHttpRequest=s.XMLHttpRequest||r,o.XDomainRequest="withCredentials"in new o.XMLHttpRequest?o.XMLHttpRequest:s.XDomainRequest},{"global/window":16,once:29,"parse-headers":30}],53:[function(t,e,n){!function(i,o){if("object"==typeof e&&"object"==typeof e.exports)n=e.exports=o(t("terraformer"));else if("object"==typeof navigator){if(!i.Terraformer)throw new Error("Terraformer.WKT requires the core Terraformer library. http://github.com/esri/terraformer");i.Terraformer.WKT=o(i.Terraformer)}}(this,function(t){function e(t){this.data=[t],this.type="PointArray"}function n(t){this.data=t,this.type="Ring"}function i(t){this.data=[t],this.type="RingList"}function o(t){this.data=[t],this.type="PolygonList"}function r(e){var n;try{n=m.parse(e)}catch(i){throw Error("Unable to parse: "+i)}return t.Primitive(n)}function s(t){for(var e=[],n="",i=0;i<t.length;i++)e.push(t[i].join(" "));return n+="("+e.join(", ")+")"}function a(t){var e="POINT ";return void 0===t.coordinates||0===t.coordinates.length?e+="EMPTY":(3===t.coordinates.length?e+=t.properties&&t.properties.m===!0?"M ":"Z ":4===t.coordinates.length&&(e+="ZM "),e+="("+t.coordinates.join(" ")+")")}function h(t){var e="LINESTRING ";return void 0===t.coordinates||0===t.coordinates.length||0===t.coordinates[0].length?e+="EMPTY":(3===t.coordinates[0].length?e+=t.properties&&t.properties.m===!0?"M ":"Z ":4===t.coordinates[0].length&&(e+="ZM "),e+=s(t.coordinates))}function l(t){var e="POLYGON ";if(void 0===t.coordinates||0===t.coordinates.length||0===t.coordinates[0].length)return e+="EMPTY";3===t.coordinates[0][0].length?e+=t.properties&&t.properties.m===!0?"M ":"Z ":4===t.coordinates[0][0].length&&(e+="ZM "),e+="(";for(var n=[],i=0;i<t.coordinates.length;i++)n.push(s(t.coordinates[i]));return e+=n.join(", "),e+=")"}function c(t){var e="MULTIPOINT ";return void 0===t.coordinates||0===t.coordinates.length||0===t.coordinates[0].length?e+="EMPTY":(3===t.coordinates[0].length?e+=t.properties&&t.properties.m===!0?"M ":"Z ":4===t.coordinates[0].length&&(e+="ZM "),e+=s(t.coordinates))}function u(t){var e="MULTILINESTRING ";if(void 0===t.coordinates||0===t.coordinates.length||0===t.coordinates[0].length)return e+="EMPTY";3===t.coordinates[0][0].length?e+=t.properties&&t.properties.m===!0?"M ":"Z ":4===t.coordinates[0][0].length&&(e+="ZM "),e+="(";for(var n=[],i=0;i<t.coordinates.length;i++)n.push(s(t.coordinates[i]));return e+=n.join(", "),e+=")"}function d(t){var e="MULTIPOLYGON ";if(void 0===t.coordinates||0===t.coordinates.length||0===t.coordinates[0].length)return e+="EMPTY";3===t.coordinates[0][0][0].length?e+=t.properties&&t.properties.m===!0?"M ":"Z ":4===t.coordinates[0][0][0].length&&(e+="ZM "),e+="(";for(var n=[],i=0;i<t.coordinates.length;i++){for(var o="(",r=[],a=0;a<t.coordinates[i].length;a++)r.push(s(t.coordinates[i][a]));o+=r.join(", "),o+=")",n.push(o)}return e+=n.join(", "),e+=")"}function p(t){switch(t.type){case"Point":return a(t);case"LineString":return h(t);case"Polygon":return l(t);case"MultiPoint":return c(t);case"MultiLineString":return u(t);case"MultiPolygon":return d(t);default:throw Error("Unknown Type: "+t.type)}}var f={},m=function(){function t(){this.yy={}}var r={trace:function(){},yy:{},symbols_:{error:2,expressions:3,point:4,EOF:5,linestring:6,polygon:7,multipoint:8,multilinestring:9,multipolygon:10,coordinate:11,DOUBLE_TOK:12,ptarray:13,COMMA:14,ring_list:15,ring:16,"(":17,")":18,POINT:19,Z:20,ZM:21,M:22,EMPTY:23,point_untagged:24,polygon_list:25,polygon_untagged:26,point_list:27,LINESTRING:28,POLYGON:29,MULTIPOINT:30,MULTILINESTRING:31,MULTIPOLYGON:32,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",12:"DOUBLE_TOK",14:"COMMA",17:"(",18:")",19:"POINT",20:"Z",21:"ZM",22:"M",23:"EMPTY",28:"LINESTRING",29:"POLYGON",30:"MULTIPOINT",31:"MULTILINESTRING",32:"MULTIPOLYGON"},productions_:[0,[3,2],[3,2],[3,2],[3,2],[3,2],[3,2],[11,2],[11,3],[11,4],[13,3],[13,1],[15,3],[15,1],[16,3],[4,4],[4,5],[4,5],[4,5],[4,2],[24,1],[24,3],[25,3],[25,1],[26,3],[27,3],[27,1],[6,4],[6,5],[6,5],[6,5],[6,2],[7,4],[7,5],[7,5],[7,5],[7,2],[8,4],[8,5],[8,5],[8,5],[8,2],[9,4],[9,5],[9,5],[9,5],[9,2],[10,4],[10,5],[10,5],[10,5],[10,2]],performAction:function(t,r,s,a,h,l,c){var u=l.length-1;switch(h){case 1:return l[u-1];case 2:return l[u-1];case 3:return l[u-1];case 4:return l[u-1];case 5:return l[u-1];case 6:return l[u-1];case 7:this.$=new e([Number(l[u-1]),Number(l[u])]);break;case 8:this.$=new e([Number(l[u-2]),Number(l[u-1]),Number(l[u])]);break;case 9:this.$=new e([Number(l[u-3]),Number(l[u-2]),Number(l[u-1]),Number(l[u])]);break;case 10:this.$=l[u-2].addPoint(l[u]);break;case 11:this.$=l[u];break;case 12:this.$=l[u-2].addRing(l[u]);break;case 13:this.$=new i(l[u]);break;case 14:this.$=new n(l[u-1]);break;case 15:this.$={type:"Point",coordinates:l[u-1].data[0]};break;case 16:this.$={type:"Point",coordinates:l[u-1].data[0],properties:{z:!0}};break;case 17:this.$={type:"Point",coordinates:l[u-1].data[0],properties:{z:!0,m:!0}};break;case 18:this.$={type:"Point",coordinates:l[u-1].data[0],properties:{m:!0}};break;case 19:this.$={type:"Point",coordinates:[]};break;case 20:this.$=l[u];break;case 21:this.$=l[u-1];break;case 22:this.$=l[u-2].addPolygon(l[u]);break;case 23:this.$=new o(l[u]);break;case 24:this.$=l[u-1];break;case 25:this.$=l[u-2].addPoint(l[u]);break;case 26:this.$=l[u];break;case 27:this.$={type:"LineString",coordinates:l[u-1].data};break;case 28:this.$={type:"LineString",coordinates:l[u-1].data,properties:{z:!0}};break;case 29:this.$={type:"LineString",coordinates:l[u-1].data,properties:{m:!0}};break;case 30:this.$={type:"LineString",coordinates:l[u-1].data,properties:{z:!0,m:!0}};break;case 31:this.$={type:"LineString",coordinates:[]};break;case 32:this.$={type:"Polygon",coordinates:l[u-1].toJSON()};break;case 33:this.$={type:"Polygon",coordinates:l[u-1].toJSON(),properties:{z:!0}};break;case 34:this.$={type:"Polygon",coordinates:l[u-1].toJSON(),properties:{m:!0}};break;case 35:this.$={type:"Polygon",coordinates:l[u-1].toJSON(),properties:{z:!0,m:!0}};break;case 36:this.$={type:"Polygon",coordinates:[]};break;case 37:this.$={type:"MultiPoint",coordinates:l[u-1].data};break;case 38:this.$={type:"MultiPoint",coordinates:l[u-1].data,properties:{z:!0}};break;case 39:this.$={type:"MultiPoint",coordinates:l[u-1].data,properties:{m:!0}};break;case 40:this.$={type:"MultiPoint",coordinates:l[u-1].data,properties:{z:!0,m:!0}};break;case 41:this.$={type:"MultiPoint",coordinates:[]};break;case 42:this.$={type:"MultiLineString",coordinates:l[u-1].toJSON()};break;case 43:this.$={type:"MultiLineString",coordinates:l[u-1].toJSON(),properties:{z:!0}};break;case 44:this.$={type:"MultiLineString",coordinates:l[u-1].toJSON(),properties:{m:!0}};break;case 45:this.$={type:"MultiLineString",coordinates:l[u-1].toJSON(),properties:{z:!0,m:!0}};break;case 46:this.$={type:"MultiLineString",coordinates:[]};break;case 47:this.$={type:"MultiPolygon",coordinates:l[u-1].toJSON()};break;case 48:this.$={type:"MultiPolygon",coordinates:l[u-1].toJSON(),properties:{z:!0}};break;case 49:this.$={type:"MultiPolygon",coordinates:l[u-1].toJSON(),properties:{m:!0}};break;case 50:this.$={type:"MultiPolygon",coordinates:l[u-1].toJSON(),properties:{z:!0,m:!0}};break;case 51:this.$={type:"MultiPolygon",coordinates:[]}}},table:[{3:1,4:2,6:3,7:4,8:5,9:6,10:7,19:[1,8],28:[1,9],29:[1,10],30:[1,11],31:[1,12],32:[1,13]},{1:[3]},{5:[1,14]},{5:[1,15]},{5:[1,16]},{5:[1,17]},{5:[1,18]},{5:[1,19]},{17:[1,20],20:[1,21],21:[1,22],22:[1,23],23:[1,24]},{17:[1,25],20:[1,26],21:[1,28],22:[1,27],23:[1,29]},{17:[1,30],20:[1,31],21:[1,33],22:[1,32],23:[1,34]},{17:[1,35],20:[1,36],21:[1,38],22:[1,37],23:[1,39]},{17:[1,40],20:[1,41],21:[1,43],22:[1,42],23:[1,44]},{17:[1,45],20:[1,46],21:[1,48],22:[1,47],23:[1,49]},{1:[2,1]},{1:[2,2]},{1:[2,3]},{1:[2,4]},{1:[2,5]},{1:[2,6]},{11:51,12:[1,52],13:50},{17:[1,53]},{17:[1,54]},{17:[1,55]},{5:[2,19]},{11:58,12:[1,52],17:[1,59],24:57,27:56},{17:[1,60]},{17:[1,61]},{17:[1,62]},{5:[2,31]},{15:63,16:64,17:[1,65]},{17:[1,66]},{17:[1,67]},{17:[1,68]},{5:[2,36]},{11:58,12:[1,52],17:[1,59],24:57,27:69},{17:[1,70]},{17:[1,71]},{17:[1,72]},{5:[2,41]},{15:73,16:64,17:[1,65]},{17:[1,74]},{17:[1,75]},{17:[1,76]},{5:[2,46]},{17:[1,79],25:77,26:78},{17:[1,80]},{17:[1,81]},{17:[1,82]},{5:[2,51]},{14:[1,84],18:[1,83]},{14:[2,11],18:[2,11]},{12:[1,85]},{11:51,12:[1,52],13:86},{11:51,12:[1,52],13:87},{11:51,12:[1,52],13:88},{14:[1,90],18:[1,89]},{14:[2,26],18:[2,26]},{14:[2,20],18:[2,20]},{11:91,12:[1,52]},{11:58,12:[1,52],17:[1,59],24:57,27:92},{11:58,12:[1,52],17:[1,59],24:57,27:93},{11:58,12:[1,52],17:[1,59],24:57,27:94},{14:[1,96],18:[1,95]},{14:[2,13],18:[2,13]},{11:51,12:[1,52],13:97},{15:98,16:64,17:[1,65]},{15:99,16:64,17:[1,65]},{15:100,16:64,17:[1,65]},{14:[1,90],18:[1,101]},{11:58,12:[1,52],17:[1,59],24:57,27:102},{11:58,12:[1,52],17:[1,59],24:57,27:103},{11:58,12:[1,52],17:[1,59],24:57,27:104},{14:[1,96],18:[1,105]},{15:106,16:64,17:[1,65]},{15:107,16:64,17:[1,65]},{15:108,16:64,17:[1,65]},{14:[1,110],18:[1,109]},{14:[2,23],18:[2,23]},{15:111,16:64,17:[1,65]},{17:[1,79],25:112,26:78},{17:[1,79],25:113,26:78},{17:[1,79],25:114,26:78},{5:[2,15]},{11:115,12:[1,52]},{12:[1,116],14:[2,7],18:[2,7]},{14:[1,84],18:[1,117]},{14:[1,84],18:[1,118]},{14:[1,84],18:[1,119]},{5:[2,27]},{11:58,12:[1,52],17:[1,59],24:120},{18:[1,121]},{14:[1,90],18:[1,122]},{14:[1,90],18:[1,123]},{14:[1,90],18:[1,124]},{5:[2,32]},{16:125,17:[1,65]},{14:[1,84],18:[1,126]},{14:[1,96],18:[1,127]},{14:[1,96],18:[1,128]},{14:[1,96],18:[1,129]},{5:[2,37]},{14:[1,90],18:[1,130]},{14:[1,90],18:[1,131]},{14:[1,90],18:[1,132]},{5:[2,42]},{14:[1,96],18:[1,133]},{14:[1,96],18:[1,134]},{14:[1,96],18:[1,135]},{5:[2,47]},{17:[1,79],26:136},{14:[1,96],18:[1,137]},{14:[1,110],18:[1,138]},{14:[1,110],18:[1,139]},{14:[1,110],18:[1,140]},{14:[2,10],18:[2,10]},{12:[1,141],14:[2,8],18:[2,8]},{5:[2,16]},{5:[2,17]},{5:[2,18]},{14:[2,25],18:[2,25]},{14:[2,21],18:[2,21]},{5:[2,28]},{5:[2,29]},{5:[2,30]},{14:[2,12],18:[2,12]},{14:[2,14],18:[2,14]},{5:[2,33]},{5:[2,34]},{5:[2,35]},{5:[2,38]},{5:[2,39]},{5:[2,40]},{5:[2,43]},{5:[2,44]},{5:[2,45]},{14:[2,22],18:[2,22]},{14:[2,24],18:[2,24]},{5:[2,48]},{5:[2,49]},{5:[2,50]},{14:[2,9],18:[2,9]}],defaultActions:{14:[2,1],15:[2,2],16:[2,3],17:[2,4],18:[2,5],19:[2,6],24:[2,19],29:[2,31],34:[2,36],39:[2,41],44:[2,46],49:[2,51],83:[2,15],89:[2,27],95:[2,32],101:[2,37],105:[2,42],109:[2,47],117:[2,16],118:[2,17],119:[2,18],122:[2,28],123:[2,29],124:[2,30],127:[2,33],128:[2,34],129:[2,35],130:[2,38],131:[2,39],132:[2,40],133:[2,43],134:[2,44],135:[2,45],138:[2,48],139:[2,49],140:[2,50]},parseError:function(t,e){throw new Error(t)},parse:function(t){function e(){var t;return t=n.lexer.lex()||1,"number"!=typeof t&&(t=n.symbols_[t]||t),t}var n=this,i=[0],o=[null],r=[],s=this.table,a="",h=0,l=0,c=0;this.lexer.setInput(t),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,"undefined"==typeof this.lexer.yylloc&&(this.lexer.yylloc={});var u=this.lexer.yylloc;r.push(u);var d=this.lexer.options&&this.lexer.options.ranges;"function"==typeof this.yy.parseError&&(this.parseError=this.yy.parseError);for(var p,f,m,_,g,v,y,L,b,w={};;){if(m=i[i.length-1],this.defaultActions[m]?_=this.defaultActions[m]:((null===p||"undefined"==typeof p)&&(p=e()),_=s[m]&&s[m][p]),"undefined"==typeof _||!_.length||!_[0]){var E="";if(!c){b=[];for(v in s[m])this.terminals_[v]&&v>2&&b.push("'"+this.terminals_[v]+"'");E=this.lexer.showPosition?"Parse error on line "+(h+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+b.join(", ")+", got '"+(this.terminals_[p]||p)+"'":"Parse error on line "+(h+1)+": Unexpected "+(1==p?"end of input":"'"+(this.terminals_[p]||p)+"'"),this.parseError(E,{text:this.lexer.match,token:this.terminals_[p]||p,line:this.lexer.yylineno,loc:u,expected:b})}}if(_[0]instanceof Array&&_.length>1)throw new Error("Parse Error: multiple actions possible at state: "+m+", token: "+p);switch(_[0]){case 1:i.push(p),o.push(this.lexer.yytext),r.push(this.lexer.yylloc),i.push(_[1]),p=null,f?(p=f,f=null):(l=this.lexer.yyleng,a=this.lexer.yytext,h=this.lexer.yylineno,u=this.lexer.yylloc,c>0&&c--);break;case 2:if(y=this.productions_[_[1]][1],w.$=o[o.length-y],w._$={first_line:r[r.length-(y||1)].first_line,last_line:r[r.length-1].last_line,first_column:r[r.length-(y||1)].first_column,last_column:r[r.length-1].last_column},d&&(w._$.range=[r[r.length-(y||1)].range[0],r[r.length-1].range[1]]),g=this.performAction.call(w,a,l,h,this.yy,_[1],o,r),"undefined"!=typeof g)return g;y&&(i=i.slice(0,-1*y*2),o=o.slice(0,-1*y),r=r.slice(0,-1*y)),i.push(this.productions_[_[1]][0]),o.push(w.$),r.push(w._$),L=s[i[i.length-2]][i[i.length-1]],i.push(L);break;case 3:return!0}}return!0}},s=function(){var t={EOF:1,parseError:function(t,e){if(!this.yy.parser)throw new Error(t);this.yy.parser.parseError(t,e)},setInput:function(t){return this._input=t,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var t=this._input[0];this.yytext+=t,this.yyleng++,this.offset++,this.match+=t,this.matched+=t;var e=t.match(/(?:\r\n?|\n).*/g);return e?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),t},unput:function(t){var e=t.length,n=t.split(/(?:\r\n?|\n)/g);this._input=t+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-e-1),this.offset-=e;var i=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),n.length-1&&(this.yylineno-=n.length-1);var o=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:n?(n.length===i.length?this.yylloc.first_column:0)+i[i.length-n.length].length-n[0].length:this.yylloc.first_column-e},this.options.ranges&&(this.yylloc.range=[o[0],o[0]+this.yyleng-e]),this},more:function(){return this._more=!0,this},less:function(t){this.unput(this.match.slice(t))},pastInput:function(){var t=this.matched.substr(0,this.matched.length-this.match.length);return(t.length>20?"...":"")+t.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var t=this.match;return t.length<20&&(t+=this._input.substr(0,20-t.length)),(t.substr(0,20)+(t.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var t=this.pastInput(),e=new Array(t.length+1).join("-");return t+this.upcomingInput()+"\n"+e+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var t,e,n,i,o;this._more||(this.yytext="",this.match="");for(var r=this._currentRules(),s=0;s<r.length&&(n=this._input.match(this.rules[r[s]]),!n||e&&!(n[0].length>e[0].length)||(e=n,i=s,this.options.flex));s++);return e?(o=e[0].match(/(?:\r\n?|\n).*/g),o&&(this.yylineno+=o.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:o?o[o.length-1].length-o[o.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+e[0].length},this.yytext+=e[0],this.match+=e[0],this.matches=e,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(e[0].length),this.matched+=e[0],t=this.performAction.call(this,this.yy,this,r[i],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),t?t:void 0):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var t=this.next();return"undefined"!=typeof t?t:this.lex()},begin:function(t){this.conditionStack.push(t)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(t){this.begin(t)}};return t.options={},t.performAction=function(t,e,n,i){switch(n){case 0:break;case 1:return 17;case 2:return 18;case 3:return 12;case 4:return 19;case 5:return 28;case 6:return 29;case 7:return 30;case 8:return 31;case 9:return 32;case 10:return 14;case 11:return 23;case 12:return 22;case 13:return 20;case 14:return 21;case 15:return 5;case 16:return"INVALID"}},t.rules=[/^(?:\s+)/,/^(?:\()/,/^(?:\))/,/^(?:-?[0-9]+(\.[0-9]+)?([eE][\-\+]?[0-9]+)?)/,/^(?:POINT\b)/,/^(?:LINESTRING\b)/,/^(?:POLYGON\b)/,/^(?:MULTIPOINT\b)/,/^(?:MULTILINESTRING\b)/,/^(?:MULTIPOLYGON\b)/,/^(?:,)/,/^(?:EMPTY\b)/,/^(?:M\b)/,/^(?:Z\b)/,/^(?:ZM\b)/,/^(?:$)/,/^(?:.)/],t.conditions={INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],inclusive:!0}},t}();return r.lexer=s,t.prototype=r,r.Parser=t,new t}();return e.prototype.addPoint=function(t){return"PointArray"===t.type?this.data=this.data.concat(t.data):this.data.push(t),this},e.prototype.toJSON=function(){return this.data},n.prototype.toJSON=function(){for(var t=[],e=0;e<this.data.data.length;e++)t.push(this.data.data[e]);return t},i.prototype.addRing=function(t){return this.data.push(t),this},i.prototype.toJSON=function(){for(var t=[],e=0;e<this.data.length;e++)t.push(this.data[e].toJSON());return 1===t.length?t:t},o.prototype.addPolygon=function(t){return this.data.push(t),this},o.prototype.toJSON=function(){for(var t=[],e=0;e<this.data.length;e++)t=t.concat([this.data[e].toJSON()]);return t},f.parser=m,f.Parser=m.Parser,f.parse=r,f.convert=p,f})},{terraformer:54}],54:[function(t,e,n){!function(t,i){"object"==typeof e&&"object"==typeof e.exports&&(n=e.exports=i()),"object"==typeof window&&(t.Terraformer=i())}(this,function(){function t(t){return"[object Array]"===Object.prototype.toString.call(t)}function e(){var t=Array.prototype.slice.apply(arguments);void 0!==typeof console&&console.warn&&console.warn.apply(console,t)}function n(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function i(t){if(t.type)switch(t.type){case"Point":return[t.coordinates[0],t.coordinates[1],t.coordinates[0],t.coordinates[1]];case"MultiPoint":return s(t.coordinates);case"LineString":return s(t.coordinates);case"MultiLineString":return o(t.coordinates);case"Polygon":return o(t.coordinates);case"MultiPolygon":return r(t.coordinates);case"Feature":return t.geometry?i(t.geometry):null;case"FeatureCollection":return a(t);case"GeometryCollection":return h(t);default:throw new Error("Unknown type: "+t.type)}return null}function o(t){for(var e=null,n=null,i=null,o=null,r=0;r<t.length;r++)for(var s=t[r],a=0;a<s.length;a++){var h=s[a],l=h[0],c=h[1];null===e?e=l:e>l&&(e=l),null===n?n=l:l>n&&(n=l),null===i?i=c:i>c&&(i=c),null===o?o=c:c>o&&(o=c)}return[e,i,n,o]}function r(t){for(var e=null,n=null,i=null,o=null,r=0;r<t.length;r++)for(var s=t[r],a=0;a<s.length;a++)for(var h=s[a],l=0;l<h.length;l++){var c=h[l],u=c[0],d=c[1];null===e?e=u:e>u&&(e=u),null===n?n=u:u>n&&(n=u),null===i?i=d:i>d&&(i=d),null===o?o=d:d>o&&(o=d)}return[e,i,n,o]}function s(t){for(var e=null,n=null,i=null,o=null,r=0;r<t.length;r++){var s=t[r],a=s[0],h=s[1];null===e?e=a:e>a&&(e=a),null===n?n=a:a>n&&(n=a),null===i?i=h:i>h&&(i=h),
null===o?o=h:h>o&&(o=h)}return[e,i,n,o]}function a(t){for(var e,n=[],o=t.features.length-1;o>=0;o--)e=i(t.features[o].geometry),n.push([e[0],e[1]]),n.push([e[2],e[3]]);return s(n)}function h(t){for(var e,n=[],o=t.geometries.length-1;o>=0;o--)e=i(t.geometries[o]),n.push([e[0],e[1]]),n.push([e[2],e[3]]);return s(n)}function l(t){var e=i(t);return{x:e[0],y:e[1],w:Math.abs(e[0]-e[2]),h:Math.abs(e[1]-e[3])}}function c(t){return t*V}function u(t){return t*J}function d(t,e){for(var n=0;n<t.length;n++)"number"==typeof t[n][0]&&(t[n]=e(t[n])),"object"==typeof t[n]&&(t[n]=d(t[n],e));return t}function p(t){var e=t[0],n=t[1];return[c(e/Y)-360*Math.floor((c(e/Y)+180)/360),c(Math.PI/2-2*Math.atan(Math.exp(-1*n/Y)))]}function f(t){var e=t[0],n=Math.max(Math.min(t[1],89.99999),-89.99999);return[u(e)*Y,Y/2*Math.log((1+Math.sin(u(n)))/(1-Math.sin(u(n))))]}function m(t,e,n){if("Point"===t.type)t.coordinates=e(t.coordinates);else if("Feature"===t.type)t.geometry=m(t.geometry,e,!0);else if("FeatureCollection"===t.type)for(var i=0;i<t.features.length;i++)t.features[i]=m(t.features[i],e,!0);else if("GeometryCollection"===t.type)for(var o=0;o<t.geometries.length;o++)t.geometries[o]=m(t.geometries[o],e,!0);else t.coordinates=d(t.coordinates,e);return n||e===f&&(t.crs=X),e===p&&delete t.crs,t}function _(t){return m(t,f)}function g(t){return m(t,p)}function v(t,e){return e>t?-1:t>e?1:0}function y(t,e){return t[0]>e[0]?-1:t[0]<e[0]?1:t[1]>e[1]?-1:t[1]<e[1]?1:0}function L(t,e,n){return v((e[0]-t[0])*(n[1]-t[1])-(n[0]-t[0])*(e[1]-t[1]),0)}function b(t,e){var n=e[0]-t[0],i=e[1]-t[1];return n*n+i*i}function w(t,e){var n=e;for(var i in t){var o=L(e,n,t[i]);(-1===o||0===o&&b(e,t[i])>b(e,n))&&(n=t[i])}return n}function E(t){if(0===t.length)return[];if(1===t.length)return t;for(var e=[t.sort(y)[0]],n=0;n<e.length;n++){var i=w(t,e[n]);i!==e[0]&&e.push(i)}return e}function x(t){for(var e,n=0;n<t.length-3;n++){var i=t[n],o=t[n+1],r=t[n+2],s=[o[0]-i[0],o[1]-i[1]],a=r[0]*s[1]-r[1]*s[0]+s[0]*i[1]-s[1]*i[0];if(0===n)e=0>a?!0:!1;else if(e&&a>0||!e&&0>a)return!1}return!0}function P(t,e){for(var n=!1,i=-1,o=t.length,r=o-1;++i<o;r=i)(t[i][1]<=e[1]&&e[1]<t[r][1]||t[r][1]<=e[1]&&e[1]<t[i][1])&&e[0]<(t[r][0]-t[i][0])*(e[1]-t[i][1])/(t[r][1]-t[i][1])+t[i][0]&&(n=!n);return n}function T(t,e){if(t&&t.length){if(1===t.length)return P(t[0],e);if(P(t[0],e)){for(var n=1;n<t.length;n++)if(P(t[n],e))return!1;return!0}return!1}return!1}function C(t,e,n,i){var o=(i[0]-n[0])*(t[1]-n[1])-(i[1]-n[1])*(t[0]-n[0]),r=(e[0]-t[0])*(t[1]-n[1])-(e[1]-t[1])*(t[0]-n[0]),s=(i[1]-n[1])*(e[0]-t[0])-(i[0]-n[0])*(e[1]-t[1]);if(0!==s){var a=o/s,h=r/s;if(a>=0&&1>=a&&h>=0&&1>=h)return!0}return!1}function M(t){return!isNaN(parseFloat(t))&&isFinite(t)}function k(t,e){if(M(t[0][0])){if(M(e[0][0])){for(var n=0;n<t.length-1;n++)for(var i=0;i<e.length-1;i++)if(C(t[n],t[n+1],e[i],e[i+1]))return!0}else for(var o=0;o<e.length;o++)if(k(t,e[o]))return!0}else for(var r=0;r<t.length;r++)if(k(t[r],e))return!0;return!1}function S(t){for(var e=[],n=0;n<t.length;n++){var i=t[n].slice();D(i[0],i[i.length-1])===!1&&i.push(i[0]),e.push(i)}return e}function D(t,e){for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function I(t,e){if(t.length!==e.length)return!1;for(var n=t.slice().sort(y),i=e.slice().sort(y),o=0;o<n.length;o++){if(n[o].length!==i[o].length)return!1;for(var r=0;r<n.length;r++)if(n[o][r]!==i[o][r])return!1}return!0}function A(t){if(t)switch(t.type){case"Point":return new O(t);case"MultiPoint":return new R(t);case"LineString":return new U(t);case"MultiLineString":return new N(t);case"Polygon":return new B(t);case"MultiPolygon":return new z(t);case"Feature":return new Z(t);case"FeatureCollection":return new H(t);case"GeometryCollection":return new G(t);default:throw new Error("Unknown type: "+t.type)}}function O(e){var i=Array.prototype.slice.call(arguments);if(e&&"Point"===e.type&&e.coordinates)n(this,e);else if(e&&t(e))this.coordinates=e;else{if(!(i.length>=2))throw"Terraformer: invalid input for Terraformer.Point";this.coordinates=i}this.type="Point"}function R(e){if(e&&"MultiPoint"===e.type&&e.coordinates)n(this,e);else{if(!t(e))throw"Terraformer: invalid input for Terraformer.MultiPoint";this.coordinates=e}this.type="MultiPoint"}function U(e){if(e&&"LineString"===e.type&&e.coordinates)n(this,e);else{if(!t(e))throw"Terraformer: invalid input for Terraformer.LineString";this.coordinates=e}this.type="LineString"}function N(e){if(e&&"MultiLineString"===e.type&&e.coordinates)n(this,e);else{if(!t(e))throw"Terraformer: invalid input for Terraformer.MultiLineString";this.coordinates=e}this.type="MultiLineString"}function B(e){if(e&&"Polygon"===e.type&&e.coordinates)n(this,e);else{if(!t(e))throw"Terraformer: invalid input for Terraformer.Polygon";this.coordinates=e}this.type="Polygon"}function z(e){if(e&&"MultiPolygon"===e.type&&e.coordinates)n(this,e);else{if(!t(e))throw"Terraformer: invalid input for Terraformer.MultiPolygon";this.coordinates=e}this.type="MultiPolygon"}function Z(t){if(t&&"Feature"===t.type)n(this,t);else{if(!(t&&t.type&&t.coordinates))throw"Terraformer: invalid input for Terraformer.Feature";this.geometry=t}this.type="Feature"}function H(e){if(e&&"FeatureCollection"===e.type&&e.features)n(this,e);else{if(!t(e))throw"Terraformer: invalid input for Terraformer.FeatureCollection";this.features=e}this.type="FeatureCollection"}function G(e){if(e&&"GeometryCollection"===e.type&&e.geometries)n(this,e);else if(t(e))this.geometries=e;else{if(!e.coordinates||!e.type)throw"Terraformer: invalid input for Terraformer.GeometryCollection";this.type="GeometryCollection",this.geometries=[e]}this.type="GeometryCollection"}function F(t,e,n){for(var i=f(t),o=n||64,r={type:"Polygon",coordinates:[[]]},s=1;o>=s;s++){var a=s*(360/o)*Math.PI/180;r.coordinates[0].push([i[0]+e*Math.cos(a),i[1]+e*Math.sin(a)])}return r.coordinates=S(r.coordinates),g(r)}function W(t,e,i){var o=i||64,r=e||250;if(!t||t.length<2||!r||!o)throw new Error("Terraformer: missing parameter for Terraformer.Circle");n(this,new Z({type:"Feature",geometry:F(t,r,o),properties:{radius:r,center:t,steps:o}}))}var q={},Y=6378137,V=57.29577951308232,J=.017453292519943,X={type:"link",properties:{href:"http://spatialreference.org/ref/sr-org/6928/ogcwkt/",type:"ogcwkt"}},$={type:"link",properties:{href:"http://spatialreference.org/ref/epsg/4326/ogcwkt/",type:"ogcwkt"}},Q=["length"];return A.prototype.toMercator=function(){return _(this)},A.prototype.toGeographic=function(){return g(this)},A.prototype.envelope=function(){return l(this)},A.prototype.bbox=function(){return i(this)},A.prototype.convexHull=function(){var t,e,n=[];if("Point"===this.type)return null;if("LineString"===this.type||"MultiPoint"===this.type){if(!(this.coordinates&&this.coordinates.length>=3))return null;n=this.coordinates}else if("Polygon"===this.type||"MultiLineString"===this.type){if(!(this.coordinates&&this.coordinates.length>0))return null;for(t=0;t<this.coordinates.length;t++)n=n.concat(this.coordinates[t]);if(n.length<3)return null}else if("MultiPolygon"===this.type){if(!(this.coordinates&&this.coordinates.length>0))return null;for(t=0;t<this.coordinates.length;t++)for(e=0;e<this.coordinates[t].length;e++)n=n.concat(this.coordinates[t][e]);if(n.length<3)return null}else if("Feature"===this.type){var i=new A(this.geometry);return i.convexHull()}return new B({type:"Polygon",coordinates:S([E(n)])})},A.prototype.toJSON=function(){var t={};for(var e in this)this.hasOwnProperty(e)&&-1===Q.indexOf(e)&&(t[e]=this[e]);return t.bbox=i(this),t},A.prototype.contains=function(t){return new A(t).within(this)},A.prototype.within=function(t){var e,n,i;if("Feature"===t.type&&(t=t.geometry),"Point"===t.type&&"Point"===this.type)return D(this.coordinates,t.coordinates);if("MultiLineString"===t.type&&"Point"===this.type)for(n=0;n<t.coordinates.length;n++){var o={type:"LineString",coordinates:t.coordinates[n]};if(this.within(o))return!0}if(("LineString"===t.type||"MultiPoint"===t.type)&&"Point"===this.type)for(n=0;n<t.coordinates.length;n++){if(this.coordinates.length!==t.coordinates[n].length)return!1;if(D(this.coordinates,t.coordinates[n]))return!0}if("Polygon"===t.type){if("Polygon"===this.type){if(t.coordinates.length===this.coordinates.length)for(n=0;n<this.coordinates.length;n++)if(I(this.coordinates[n],t.coordinates[n]))return!0;return this.coordinates.length&&T(t.coordinates,this.coordinates[0][0])?!k(S(this.coordinates),S(t.coordinates)):!1}if("Point"===this.type)return T(t.coordinates,this.coordinates);if("LineString"===this.type||"MultiPoint"===this.type){if(!this.coordinates||0===this.coordinates.length)return!1;for(n=0;n<this.coordinates.length;n++)if(T(t.coordinates,this.coordinates[n])===!1)return!1;return!0}if("MultiLineString"===this.type){for(n=0;n<this.coordinates.length;n++){var r=new U(this.coordinates[n]);if(r.within(t)===!1)return i++,!1}return!0}if("MultiPolygon"===this.type){for(n=0;n<this.coordinates.length;n++){var s=new A({type:"Polygon",coordinates:this.coordinates[n]});if(s.within(t)===!1)return!1}return!0}}if("MultiPolygon"===t.type){if("Point"===this.type){if(t.coordinates.length)for(n=0;n<t.coordinates.length;n++)if(e=t.coordinates[n],T(e,this.coordinates)&&k([this.coordinates],t.coordinates)===!1)return!0;return!1}if("Polygon"===this.type){for(n=0;n<this.coordinates.length;n++)if(t.coordinates[n].length===this.coordinates.length)for(j=0;j<this.coordinates.length;j++)if(I(this.coordinates[j],t.coordinates[n][j]))return!0;if(k(this.coordinates,t.coordinates)===!1&&t.coordinates.length){for(n=0;n<t.coordinates.length;n++)e=t.coordinates[n],i=T(e,this.coordinates[0][0])===!1?!1:!0;return i}}else if("LineString"===this.type||"MultiPoint"===this.type)for(n=0;n<t.coordinates.length;n++){var a={type:"Polygon",coordinates:t.coordinates[n]};return this.within(a)?!0:!1}else{if("MultiLineString"===this.type){for(n=0;n<this.coordinates.length;n++){var h=new U(this.coordinates[n]);if(h.within(t)===!1)return!1}return!0}if("MultiPolygon"===this.type){for(n=0;n<t.coordinates.length;n++){var l={type:"Polygon",coordinates:t.coordinates[n]};if(this.within(l)===!1)return!1}return!0}}}return!1},A.prototype.intersects=function(t){"Feature"===t.type&&(t=t.geometry);var n=new A(t);if(this.within(t)||n.within(this))return!0;if("Point"!==this.type&&"MultiPoint"!==this.type&&"Point"!==t.type&&"MultiPoint"!==t.type)return k(this.coordinates,t.coordinates);if("Feature"===this.type){var i=new A(this.geometry);return i.intersects(t)}return e("Type "+this.type+" to "+t.type+" intersection is not supported by intersects"),!1},O.prototype=new A,O.prototype.constructor=O,R.prototype=new A,R.prototype.constructor=R,R.prototype.forEach=function(t){for(var e=0;e<this.coordinates.length;e++)t.apply(this,[this.coordinates[e],e,this.coordinates]);return this},R.prototype.addPoint=function(t){return this.coordinates.push(t),this},R.prototype.insertPoint=function(t,e){return this.coordinates.splice(e,0,t),this},R.prototype.removePoint=function(t){return"number"==typeof t?this.coordinates.splice(t,1):this.coordinates.splice(this.coordinates.indexOf(t),1),this},R.prototype.get=function(t){return new O(this.coordinates[t])},U.prototype=new A,U.prototype.constructor=U,U.prototype.addVertex=function(t){return this.coordinates.push(t),this},U.prototype.insertVertex=function(t,e){return this.coordinates.splice(e,0,t),this},U.prototype.removeVertex=function(t){return this.coordinates.splice(t,1),this},N.prototype=new A,N.prototype.constructor=N,N.prototype.forEach=function(t){for(var e=0;e<this.coordinates.length;e++)t.apply(this,[this.coordinates[e],e,this.coordinates])},N.prototype.get=function(t){return new U(this.coordinates[t])},B.prototype=new A,B.prototype.constructor=B,B.prototype.addVertex=function(t){return this.insertVertex(t,this.coordinates[0].length-1),this},B.prototype.insertVertex=function(t,e){return this.coordinates[0].splice(e,0,t),this},B.prototype.removeVertex=function(t){return this.coordinates[0].splice(t,1),this},B.prototype.close=function(){this.coordinates=S(this.coordinates)},B.prototype.hasHoles=function(){return this.coordinates.length>1},B.prototype.holes=function(){if(holes=[],this.hasHoles())for(var t=1;t<this.coordinates.length;t++)holes.push(new B([this.coordinates[t]]));return holes},z.prototype=new A,z.prototype.constructor=z,z.prototype.forEach=function(t){for(var e=0;e<this.coordinates.length;e++)t.apply(this,[this.coordinates[e],e,this.coordinates])},z.prototype.get=function(t){return new B(this.coordinates[t])},z.prototype.close=function(){var t=[];return this.forEach(function(e){t.push(S(e))}),this.coordinates=t,this},Z.prototype=new A,Z.prototype.constructor=Z,H.prototype=new A,H.prototype.constructor=H,H.prototype.forEach=function(t){for(var e=0;e<this.features.length;e++)t.apply(this,[this.features[e],e,this.features])},H.prototype.get=function(t){var e;return this.forEach(function(n){n.id===t&&(e=n)}),new Z(e)},G.prototype=new A,G.prototype.constructor=G,G.prototype.forEach=function(t){for(var e=0;e<this.geometries.length;e++)t.apply(this,[this.geometries[e],e,this.geometries])},G.prototype.get=function(t){return new A(this.geometries[t])},W.prototype=new A,W.prototype.constructor=W,W.prototype.recalculate=function(){return this.geometry=F(this.properties.center,this.properties.radius,this.properties.steps),this},W.prototype.center=function(t){return t&&(this.properties.center=t,this.recalculate()),this.properties.center},W.prototype.radius=function(t){return t&&(this.properties.radius=t,this.recalculate()),this.properties.radius},W.prototype.steps=function(t){return t&&(this.properties.steps=t,this.recalculate()),this.properties.steps},W.prototype.toJSON=function(){var t=A.prototype.toJSON.call(this);return t},q.Primitive=A,q.Point=O,q.MultiPoint=R,q.LineString=U,q.MultiLineString=N,q.Polygon=B,q.MultiPolygon=z,q.Feature=Z,q.FeatureCollection=H,q.GeometryCollection=G,q.Circle=W,q.toMercator=_,q.toGeographic=g,q.Tools={},q.Tools.positionToMercator=f,q.Tools.positionToGeographic=p,q.Tools.applyConverter=m,q.Tools.toMercator=_,q.Tools.toGeographic=g,q.Tools.createCircle=F,q.Tools.calculateBounds=i,q.Tools.calculateEnvelope=l,q.Tools.coordinatesContainPoint=P,q.Tools.polygonContainsPoint=T,q.Tools.arraysIntersectArrays=k,q.Tools.coordinatesContainPoint=P,q.Tools.coordinatesEqual=I,q.Tools.convexHull=E,q.Tools.isConvex=x,q.MercatorCRS=X,q.GeographicCRS=$,q})},{}],55:[function(t,e,n){function i(t){return t.replace(/^\s*|\s*$/g,"")}n=e.exports=i,n.left=function(t){return t.replace(/^\s*/,"")},n.right=function(t){return t.replace(/\s*$/,"")}},{}],56:[function(t,e,n){function i(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function o(t,e,n){if(t&&l(t)&&t instanceof i)return t;var o=new i;return o.parse(t,e,n),o}function r(t){return h(t)&&(t=o(t)),t instanceof i?t.format():i.prototype.format.call(t)}function s(t,e){return o(t,!1,!0).resolve(e)}function a(t,e){return t?o(t,!1,!0).resolveObject(e):e}function h(t){return"string"==typeof t}function l(t){return"object"==typeof t&&null!==t}function c(t){return null===t}function u(t){return null==t}var d=t("punycode");n.parse=o,n.resolve=s,n.resolveObject=a,n.format=r,n.Url=i;var p=/^([a-z0-9.+-]+:)/i,f=/:[0-9]*$/,m=["<",">",'"',"`"," ","\r","\n","	"],_=["{","}","|","\\","^","`"].concat(m),g=["'"].concat(_),v=["%","/","?",";","#"].concat(g),y=["/","?","#"],L=255,b=/^[a-z0-9A-Z_-]{0,63}$/,w=/^([a-z0-9A-Z_-]{0,63})(.*)$/,E={javascript:!0,"javascript:":!0},x={javascript:!0,"javascript:":!0},P={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},T=t("querystring");i.prototype.parse=function(t,e,n){if(!h(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var i=t;i=i.trim();var o=p.exec(i);if(o){o=o[0];var r=o.toLowerCase();this.protocol=r,i=i.substr(o.length)}if(n||o||i.match(/^\/\/[^@\/]+@[^@\/]+/)){var s="//"===i.substr(0,2);!s||o&&x[o]||(i=i.substr(2),this.slashes=!0)}if(!x[o]&&(s||o&&!P[o])){for(var a=-1,l=0;l<y.length;l++){var c=i.indexOf(y[l]);-1!==c&&(-1===a||a>c)&&(a=c)}var u,f;f=-1===a?i.lastIndexOf("@"):i.lastIndexOf("@",a),-1!==f&&(u=i.slice(0,f),i=i.slice(f+1),this.auth=decodeURIComponent(u)),a=-1;for(var l=0;l<v.length;l++){var c=i.indexOf(v[l]);-1!==c&&(-1===a||a>c)&&(a=c)}-1===a&&(a=i.length),this.host=i.slice(0,a),i=i.slice(a),this.parseHost(),this.hostname=this.hostname||"";var m="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!m)for(var _=this.hostname.split(/\./),l=0,C=_.length;C>l;l++){var M=_[l];if(M&&!M.match(b)){for(var k="",S=0,D=M.length;D>S;S++)k+=M.charCodeAt(S)>127?"x":M[S];if(!k.match(b)){var I=_.slice(0,l),A=_.slice(l+1),O=M.match(w);O&&(I.push(O[1]),A.unshift(O[2])),A.length&&(i="/"+A.join(".")+i),this.hostname=I.join(".");break}}}if(this.hostname.length>L?this.hostname="":this.hostname=this.hostname.toLowerCase(),!m){for(var R=this.hostname.split("."),U=[],l=0;l<R.length;++l){var N=R[l];U.push(N.match(/[^A-Za-z0-9_-]/)?"xn--"+d.encode(N):N)}this.hostname=U.join(".")}var B=this.port?":"+this.port:"",z=this.hostname||"";this.host=z+B,this.href+=this.host,m&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==i[0]&&(i="/"+i))}if(!E[r])for(var l=0,C=g.length;C>l;l++){var j=g[l],Z=encodeURIComponent(j);Z===j&&(Z=escape(j)),i=i.split(j).join(Z)}var H=i.indexOf("#");-1!==H&&(this.hash=i.substr(H),i=i.slice(0,H));var G=i.indexOf("?");if(-1!==G?(this.search=i.substr(G),this.query=i.substr(G+1),e&&(this.query=T.parse(this.query)),i=i.slice(0,G)):e&&(this.search="",this.query={}),i&&(this.pathname=i),P[r]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var B=this.pathname||"",N=this.search||"";this.path=B+N}return this.href=this.format(),this},i.prototype.format=function(){var t=this.auth||"";t&&(t=encodeURIComponent(t),t=t.replace(/%3A/i,":"),t+="@");var e=this.protocol||"",n=this.pathname||"",i=this.hash||"",o=!1,r="";this.host?o=t+this.host:this.hostname&&(o=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&l(this.query)&&Object.keys(this.query).length&&(r=T.stringify(this.query));var s=this.search||r&&"?"+r||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||P[e])&&o!==!1?(o="//"+(o||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):o||(o=""),i&&"#"!==i.charAt(0)&&(i="#"+i),s&&"?"!==s.charAt(0)&&(s="?"+s),n=n.replace(/[?#]/g,function(t){return encodeURIComponent(t)}),s=s.replace("#","%23"),e+o+n+s+i},i.prototype.resolve=function(t){return this.resolveObject(o(t,!1,!0)).format()},i.prototype.resolveObject=function(t){if(h(t)){var e=new i;e.parse(t,!1,!0),t=e}var n=new i;if(Object.keys(this).forEach(function(t){n[t]=this[t]},this),n.hash=t.hash,""===t.href)return n.href=n.format(),n;if(t.slashes&&!t.protocol)return Object.keys(t).forEach(function(e){"protocol"!==e&&(n[e]=t[e])}),P[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n;if(t.protocol&&t.protocol!==n.protocol){if(!P[t.protocol])return Object.keys(t).forEach(function(e){n[e]=t[e]}),n.href=n.format(),n;if(n.protocol=t.protocol,t.host||x[t.protocol])n.pathname=t.pathname;else{for(var o=(t.pathname||"").split("/");o.length&&!(t.host=o.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==o[0]&&o.unshift(""),o.length<2&&o.unshift(""),n.pathname=o.join("/")}if(n.search=t.search,n.query=t.query,n.host=t.host||"",n.auth=t.auth,n.hostname=t.hostname||t.host,n.port=t.port,n.pathname||n.search){var r=n.pathname||"",s=n.search||"";n.path=r+s}return n.slashes=n.slashes||t.slashes,n.href=n.format(),n}var a=n.pathname&&"/"===n.pathname.charAt(0),l=t.host||t.pathname&&"/"===t.pathname.charAt(0),d=l||a||n.host&&t.pathname,p=d,f=n.pathname&&n.pathname.split("/")||[],o=t.pathname&&t.pathname.split("/")||[],m=n.protocol&&!P[n.protocol];if(m&&(n.hostname="",n.port=null,n.host&&(""===f[0]?f[0]=n.host:f.unshift(n.host)),n.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===o[0]?o[0]=t.host:o.unshift(t.host)),t.host=null),d=d&&(""===o[0]||""===f[0])),l)n.host=t.host||""===t.host?t.host:n.host,n.hostname=t.hostname||""===t.hostname?t.hostname:n.hostname,n.search=t.search,n.query=t.query,f=o;else if(o.length)f||(f=[]),f.pop(),f=f.concat(o),n.search=t.search,n.query=t.query;else if(!u(t.search)){if(m){n.hostname=n.host=f.shift();var _=n.host&&n.host.indexOf("@")>0?n.host.split("@"):!1;_&&(n.auth=_.shift(),n.host=n.hostname=_.shift())}return n.search=t.search,n.query=t.query,c(n.pathname)&&c(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!f.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var g=f.slice(-1)[0],v=(n.host||t.host)&&("."===g||".."===g)||""===g,y=0,L=f.length;L>=0;L--)g=f[L],"."==g?f.splice(L,1):".."===g?(f.splice(L,1),y++):y&&(f.splice(L,1),y--);if(!d&&!p)for(;y--;y)f.unshift("..");!d||""===f[0]||f[0]&&"/"===f[0].charAt(0)||f.unshift(""),v&&"/"!==f.join("/").substr(-1)&&f.push("");var b=""===f[0]||f[0]&&"/"===f[0].charAt(0);if(m){n.hostname=n.host=b?"":f.length?f.shift():"";var _=n.host&&n.host.indexOf("@")>0?n.host.split("@"):!1;_&&(n.auth=_.shift(),n.host=n.hostname=_.shift())}return d=d||n.host&&f.length,d&&!b&&f.unshift(""),f.length?n.pathname=f.join("/"):(n.pathname=null,n.path=null),c(n.pathname)&&c(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=t.auth||n.auth,n.slashes=n.slashes||t.slashes,n.href=n.format(),n},i.prototype.parseHost=function(){var t=this.host,e=f.exec(t);e&&(e=e[0],":"!==e&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)}},{punycode:31,querystring:35}],57:[function(t,e,n){arguments[4][23][0].apply(n,arguments)},{dup:23}],58:[function(t,e,n){e.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},{}],59:[function(t,e,n){(function(e,i){function o(t,e){var i={seen:[],stylize:s};return arguments.length>=3&&(i.depth=arguments[2]),arguments.length>=4&&(i.colors=arguments[3]),m(e)?i.showHidden=e:e&&n._extend(i,e),b(i.showHidden)&&(i.showHidden=!1),b(i.depth)&&(i.depth=2),b(i.colors)&&(i.colors=!1),b(i.customInspect)&&(i.customInspect=!0),i.colors&&(i.stylize=r),h(i,t,i.depth)}function r(t,e){var n=o.styles[e];return n?"["+o.colors[n][0]+"m"+t+"["+o.colors[n][1]+"m":t}function s(t,e){return t}function a(t){var e={};return t.forEach(function(t,n){e[t]=!0}),e}function h(t,e,i){if(t.customInspect&&e&&T(e.inspect)&&e.inspect!==n.inspect&&(!e.constructor||e.constructor.prototype!==e)){var o=e.inspect(i,t);return y(o)||(o=h(t,o,i)),o}var r=l(t,e);if(r)return r;var s=Object.keys(e),m=a(s);if(t.showHidden&&(s=Object.getOwnPropertyNames(e)),P(e)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return c(e);if(0===s.length){if(T(e)){var _=e.name?": "+e.name:"";return t.stylize("[Function"+_+"]","special")}if(w(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(x(e))return t.stylize(Date.prototype.toString.call(e),"date");if(P(e))return c(e)}var g="",v=!1,L=["{","}"];if(f(e)&&(v=!0,L=["[","]"]),T(e)){var b=e.name?": "+e.name:"";g=" [Function"+b+"]"}if(w(e)&&(g=" "+RegExp.prototype.toString.call(e)),x(e)&&(g=" "+Date.prototype.toUTCString.call(e)),P(e)&&(g=" "+c(e)),0===s.length&&(!v||0==e.length))return L[0]+g+L[1];if(0>i)return w(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special");t.seen.push(e);var E;return E=v?u(t,e,i,m,s):s.map(function(n){return d(t,e,i,m,n,v)}),t.seen.pop(),p(E,g,L)}function l(t,e){if(b(e))return t.stylize("undefined","undefined");if(y(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}return v(e)?t.stylize(""+e,"number"):m(e)?t.stylize(""+e,"boolean"):_(e)?t.stylize("null","null"):void 0}function c(t){return"["+Error.prototype.toString.call(t)+"]"}function u(t,e,n,i,o){for(var r=[],s=0,a=e.length;a>s;++s)D(e,String(s))?r.push(d(t,e,n,i,String(s),!0)):r.push("");return o.forEach(function(o){o.match(/^\d+$/)||r.push(d(t,e,n,i,o,!0))}),r}function d(t,e,n,i,o,r){var s,a,l;if(l=Object.getOwnPropertyDescriptor(e,o)||{value:e[o]},l.get?a=l.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):l.set&&(a=t.stylize("[Setter]","special")),D(i,o)||(s="["+o+"]"),a||(t.seen.indexOf(l.value)<0?(a=_(n)?h(t,l.value,null):h(t,l.value,n-1),a.indexOf("\n")>-1&&(a=r?a.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+a.split("\n").map(function(t){return"   "+t}).join("\n"))):a=t.stylize("[Circular]","special")),b(s)){if(r&&o.match(/^\d+$/))return a;s=JSON.stringify(""+o),s.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=t.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=t.stylize(s,"string"))}return s+": "+a}function p(t,e,n){var i=0,o=t.reduce(function(t,e){return i++,e.indexOf("\n")>=0&&i++,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0);return o>60?n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1]:n[0]+e+" "+t.join(", ")+" "+n[1]}function f(t){return Array.isArray(t)}function m(t){return"boolean"==typeof t}function _(t){return null===t}function g(t){return null==t}function v(t){return"number"==typeof t}function y(t){return"string"==typeof t}function L(t){return"symbol"==typeof t}function b(t){return void 0===t}function w(t){return E(t)&&"[object RegExp]"===M(t)}function E(t){return"object"==typeof t&&null!==t}function x(t){return E(t)&&"[object Date]"===M(t)}function P(t){return E(t)&&("[object Error]"===M(t)||t instanceof Error)}function T(t){return"function"==typeof t}function C(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||"undefined"==typeof t}function M(t){return Object.prototype.toString.call(t)}function k(t){return 10>t?"0"+t.toString(10):t.toString(10)}function S(){var t=new Date,e=[k(t.getHours()),k(t.getMinutes()),k(t.getSeconds())].join(":");return[t.getDate(),R[t.getMonth()],e].join(" ")}function D(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var I=/%[sdj%]/g;n.format=function(t){if(!y(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(o(arguments[n]));return e.join(" ")}for(var n=1,i=arguments,r=i.length,s=String(t).replace(I,function(t){if("%%"===t)return"%";if(n>=r)return t;switch(t){case"%s":return String(i[n++]);case"%d":return Number(i[n++]);case"%j":try{return JSON.stringify(i[n++])}catch(e){return"[Circular]"}default:return t}}),a=i[n];r>n;a=i[++n])s+=_(a)||!E(a)?" "+a:" "+o(a);return s},n.deprecate=function(t,o){function r(){if(!s){if(e.throwDeprecation)throw new Error(o);e.traceDeprecation?console.trace(o):console.error(o),s=!0}return t.apply(this,arguments)}if(b(i.process))return function(){return n.deprecate(t,o).apply(this,arguments)};if(e.noDeprecation===!0)return t;var s=!1;return r};var A,O={};n.debuglog=function(t){if(b(A)&&(A=e.env.NODE_DEBUG||""),t=t.toUpperCase(),!O[t])if(new RegExp("\\b"+t+"\\b","i").test(A)){var i=e.pid;O[t]=function(){var e=n.format.apply(n,arguments);console.error("%s %d: %s",t,i,e)}}else O[t]=function(){};return O[t]},n.inspect=o,o.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},o.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},n.isArray=f,n.isBoolean=m,n.isNull=_,n.isNullOrUndefined=g,n.isNumber=v,n.isString=y,n.isSymbol=L,n.isUndefined=b,n.isRegExp=w,n.isObject=E,n.isDate=x,n.isError=P,n.isFunction=T,n.isPrimitive=C,n.isBuffer=t("./support/isBuffer");var R=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];n.log=function(){console.log("%s - %s",S(),n.format.apply(n,arguments))},n.inherits=t("inherits"),n._extend=function(t,e){if(!e||!E(e))return t;for(var n=Object.keys(e),i=n.length;i--;)t[n[i]]=e[n[i]];return t}}).call(this,t("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":58,_process:7,inherits:57}],60:[function(t,e,n){(function(e,i){var o=t("url"),r=t("child_process").spawn,s=t("fs");n.XMLHttpRequest=function(){var n,a,h=this,l=t("http"),c=t("https"),u={},d=!1,p={"User-Agent":"node-XMLHttpRequest",Accept:"*/*"},f=p,m=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","content-transfer-encoding","cookie","cookie2","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","via"],_=["TRACE","TRACK","CONNECT"],g=!1,v=!1,y={};this.UNSENT=0,this.OPENED=1,this.HEADERS_RECEIVED=2,this.LOADING=3,this.DONE=4,this.readyState=this.UNSENT,this.onreadystatechange=null,this.responseText="",this.responseXML="",this.status=null,this.statusText=null;var L=function(t){return d||t&&-1===m.indexOf(t.toLowerCase())},b=function(t){return t&&-1===_.indexOf(t)};this.open=function(t,e,n,i,o){if(this.abort(),v=!1,!b(t))throw"SecurityError: Request method not allowed";u={method:t,url:e.toString(),async:"boolean"!=typeof n?!0:n,user:i||null,password:o||null},w(this.OPENED)},this.setDisableHeaderCheck=function(t){d=t},this.setRequestHeader=function(t,e){if(this.readyState!=this.OPENED)throw"INVALID_STATE_ERR: setRequestHeader can only be called when state is OPEN";if(!L(t))return void console.warn('Refused to set unsafe header "'+t+'"');if(g)throw"INVALID_STATE_ERR: send flag is true";f[t]=e},this.getResponseHeader=function(t){return"string"==typeof t&&this.readyState>this.OPENED&&a.headers[t.toLowerCase()]&&!v?a.headers[t.toLowerCase()]:null},this.getAllResponseHeaders=function(){if(this.readyState<this.HEADERS_RECEIVED||v)return"";var t="";for(var e in a.headers)"set-cookie"!==e&&"set-cookie2"!==e&&(t+=e+": "+a.headers[e]+"\r\n");return t.substr(0,t.length-2)},this.getRequestHeader=function(t){return"string"==typeof t&&f[t]?f[t]:""},this.send=function(t){function d(t){if(a=t,302===a.statusCode||303===a.statusCode||307===a.statusCode){u.url=a.headers.location;var e=o.parse(u.url);m=e.hostname;var i={hostname:e.hostname,port:e.port,path:e.path,method:303===a.statusCode?"GET":u.method,headers:f};return n=C(i,d).on("error",p),void n.end()}a.setEncoding("utf8"),w(h.HEADERS_RECEIVED),h.status=a.statusCode,a.on("data",function(t){t&&(h.responseText+=t),g&&w(h.LOADING)}),a.on("end",function(){g&&(w(h.DONE),g=!1)}),a.on("error",function(t){h.handleError(t)})}function p(t){h.handleError(t)}if(this.readyState!=this.OPENED)throw"INVALID_STATE_ERR: connection must be opened before send() is called";if(g)throw"INVALID_STATE_ERR: send has already been called";var m,_=!1,y=!1,L=o.parse(u.url);switch(L.protocol){case"https:":_=!0;case"http:":m=L.hostname;break;case"file:":y=!0;break;case void 0:case"":m="localhost";break;default:throw"Protocol not supported."}if(y){if("GET"!==u.method)throw"XMLHttpRequest: Only GET method is supported";if(u.async)s.readFile(L.pathname,"utf8",function(t,e){t?h.handleError(t):(h.status=200,h.responseText=e,w(h.DONE))});else try{this.responseText=s.readFileSync(L.pathname,"utf8"),this.status=200,w(h.DONE)}catch(b){this.handleError(b)}}else{var E=L.port||(_?443:80),x=L.pathname+(L.search?L.search:"");if(f.Host=m,_&&443===E||80===E||(f.Host+=":"+L.port),u.user){"undefined"==typeof u.password&&(u.password="");var P=new i(u.user+":"+u.password);f.Authorization="Basic "+P.toString("base64")}"GET"===u.method||"HEAD"===u.method?t=null:t?(f["Content-Length"]=i.isBuffer(t)?t.length:i.byteLength(t),f["Content-Type"]||(f["Content-Type"]="text/plain;charset=UTF-8")):"POST"===u.method&&(f["Content-Length"]=0);var T={host:m,port:E,path:x,method:u.method,headers:f,agent:!1};if(v=!1,u.async){var C=_?c.request:l.request;
g=!0,h.dispatchEvent("readystatechange"),n=C(T,d).on("error",p),t&&n.write(t),n.end(),h.dispatchEvent("loadstart")}else{var M=".node-xmlhttprequest-content-"+e.pid,k=".node-xmlhttprequest-sync-"+e.pid;s.writeFileSync(k,"","utf8");for(var S="var http = require('http'), https = require('https'), fs = require('fs');var doRequest = http"+(_?"s":"")+".request;var options = "+JSON.stringify(T)+";var responseText = '';var req = doRequest(options, function(response) {response.setEncoding('utf8');response.on('data', function(chunk) {  responseText += chunk;});response.on('end', function() {fs.writeFileSync('"+M+"', 'NODE-XMLHTTPREQUEST-STATUS:' + response.statusCode + ',' + responseText, 'utf8');fs.unlinkSync('"+k+"');});response.on('error', function(error) {fs.writeFileSync('"+M+"', 'NODE-XMLHTTPREQUEST-ERROR:' + JSON.stringify(error), 'utf8');fs.unlinkSync('"+k+"');});}).on('error', function(error) {fs.writeFileSync('"+M+"', 'NODE-XMLHTTPREQUEST-ERROR:' + JSON.stringify(error), 'utf8');fs.unlinkSync('"+k+"');});"+(t?"req.write('"+t.replace(/'/g,"\\'")+"');":"")+"req.end();",D=r(e.argv[0],["-e",S]);s.existsSync(k););if(h.responseText=s.readFileSync(M,"utf8"),D.stdin.end(),s.unlinkSync(M),h.responseText.match(/^NODE-XMLHTTPREQUEST-ERROR:/)){var I=h.responseText.replace(/^NODE-XMLHTTPREQUEST-ERROR:/,"");h.handleError(I)}else h.status=h.responseText.replace(/^NODE-XMLHTTPREQUEST-STATUS:([0-9]*),.*/,"$1"),h.responseText=h.responseText.replace(/^NODE-XMLHTTPREQUEST-STATUS:[0-9]*,(.*)/,"$1"),w(h.DONE)}}},this.handleError=function(t){this.status=503,this.statusText=t,this.responseText=t.stack,v=!0,w(this.DONE)},this.abort=function(){n&&(n.abort(),n=null),f=p,this.responseText="",this.responseXML="",v=!0,this.readyState===this.UNSENT||this.readyState===this.OPENED&&!g||this.readyState===this.DONE||(g=!1,w(this.DONE)),this.readyState=this.UNSENT},this.addEventListener=function(t,e){t in y||(y[t]=[]),y[t].push(e)},this.removeEventListener=function(t,e){t in y&&(y[t]=y[t].filter(function(t){return t!==e}))},this.dispatchEvent=function(t){if("function"==typeof h["on"+t]&&h["on"+t](),t in y)for(var e=0,n=y[t].length;n>e;e++)y[t][e].call(h)};var w=function(t){h.readyState!==t&&(h.readyState=t,(u.async||h.readyState<h.OPENED||h.readyState===h.DONE)&&h.dispatchEvent("readystatechange"),h.readyState!==h.DONE||v||(h.dispatchEvent("load"),h.dispatchEvent("loadend")))}}}).call(this,t("_process"),t("buffer").Buffer)},{_process:7,buffer:8,child_process:6,fs:6,http:18,https:21,url:56}],61:[function(t,e,n){(function(n){function i(t,e){t.setAttribute("data-results",e.results);var n=document.createElement("tr"),i=document.createElement("th");i.textContent="taxa",n.appendChild(i),i=document.createElement("th"),i.textContent="lat",n.appendChild(i),i=document.createElement("th"),i.textContent="lng",n.appendChild(i),i=document.createElement("th"),i.textContent="eventStartDate",n.appendChild(i),i=document.createElement("th"),i.textContent="occurrence id",n.appendChild(i),i=document.createElement("th"),i.textContent="firstAddedDate",n.appendChild(i),t.appendChild(n),e.items.forEach(function(e){var n=document.createElement("tr");n.setAttribute("class","occurrence");var i=document.createElement("td"),o=e.taxon.split("|").reduce(function(t,e){if(0==e.length)return t.concat([s.sepElem()]);var n=document.createElement("span");return n.setAttribute("class",s.classNameFor(e)),n.textContent=e,t.concat([n,s.sepElem()])},[]);o.forEach(function(t){i.appendChild(t)}),n.appendChild(i);var r=n.appendChild(document.createElement("td"));r.textContent=e.lat,r=n.appendChild(document.createElement("td")),r.textContent=e.lng,r=n.appendChild(document.createElement("td")),r.textContent=new Date(e.start).toISOString(),r=n.appendChild(document.createElement("td"));var a=r.appendChild(document.createElement("a"));a.setAttribute("href",s.urlForOccurrence(e)),a.setAttribute("title","visit associated external url"),a.setAttribute("target","_blank"),a.textContent=e.id,r=n.appendChild(document.createElement("td")),r.textContent=new Date(e.added).toISOString(),t.appendChild(n)})}function o(){return s.xhr()}function r(){s.removeChildrenAll(".effechecka-results"),s.removeChildrenAll(".effechecka-status"),m("none requested")}var s=t("./util.js"),a=t("taxon"),h={};e.exports=h;var l=function(t){return s.createRequestURL(t,"occurrences")},c=function(t){s.removeChildren("#download"),t.limit&&delete t.limit;var e=document.querySelector("#download"),n=function(t,n){e.appendChild(document.createElement("span")).textContent=n;var i=s.createRequestURL(t,"occurrences.tsv"),o=e.appendChild(document.createElement("a"));o.setAttribute("href",i),o.setAttribute("title","download all results as tsv (tab separated values) file"),o.textContent="tsv"},i=Object.keys(t).filter(function(t){return-1===["addedAfter","addedBefore"].indexOf(t)}),o=i.reduce(function(e,n){return e[n]=t[n],e},{});if(n(o,"... save all records as "),Object.keys(t).length!==i.length){var r=[];void 0!==t.addedAfter&&r.push("after ["+t.addedAfter+"]"),void 0!==t.addedBefore&&r.push("before ["+t.addedBefore+"]"),n(t," or save all records added "+r.join(" and ")+" as ")}e.appendChild(document.createElement("span")).textContent=". View ";var a=s.createQuery(t),h=e.appendChild(document.createElement("a"));h.setAttribute("href","http://effechecka.org?"+a),h.setAttribute("target","_blank"),h.setAttribute("title","view or generate associated taxonomic checklist"),h.textContent="associated checklist",e.appendChild(document.createElement("span")).textContent=". "},u=function(t){var e=s.createRequestURL(t,"monitors"),n=o();void 0!==n&&(n.open("GET",e,!0),n.onreadystatechange=function(){if(4===n.readyState&&200===n.status){var t=JSON.parse(n.responseText);if(t.recordCount){var e=document.querySelector("#effechecka-occurrences-summary");if(e){var i="["+t.recordCount+"] matching occurrences";t.recordCount>20&&(i=i.concat(" (first 20 shown below)")),e.textContent=i}}}}),n.send(null)},d=function(t,e){if(t.items){var n=document.querySelector("#occurrences");if(t.items.length>0){i(n,t);var o=t.items.reduce(function(t,e){return e.taxon&&(t=t.concat(s.lastNameFromPath(e.taxon))),t},[]);m("linking to eol pages..."),a.eolPageIdsFor(o,function(t){s.addHyperlinksForNames(t),m("ready")}),u(e.getDataFilter()),c(e.getDataFilter())}else{var h={requested:"working on your occurrences..."},l=h[t.status]||t.status;if(m(l),"ready"===t.status){var d=document.querySelector("#download"),p=d.appendChild(document.createElement("span")),_="The occurrences you've requested contains no items. Bummer! You might want to try changing your search parameters",g=document.createElement("button");g.textContent="removing your trait selectors",g.title="remove your trait selectors",g.addEventListener("click",function(t){e.removeTraitSelectors(),r(),f(e)},!1),e.hasTraitSelectors()?(p.textContent=_+" by ",d.appendChild(g),d.appendChild(document.createElement("span")).textContent="."):p.textContent=_+"."}}}},p=function(t){s.requestSelected(l(t.getDataFilter()),t,d,m)},f=function(t){r(),p(t)},m=function(t){document.querySelector("#occurrencesStatus").textContent=t};h.select=function(t){var e=function(e){var n=document.querySelector(e);n.addEventListener("click",function(e){f(t)},!1)};r(),["#requestOccurrences"].forEach(function(t){e(t)});var n=document.querySelector("#effechecka-subscribe");n&&n.addEventListener("click",function(e){function n(e,n){var i=document.querySelector(e);if(i&&!i.validity.typeMismatch&&i.value.length>0){var r=i.value,a=t.getDataFilter();a.subscriber=n+r;var h=s.createRequestURL(a,"subscribe"),l=o();void 0!==l&&(l.open("GET",h,!0),l.onreadystatechange=function(){if(4===l.readyState&&200===l.status){var t=document.querySelector("#effechecka-subscribe-status");if(t){s.removeChildren("#effechecka-subscribe-status");var e=t.appendChild(document.createElement("span"));e.textContent="["+r+"] is now subscribed: you should receive a confirmation email shortly."}}}),l.send(null)}}n("#effechecka-email","mailto:"),n("#effechecka-webhook","")},!1);var i=function(e){var n=document.querySelector(e.buttonQuery);n&&n.addEventListener("click",function(n){var i=t.getDataFilter(),r=s.createRequestURL(i,e.endpoint),a=o();void 0!==a&&(a.open("GET",r,!0),a.onreadystatechange=function(){if(4===a.readyState&&200===a.status){var t=document.querySelector(e.statusQuery);if(t){s.removeChildren(e.statusQuery);var n=t.appendChild(document.createElement("span"));n.textContent=e.statusText}}}),a.send(null)},!1)};i({endpoint:"notify",buttonQuery:"#effechecka-notification-test",statusQuery:"#effechecka-notification-test-status",statusText:"Subscribers should be notified immediately if search was already initialized and occurrences exists that matches the search criteria."});var a=function(){r()};t.on("update",function(){a()}),t.on("ready",function(){f(t)})},h.addTo=function(t){t&&(t.innerHTML=n("PGJyLz4KPHA+SW5jbHVkZSBvY2N1cnJlbmNlcyBmaXJzdCBhZGRlZCB0byBGcmVzaCBEYXRhIGFmdGVyIDxpbnB1dCBpZD0iZWZmZWNoZWNrYS1hZGRlZEFmdGVyIiBwbGFjZWhvbGRlcj0iZS5nLiAyMDE1LTAyLTE4IiBhdXRvY29tcGxldGU9Im9mZiI+IGFuZAogICAgYmVmb3JlIDxpbnB1dCBpZD0iZWZmZWNoZWNrYS1hZGRlZEJlZm9yZSIgcGxhY2Vob2xkZXI9ImUuZy4gMjAxNi0xMi0yMyIgYXV0b2NvbXBsZXRlPSJvZmYiPi48L3A+Cgo8ZGl2IGlkPSJvY2N1cnJlbmNlcy1jb250cm9scyI+CiAgICA8YnV0dG9uIGlkPSJyZXF1ZXN0T2NjdXJyZW5jZXMiPnJlcXVlc3Qgb2NjdXJyZW5jZXM8L2J1dHRvbj4KICAgIG9jY3VycmVuY2VzIHN0YXR1czogWzxiPjxzcGFuIGlkPSJvY2N1cnJlbmNlc1N0YXR1cyI+PC9zcGFuPjwvYj5dCiAgICA8YSBocmVmPSJodHRwczovL2dpdGh1Yi5jb20vamhwb2VsZW4vZWZmZWNoZWNrYS93aWtpL0Fib3V0I2NoZWNrbGlzdCIgdGFyZ2V0PSJfYmxhbmsiPj88L2E+CjwvZGl2PgoKPGJyLz4KCjxkaXYgaWQ9Im9jY3VycmVuY2VzLXJlc3VsdHMiPgogICAgPGI+T2NjdXJyZW5jZXM8L2I+IDxzcGFuIGlkPSJlZmZlY2hlY2thLW9jY3VycmVuY2VzLXN1bW1hcnkiIGNsYXNzPSJlZmZlY2hlY2thLXN0YXR1cyI+PC9zcGFuPgogICAgPHNwYW4gaWQ9ImRvd25sb2FkIiBjbGFzcz0iZWZmZWNoZWNrYS1yZXN1bHRzIj48L3NwYW4+CiAgICA8YnIvPgogICAgPGJyLz4KICAgIDx0YWJsZSBpZD0ib2NjdXJyZW5jZXMiIGNsYXNzPSJlZmZlY2hlY2thLXJlc3VsdHMiPjwvdGFibGU+CjwvZGl2Pgo=","base64"))}}).call(this,t("buffer").Buffer)},{"./util.js":63,buffer:8,taxon:51}],62:[function(t,e,n){(function(n){function i(t){var e=Array.prototype.slice.call(document.querySelectorAll(t));return e.reduce(function(t,e){var n=e.textContent.trim();return n.length>0&&(t=t.concat(e.textContent.trim())),t},[]).join(",")}function o(){var t=i(".taxonFilterElementName"),e=f();e.taxonSelector=t,m(e)}function r(t){var e=f();m(e)}function s(){var t=f();t.traitSelector=i(".traitFilterElement"),m(t)}var a=t("./util.js"),h=t("events").EventEmitter,l=t("globi-data"),c=t("leaflet"),u=(t("leaflet-draw"),t("terraformer-wkt-parser")),d={};e.exports=d;var p=function(){return"#selectorContainer"},f=function(){var t=document.querySelector(p()),e={limit:20};return t.hasAttribute("data-filter")&&(e=JSON.parse(t.getAttribute("data-filter"))),e},m=function(t){var e=JSON.stringify(t);document.querySelector(p()).setAttribute("data-filter",e),window.history.pushState({},"","?"+a.toHash(t))},_=function(t){var e=function(t){var e=[];return t.eachLayer(function(t){e.push(u.convert(t.toGeoJSON().geometry))}),a.wktStringsToGeometryCollection(e)},n=e(t),i=f(),o=!1;return n!==i.wktString&&(i.wktString=n,m(i),o=!0),o};d.createSelectors=function(t){function e(t,e){n.emit("update"),i(a.capitalize(t)),e.value="",a.removeChildren("#suggestions")}var t=t||{traits:[{value:"bodyMass",name:"body mass",units:[{name:"g",value:"g"},{name:"kg",value:"kg"}]}]},n=new h,i=function(t){var e=document.createElement("div");e.setAttribute("class","taxonFilterElement");var i=document.createElement("button");i.addEventListener("click",function(t){e.parentNode.removeChild(e),o(),n.emit("update")}),i.textContent="x",i.title="remove taxon selector";var r=document.createElement("span");r.setAttribute("class","taxonFilterElementName"),r.textContent=t,e.appendChild(i),e.appendChild(r),document.querySelector("#taxonFilter").appendChild(e),o()},p=function(t){var e=document.createElement("div"),i=document.createElement("button");i.textContent="x",i.title="remove trait selector",i.addEventListener("click",function(t){e.parentNode.removeChild(e),s(),n.emit("update")}),e.appendChild(i);var o=document.createElement("span");o.setAttribute("class","traitFilterElement"),o.textContent=t,e.appendChild(o),document.getElementById("traitFilter").appendChild(e),s()},g={limit:20,taxonSelector:"Aves,Insecta",traitSelector:"",wktString:"ENVELOPE(-72.147216796875,-69.949951171875,43.11702412135048,41.492120839687786)"},v=a.fromHash(document.location.search||document.location.hash,g);m(v);var y=c.map("map",{scrollWheelZoom:!1});d.map=y,c.tileLayer("http://{s}.tile.osm.org/{z}/{x}/{y}.png",{maxZoom:18,noWrap:!0,attribution:'&copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors'}).addTo(y);var L=a.geometryCollectionToWktStrings(v.wktString),b=L.map(function(t){return u.parse(t)}),w=c.geoJson(b).addTo(y),E=new c.Control.Draw({draw:{marker:!1,polyline:!1,circle:!1},edit:{featureGroup:w}});y.addControl(E),y.fitBounds(w.getBounds().pad(.1)),y.on("draw:created",function(t){w.addLayer(t.layer),_(w)&&(y.fitBounds(w.getBounds().pad(.1)),n.emit("update"))}),y.on("draw:edited draw:deleted",function(t){_(w)&&(y.fitBounds(w.getBounds().pad(.1)),n.emit("update"))}),y.on("moveend dragend zoomend",function(t){r(y),n.emit("update")});var x=v.taxonSelector.split(/[|,]/).filter(function(t){return t.length>0});x.forEach(function(t){i(t)});var P=function(t,e){var n=t.appendChild(document.createElement("option"));n.setAttribute("value",e.value),n.textContent=e.name};t.traits.forEach(function(t){P(document.querySelector("#traitName"),t)});var T=t.traits.reduce(function(t,e){return void 0!==e.units&&e.units.forEach(function(e){t[e.name]=e.value}),t},{});Object.keys(T).forEach(function(t){P(document.querySelector("#traitUnit"),{name:t,value:T[t]})});var C=v.traitSelector.split(/[|,]/).filter(function(t){return t.length>0});C.forEach(function(t){p(t)});var M=document.getElementById("addTraitSelector");M&&M.addEventListener("click",function(t){var e=document.getElementById("traitValue"),i=document.getElementById("traitName").value,o=document.getElementById("traitOperator").value,r=e.value,s=document.getElementById("traitUnit").value,a=[i,o,r,s].join(" ");n.emit("update"),p(a),e.value=""});var k=document.getElementById("addTaxonSelector");k&&k.addEventListener("click",function(t){var n=document.getElementById("taxonSelectorInput");e(n.value,n)});var S=document.getElementById("taxonSelectorInput");S.onkeyup=function(t){var n=a.removeChildren("#suggestions");if(S.value.length>2){var i=function(t){t.forEach(function(t){var i=t.scientificName;i.split(" ").length>1&&(i="<em>"+i+"</em>"),t.commonNames.en&&(i=t.commonNames.en+" ("+i+")");var o=document.createElement("li");o.innerHTML=i,o.addEventListener("click",function(n){e(t.scientificName.trim(),S)}),n.appendChild(o)})};l.findCloseTaxonMatches(S.value.trim(),i)}};var D=function(){o(),s(),r(y),_(w)};return n.init=function(){D(),n.emit("ready")},n.removeTraitSelectors=function(){a.removeChildren("#traitFilter"),s()},n.hasTraitSelectors=function(){document.querySelector(".traitFilterElement")},n.getDataFilter=f,n.setDataFilter=m,n},d.addTo=function(t){t&&(t.innerHTML=n("PGRpdiBpZD0ic2VsZWN0b3JDb250YWluZXIiPgogICAgPGRpdiBpZD0ibWFwIiBzdHlsZT0id2lkdGg6IDYwMHB4OyBoZWlnaHQ6IDQwMHB4Ij48L2Rpdj4KICAgIDxici8+CgogICAgPGRpdiBpZD0idGF4b25GaWx0ZXIiPjwvZGl2PgogICAgPGRpdiBpZD0idGF4b25TZWxlY3RvciI+CiAgICAgICAgPGlucHV0IGlkPSJ0YXhvblNlbGVjdG9ySW5wdXQiIGNsYXNzPSJlZGl0YWJsZSBjZW50ZXJlZCIgdHlwZT0idGV4dCIgcGxhY2Vob2xkZXI9ImFkZCB0YXhhIiBhdXRvY29tcGxldGU9Im9mZiI+CiAgICAgICAgPGJ1dHRvbiBpZD0iYWRkVGF4b25TZWxlY3RvciIgdGl0bGU9ImFkZCB0YXhvbiBzZWxlY3RvciI+KzwvYnV0dG9uPgogICAgICAgIDxhIGhyZWY9Imh0dHBzOi8vZ2l0aHViLmNvbS9qaHBvZWxlbi9lZmZlY2hlY2thL3dpa2kvQWJvdXQjdGF4b24tc2VsZWN0b3IiIHRhcmdldD0iX2JsYW5rIj4/PC9hPgogICAgICAgIDx1bCBpZD0ic3VnZ2VzdGlvbnMiPjwvdWw+CiAgICA8L2Rpdj4KCiAgICA8ZGl2IGlkPSJ0cmFpdEZpbHRlciI+PC9kaXY+CgogICAgPGRpdiBpZD0idHJhaXRFZGl0b3IiPgogICAgICAgIDxzZWxlY3QgaWQ9InRyYWl0TmFtZSI+PC9zZWxlY3Q+CiAgICAgICAgPHNlbGVjdCBpZD0idHJhaXRPcGVyYXRvciI+CiAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9IiZsdCI+Jmx0PC9vcHRpb24+CiAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9IiZndCI+Jmd0PC9vcHRpb24+CiAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9Ij09Ij49PTwvb3B0aW9uPgogICAgICAgIDwvc2VsZWN0PgogICAgICAgIDxpbnB1dCBpZD0idHJhaXRWYWx1ZSIgcGxhY2Vob2xkZXI9ImVudGVyIHRyYWl0IHZhbHVlIiBhdXRvY29tcGxldGU9Im9mZiIvPgogICAgICAgIDxzZWxlY3QgaWQ9InRyYWl0VW5pdCI+CiAgICAgICAgPC9zZWxlY3Q+CiAgICAgICAgPGJ1dHRvbiBpZD0iYWRkVHJhaXRTZWxlY3RvciIgdGl0bGU9ImFkZCB0cmFpdCBzZWxlY3RvciI+KzwvYnV0dG9uPgogICAgICAgIDxhIGhyZWY9Imh0dHBzOi8vZ2l0aHViLmNvbS9qaHBvZWxlbi9lZmZlY2hlY2thL3dpa2kvQWJvdXQjdHJhaXQtc2VsZWN0b3IiIHRhcmdldD0iX2JsYW5rIj4/PC9hPgogICAgPC9kaXY+CjwvZGl2Pgo=","base64"))}}).call(this,t("buffer").Buffer)},{"./util.js":63,buffer:8,events:13,"globi-data":17,leaflet:28,"leaflet-draw":27,"terraformer-wkt-parser":53}],63:[function(t,e,n){var i=t("query-string"),o=t("extend"),r=t("deep-equal"),s={};e.exports=s,s.removeChildren=function(t){for(var e=document.querySelector(t);e&&e.firstChild;)e.removeChild(e.firstChild);return e},s.removeChildrenAll=function(t){for(var e=document.querySelectorAll(t),n=0;n<e.length;n++)for(var i=e[n];i&&i.firstChild;)i.removeChild(i.firstChild)},s.fromHash=function(t,e){var n=e||{};return o(n,i.parse(t))},s.toHash=function(t){return i.stringify(t)},s.lastNameFromPath=function(t){return t.split("|").map(function(t){return t.trim()}).filter(function(t){return t.length>0}).reverse()[0]},s.wrapNum=function(t,e,n){var i=e[1],o=e[0],r=i-o;return t===i&&n?t:((t-o)%r+r)%r+o},s.normLng=function(t){return s.wrapNum(t,[-180,180],!0)},s.normBounds=function(t){var e=t._northEast,n=t._southWest;return{_northEast:{lat:e.lat,lng:s.normLng(e.lng)},_southWest:{lat:n.lat,lng:s.normLng(n.lng)}}},s.wktEnvelope=function(t){return"ENVELOPE("+[t._southWest.lng,t._northEast.lng,t._northEast.lat,t._southWest.lat].join(",")+")"},s.capitalize=function(t){var e=t;if(t){var n=t.split(" "),i=n[0];i.length>0&&(n[0]=i[0].toUpperCase().concat(i.slice(1))),e=n.join(" ")}return e};var a=function(){return"api.effechecka.org"};s.createQuery=function(t){return Object.keys(t).reduce(function(e,n){var i=t[n],o="";if(void 0!==i){var r=encodeURIComponent(i);r.length>0&&(o=n+"="+encodeURIComponent(t[n]),e.push(o))}return e},[]).join("&")},s.createRequestURL=function(t,e){return"http://"+a()+"/"+e+"?"+s.createQuery(t)},s.quoteString=function(t){return['"',t,'"'].join("")},s.xhr=function(){var t=null;if(window.XMLHttpRequest)t=new XMLHttpRequest;else if("undefined"!=typeof window&&window.ActiveXObject)try{t=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{t=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}return t},s.classNameFor=function(t){return t.replace(/\W/g,"_")},s.sepElem=function(){var t=document.createElement("span");return t.textContent=" | ",t},s.addHyperlinksForNames=function(t){t.forEach(function(t){for(var e=s.classNameFor(t.name),n="."+e,i=document.querySelectorAll(n),o=0;o<i.length;o++){var r=i[o],a=document.createElement("a");a.setAttribute("class",e),a.setAttribute("href","http://eol.org/pages/"+t.id),a.setAttribute("target","_blank"),a.textContent=t.name,a.setAttribute("title","resolved EOL page for ["+t.name+"] using http://resolver.globalnames.org");var h=r.parentNode;h.insertBefore(a,r),h.removeChild(r)}})},s.requestSelected=function(t,e,n,i){var o=s.xhr();void 0!==o&&(o.open("GET",t,!0),o.onreadystatechange=function(){if(4===o.readyState)if(i("received response"),200===o.status){var r=JSON.parse(o.responseText);n(r,e)}else i("not ok. Received a ["+o.status+"] status with text ["+o.statusText+"] in response to ["+t+"]")},i("requesting checklist..."),o.send(null))},s.wktStringsToGeometryCollection=function(t){var e="";return 1==t.length?e=t[0]:t.length>1&&(e="GEOMETRYCOLLECTION("+t.join(",")+")"),e},s.geometryCollectionToWktStrings=function(t){var e=[t];if(t.indexOf("GEOMETRYCOLLECTION")>-1){var n=t.indexOf("("),i=t.lastIndexOf(")"),o=t.substring(n+1,i),r=o.split(/([a-zA-Z]+)/);e=r.reduce(function(t,e){if(e.match(/[a-zA-Z]+/))t.push(e);else{var n=t.pop();if(n){var i=e.split(/,\s*$/);t.push(n+i[0])}}return t},[])}return e.map(function(t){return s.wktEnvelopeToPolygon(t)})},s.wktEnvelopeToPolygon=function(t){var e="ENVELOPE(",n=t.indexOf(e),i=t;if(n>-1){var o=t.lastIndexOf(")"),r=t.substring(n+e.length,o).split(",");if(4===r.length){var s=r[0],a=r[1],h=r[2],l=r[3];i="POLYGON (("+s+" "+l+", "+s+" "+h+", "+a+" "+h+", "+a+" "+l+", "+s+" "+l+"))"}}return i},s.urlForOccurrence=function(t){var e,n={inaturalist:{prefix:"",suffix:""},gbif:{prefix:"http://www.gbif.org/occurrence/search?OCCURRENCE_ID=",suffix:""},idigbio:{prefix:"http://portal.idigbio.org/search?rq={%22occurrenceid%22:%22",suffix:"%22}"}},i=n[t.source];return e=void 0===i?"http://archive.effechecka.org/job/"+encodeURIComponent(t.source):0==i.prefix.length&&0==i.suffix.length?t.id:i.prefix+encodeURIComponent(t.id)+i.suffix},s.deepEqualIgnoreEmpty=function(t,e){var n=function(t){return Object.keys(t).filter(function(e){var n=t[e];return void 0!==n&&n.length>0}).reduce(function(e,n){return e[n]=t[n],e},{})};return void 0!==t&&void 0!==e&&r(n(t),n(e))}},{"deep-equal":10,extend:14,"query-string":32}]},{},[2])(2)});
